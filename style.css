/* STYLES CSS */

        /* Définition des variables de couleur pour le thème de l'application */
:root {
    /* Thème sombre par défaut */
    --black: #0A0A0A;
    --dark-gray: #141414;
    --charcoal: #1E1E1E;
    --accent: #F5F5F0;
    --accent-dim: #D4D4CF;
    --accent-dark: #A3A39E;
    --accent-green: #19E639;
    --steel: #3A3A3A;
    --success: #F5F5F0;
    --warning: #8A8A85;
}

/* Thème clair */
[data-theme="light"] {
    --black: #F8F9FA;          /* Fond principal : gris très clair au lieu de blanc pur */
    --dark-gray: #FFFFFF;       /* Fond des cartes : blanc pur pour contraster */
    --charcoal: #E9ECEF;        /* Fond alternatif : gris clair */
    --accent: #212529;          /* Texte principal : noir profond */
    --accent-dim: #495057;      /* Texte secondaire : gris foncé */
    --accent-dark: #6C757D;     /* Texte tertiaire : gris moyen */
    --accent-green: #198754;    /* Vert plus foncé pour meilleure visibilité */
    --steel: #CED4DA;           /* Bordures : gris moyen-clair visible */
    --success: #212529;         /* Succès : noir profond */
    --warning: #6C757D;         /* Warning : gris moyen */
}

/* Ajustements spécifiques pour le thème clair */
[data-theme="light"] .kpi-card,
[data-theme="light"] .habit-item,
[data-theme="light"] .stat-card,
[data-theme="light"] .modal-content,
[data-theme="light"] .settings-category,
[data-theme="light"] .auth-container {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .header {
    border-bottom: 2px solid var(--steel);
}

[data-theme="light"] .section-title {
    border-bottom: 2px solid var(--steel);
    font-weight: 800;
}

[data-theme="light"] .habit-item {
    border-bottom: 2px solid var(--charcoal);
}

[data-theme="light"] .date-nav button {
    font-weight: 600;
}

[data-theme="light"] .date-nav button:hover {
    background: var(--steel);
    border-color: var(--accent-dim);
}

/* Paramètres en thème clair */
[data-theme="light"] .settings-category {
    background: var(--dark-gray);
    border: 2px solid var(--steel);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .settings-category-header {
    background: var(--charcoal);
    border-bottom: 2px solid var(--steel);
}

[data-theme="light"] .settings-category-title {
    color: var(--accent);
    font-weight: 800;
}

[data-theme="light"] .settings-item {
    background: var(--charcoal);
    border-left-color: var(--steel);
}

[data-theme="light"] .settings-item:hover {
    background: var(--dark-gray);
    border-left-color: var(--accent-green);
}

[data-theme="light"] .settings-item-label {
    color: var(--accent);
    font-weight: 600;
}

[data-theme="light"] .settings-item-desc {
    color: var(--accent-dim);
    opacity: 0.85;
}

[data-theme="light"] .settings-btn {
    border: 2px solid var(--steel);
    color: var(--accent);
    font-weight: 700;
}

[data-theme="light"] .settings-btn:hover {
    background: var(--accent);
    color: var(--dark-gray);
    border-color: var(--accent);
}

[data-theme="light"] .settings-btn.primary {
    background: var(--accent);
    color: var(--dark-gray);
    border-color: var(--accent);
}

[data-theme="light"] .settings-btn.primary:hover {
    background: var(--accent-dim);
    border-color: var(--accent-dim);
}

[data-theme="light"] .settings-btn.danger {
    color: #DC3545;
    border-color: #DC3545;
    background: transparent;
}

[data-theme="light"] .settings-btn.danger:hover {
    background: #DC3545;
    color: white;
    border-color: #DC3545;
}

/* Input time en thème clair */
[data-theme="light"] .time-input-wrapper {
    background: var(--charcoal);
    border: 2px solid var(--steel);
}

[data-theme="light"] .time-input-wrapper:hover {
    border-color: var(--accent-dim);
    background: var(--dark-gray);
}

[data-theme="light"] .time-input-wrapper:focus-within {
    border-color: var(--accent-green);
    box-shadow: 0 0 10px rgba(25, 135, 84, 0.3);
}

[data-theme="light"] .settings-time-input {
    background: var(--dark-gray);
    color: var(--accent);
    border: 2px solid var(--steel);
    text-shadow: none;
    box-shadow: none;
}

[data-theme="light"] .settings-time-input:hover {
    border-color: var(--accent-dim);
    box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
    text-shadow: none;
}

[data-theme="light"] .settings-time-input:focus {
    background: var(--dark-gray);
    border-color: var(--accent-green);
    box-shadow: 0 0 12px rgba(25, 135, 84, 0.3);
    text-shadow: none;
}

[data-theme="light"] .settings-time-input::-webkit-calendar-picker-indicator {
    filter: invert(0);
    opacity: 0.6;
}

[data-theme="light"] .settings-time-input::-webkit-calendar-picker-indicator:hover {
    opacity: 1;
}

/* Transition fluide lors du changement de thème */
body,
.header,
.date-nav,
.date-nav button,
.kpi-card,
.habit-item,
.stat-card,
.modal-content,
.settings-container,
.settings-category,
.auth-container {
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
}

/* Scroll behavior & scrollbar hiding */
html {
    scroll-behavior: smooth;
    height: -webkit-fill-available;
    overscroll-behavior: none;
}

::-webkit-scrollbar { width: 0; height: 0; }
body { -ms-overflow-style: none; scrollbar-width: none; overscroll-behavior-y: none; }

/* Réinitialisation des styles de base pour tous les éléments */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
    /* Supprime le surlignage au toucher sur les mobiles */
}

/* Style général du corps de la page */
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--black);
    color: var(--accent);
    min-height: 100vh;
    min-height: -webkit-fill-available;
    /* Assure la hauteur pleine page sur les navigateurs mobiles */
    padding-bottom: calc(80px + env(safe-area-inset-bottom));
    /* Marge inférieure pour la barre de navigation et les zones de sécurité des iPhones */
    padding-top: env(safe-area-inset-top);
    /* Marge supérieure pour les zones de sécurité */
    -webkit-font-smoothing: antialiased;
    /* Améliore le rendu des polices */
    -webkit-overflow-scrolling: touch;
    /* Active le défilement fluide sur iOS */
    overscroll-behavior-y: contain;
    /* Empêche le défilement de "rebondir" en haut et en bas */
}

/* En-tête de l'application - Glass effect */
.header {
    background: rgba(10, 10, 10, 0.85);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    padding: 20px 15px;
    text-align: center;
    position: sticky;
    /* L'en-tête reste visible lors du défilement */
    top: 0;
    z-index: 100;
    border-bottom: 1px solid var(--steel);
}

[data-theme="light"] .header {
    background: rgba(248, 249, 250, 0.85);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.header h1 {
    font-size: 1.4rem;
    font-weight: 900;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 3px;
}

.header .quote {
    font-size: 0.75rem;
    color: var(--accent-dark);
    font-style: italic;
    margin-top: 5px;
}

/* Navigation par date */
.date-nav {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 16px;
    padding: 14px 16px;
    background: var(--dark-gray);
}

.date-nav-btn {
    background: var(--charcoal);
    border: 1px solid var(--steel);
    color: var(--accent);
    width: 40px;
    height: 40px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.date-nav-btn:active {
    transform: scale(0.9);
}

.date-nav-btn svg {
    stroke: var(--accent);
}

.date-nav-today {
    background: linear-gradient(135deg, #2ECC71, #27AE60);
    border-color: #2ECC71;
}

.date-nav-today svg {
    stroke: white;
}

.date-nav .current-date {
    font-size: 1rem;
    font-weight: 800;
    color: var(--accent);
    min-width: 150px;
    text-align: center;
    letter-spacing: 0.5px;
}

/* Conteneur des indicateurs clés de performance (KPI) */
.kpi-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    padding: 15px;
    background: var(--dark-gray);
}

.kpi-card {
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 14px;
    padding: 14px 8px 12px;
    text-align: center;
    position: relative;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.04);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.kpi-card:active {
    transform: scale(0.96);
}

/* Subtle colored top border per card */
.kpi-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 20%;
    right: 20%;
    height: 3px;
    border-radius: 0 0 4px 4px;
}

.kpi-score::before { background: linear-gradient(90deg, #2ECC71, #27AE60); }
.kpi-streak::before { background: linear-gradient(90deg, #F39C12, #E67E22); }
.kpi-perfect::before { background: linear-gradient(90deg, #9B59B6, #8E44AD); }

/* Icon */
.kpi-icon {
    margin-bottom: 4px;
    display: flex;
    justify-content: center;
}

.kpi-score .kpi-icon svg { stroke: #2ECC71; }
.kpi-streak .kpi-icon svg { stroke: #F39C12; }
.kpi-perfect .kpi-icon svg { stroke: #9B59B6; }

/* Value */
.kpi-card .value {
    font-size: 1.6rem;
    font-weight: 900;
    color: var(--accent);
    margin: 2px 0;
    line-height: 1.1;
}

.kpi-score .value { color: #2ECC71; text-shadow: 0 0 12px rgba(46, 204, 113, 0.3); }
.kpi-streak .value { color: #F39C12; text-shadow: 0 0 12px rgba(243, 156, 18, 0.3); }
.kpi-perfect .value { color: #9B59B6; text-shadow: 0 0 12px rgba(155, 89, 182, 0.3); }

/* Label */
.kpi-card .label {
    font-size: 0.6rem;
    color: var(--accent-dim);
    text-transform: uppercase;
    font-weight: 700;
    letter-spacing: 1.5px;
}

.kpi-card .sub {
    font-size: 0.55rem;
    color: var(--accent-dark);
}

/* Missions du jour — header premium */
.missions-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 16px;
    margin: 0 15px 8px;
    background: linear-gradient(145deg, var(--charcoal), rgba(30, 30, 30, 0.9));
    border: 1px solid var(--steel);
    border-radius: 14px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.04);
    position: relative;
    overflow: hidden;
}

.missions-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 15%;
    right: 15%;
    height: 3px;
    border-radius: 0 0 4px 4px;
    background: linear-gradient(90deg, #E74C3C, #C0392B);
}

.missions-title-row {
    display: flex;
    align-items: center;
    gap: 10px;
}

.missions-icon {
    display: flex;
    align-items: center;
    justify-content: center;
}

.missions-icon svg {
    stroke: #E74C3C;
    filter: drop-shadow(0 0 6px rgba(231, 76, 60, 0.3));
}

.missions-title {
    font-size: 0.8rem;
    font-weight: 900;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 2px;
}

.missions-count {
    font-size: 1.1rem;
    font-weight: 900;
    color: #E74C3C;
    text-shadow: 0 0 10px rgba(231, 76, 60, 0.3);
    background: rgba(231, 76, 60, 0.1);
    padding: 4px 12px;
    border-radius: 20px;
    border: 1px solid rgba(231, 76, 60, 0.2);
}

/* Titres de section (generic) */
.section-title {
    background: var(--charcoal);
    color: var(--accent);
    padding: 12px 15px;
    font-size: 0.9rem;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 2px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid var(--steel);
}

/* Liste des habitudes */
.habits-list {
    padding: 0;
}

/* ============================================================
   HABIT ITEM — Barre de remplissage + Croix/Check
   ============================================================ */

.habit-item {
    position: relative;
    padding: 15px;
    background: var(--dark-gray);
    border-bottom: 1px solid var(--charcoal);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border-left: 3px solid transparent;
    overflow: hidden;
    cursor: pointer;
    border-radius: 8px;
    margin-bottom: 4px;
}

/* Fill bar — fills from bottom to top like a glass of water */
.habit-fill-bar {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 0%;
    background: linear-gradient(0deg, rgba(46, 204, 113, 0.30), rgba(46, 204, 113, 0.12));
    z-index: 0;
    pointer-events: none;
    border-radius: 8px;
}

.habit-item.completed .habit-fill-bar {
    height: 100%;
}

/* Content sits above the fill bar */
.habit-content {
    position: relative;
    z-index: 1;
    display: flex;
    align-items: center;
    gap: 12px;
}

/* (status icons removed — fill bar replaces them) */

/* Completed state */
.habit-item.completed {
    border-left-color: #2ECC71;
}

.habit-item:active {
    transform: scale(0.98);
}

.habit-item.locked {
    opacity: 0.5;
    cursor: not-allowed;
}

.habit-item.locked:active {
    transform: none;
}

/* Failed state (past days) */
.habit-item.failed {
    background: linear-gradient(90deg, rgba(231, 76, 60, 0.10), transparent);
    border-left-color: #E74C3C;
}

.habit-item.failed .habit-name {
    color: #E74C3C;
    opacity: 0.8;
}

.habit-item.failed .habit-streak {
    color: rgba(231, 76, 60, 0.6);
}

.habit-item.failed .habit-progress .percent {
    color: #E74C3C;
    opacity: 0.7;
}

.habit-info {
    flex: 1;
    transition: all 0.3s ease;
    min-width: 0;
}

.habit-name {
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--accent);
    margin-bottom: 3px;
    transition: all 0.3s ease;
}

.habit-item.completed .habit-name {
    color: #2ECC71;
}

.habit-streak {
    font-size: 0.7rem;
    color: var(--accent-dark);
    transition: all 0.3s ease;
}

.habit-description {
    font-size: 0.75rem;
    color: var(--accent-dim);
    margin-bottom: 3px;
    font-style: italic;
    opacity: 0.8;
    line-height: 1.3;
}

.habit-item.completed .habit-description {
    color: rgba(46, 204, 113, 0.6);
}

.habit-item.completed .habit-streak {
    color: rgba(46, 204, 113, 0.7);
}

.habit-progress {
    width: 45px;
    text-align: right;
}

.habit-progress .percent {
    font-size: 1rem;
    font-weight: bold;
    color: var(--accent-dim);
    transition: all 0.3s ease;
}

.habit-item.completed .habit-progress .percent {
    color: #2ECC71;
    text-shadow: 0 0 8px rgba(46, 204, 113, 0.4);
}

/* Styles pour les graphiques */
.chart-container {
    padding: 15px;
    background: var(--dark-gray);
}

.chart-wrapper {
    background: linear-gradient(145deg, var(--charcoal), rgba(30, 30, 30, 0.9));
    border: 1px solid var(--steel);
    border-radius: 14px;
    padding: 18px;
    margin-bottom: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.04);
}

.chart-title {
    font-size: 0.75rem;
    color: var(--accent);
    text-transform: uppercase;
    margin-bottom: 12px;
    font-weight: 800;
    letter-spacing: 1.5px;
}

canvas {
    max-height: 200px;
    /* Limite la hauteur des graphiques */
}

/* Barre de navigation inférieure */
.bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    align-items: flex-end;
    background: var(--black);
    border-top: 1px solid var(--steel);
    z-index: 100;
    padding-bottom: env(safe-area-inset-bottom);
    max-width: 600px;
    margin: 0 auto;
}

.nav-item {
    flex: 1;
    padding: 10px 5px 8px;
    text-align: center;
    cursor: pointer;
    transition: color 0.2s ease, transform 0.2s ease;
    position: relative;
    color: var(--accent-dark);
}

.nav-item.active {
    color: var(--accent);
}

.nav-item.active::after {
    content: '';
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 24px;
    height: 3px;
    background: var(--accent-green);
    border-radius: 0 0 2px 2px;
    animation: navIndicatorIn 0.3s ease;
}

@keyframes navIndicatorIn {
    from { width: 0; opacity: 0; }
    to { width: 24px; opacity: 1; }
}

.nav-item .icon {
    margin-bottom: 2px;
    transition: transform 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.nav-item .icon svg {
    width: 22px;
    height: 22px;
    stroke: var(--accent-dark);
    transition: stroke 0.2s ease, transform 0.2s ease;
}

.nav-item.active .icon svg {
    stroke: var(--accent);
    transform: scale(1.1);
    filter: drop-shadow(0 0 4px rgba(245, 245, 240, 0.3));
}

.nav-item .label {
    font-size: 0.6rem;
    color: var(--accent-dim);
    text-transform: uppercase;
    transition: color 0.2s ease;
}

.nav-item.active .label {
    color: var(--accent);
    font-weight: 700;
}

/* Bounce animation on nav tap */
@keyframes navBounce {
    0% { transform: scale(1); }
    20% { transform: scale(0.85); }
    50% { transform: scale(1.15); }
    70% { transform: scale(0.95); }
    100% { transform: scale(1); }
}

@keyframes navIconBounce {
    0% { transform: scale(1) translateY(0); }
    30% { transform: scale(0.8) translateY(2px); }
    55% { transform: scale(1.25) translateY(-4px); }
    75% { transform: scale(0.95) translateY(0); }
    100% { transform: scale(1) translateY(0); }
}

.nav-item.nav-tapped {
    animation: navBounce 0.5s cubic-bezier(0.36, 0, 0.66, -0.56);
}

.nav-item.nav-tapped .icon {
    animation: navIconBounce 0.5s cubic-bezier(0.36, 0, 0.66, -0.56);
}

/* Bounce for + button */
@keyframes addBtnBounce {
    0% { transform: scale(1); }
    25% { transform: scale(0.8) rotate(0deg); }
    50% { transform: scale(1.2) rotate(90deg); }
    75% { transform: scale(0.95) rotate(90deg); }
    100% { transform: scale(1) rotate(0deg); }
}

.nav-add-btn.nav-tapped .nav-add-icon {
    animation: addBtnBounce 0.6s cubic-bezier(0.36, 0, 0.66, -0.56);
}

/* Bouton + central surélevé */
.nav-add-btn {
    position: relative;
    width: 56px;
    height: 56px;
    flex-shrink: 0;
    margin: 0 6px;
    margin-top: -20px;
    cursor: pointer;
    z-index: 101;
}

.nav-add-icon {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    background: linear-gradient(135deg, #2ECC71, #27AE60);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4), 0 2px 6px rgba(0, 0, 0, 0.3);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.nav-add-icon svg {
    stroke: white;
}

.nav-add-btn:active .nav-add-icon {
    transform: scale(0.9) rotate(90deg);
    box-shadow: 0 2px 8px rgba(46, 204, 113, 0.3);
}

/* Système de pages/onglets avec transitions */
.page {
    display: none;
    /* Les pages sont masquées par défaut */
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.3s ease, transform 0.3s ease;
}

.page.active {
    display: block;
    /* La page active est affichée */
    opacity: 1;
    transform: translateY(0);
}

/* Affichage du rang */
.rank-display {
    background: var(--charcoal);
    margin: 15px;
    border-radius: 15px;
    padding: 20px;
    text-align: center;
    border: 1px solid var(--steel);
}

.rank-display .rank-title {
    font-size: 0.7rem;
    color: var(--accent-dark);
    text-transform: uppercase;
    letter-spacing: 2px;
}

.rank-display .rank-name {
    font-size: 2rem;
    font-weight: 900;
    color: var(--accent);
    margin: 10px 0;
}

.rank-display .rank-progress {
    background: var(--steel);
    border-radius: 10px;
    height: 10px;
    margin-top: 10px;
    overflow: hidden;
}

.rank-display .rank-progress-bar {
    height: 100%;
    background: var(--accent);
    border-radius: 10px;
    transition: width 0.5s ease;
    /* Animation de la barre de progression */
}

/* Grille des statistiques */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    padding: 15px;
}

.stat-card {
    background: linear-gradient(145deg, var(--charcoal), rgba(30, 30, 30, 0.9));
    border-radius: 14px;
    padding: 16px 12px 14px;
    text-align: center;
    border: 1px solid var(--steel);
    position: relative;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.04);
}

.stat-card::before {
    content: '';
    position: absolute;
    top: 0; left: 20%; right: 20%;
    height: 3px;
    border-radius: 0 0 4px 4px;
}

.stat-card-green::before { background: linear-gradient(90deg, #2ECC71, #27AE60); }
.stat-card-orange::before { background: linear-gradient(90deg, #F39C12, #E67E22); }
.stat-card-purple::before { background: linear-gradient(90deg, #9B59B6, #8E44AD); }
.stat-card-blue::before { background: linear-gradient(90deg, #3498DB, #2980B9); }

.stat-card-icon {
    margin-bottom: 6px;
    display: flex;
    justify-content: center;
}

.stat-card-green .stat-card-icon svg { stroke: #2ECC71; }
.stat-card-orange .stat-card-icon svg { stroke: #F39C12; }
.stat-card-purple .stat-card-icon svg { stroke: #9B59B6; }
.stat-card-blue .stat-card-icon svg { stroke: #3498DB; }

.stat-card .stat-value {
    font-size: 1.6rem;
    font-weight: 900;
    line-height: 1.1;
}

.stat-card-green .stat-value { color: #2ECC71; text-shadow: 0 0 10px rgba(46,204,113,0.3); }
.stat-card-orange .stat-value { color: #F39C12; text-shadow: 0 0 10px rgba(243,156,18,0.3); }
.stat-card-purple .stat-value { color: #9B59B6; text-shadow: 0 0 10px rgba(155,89,182,0.3); }
.stat-card-blue .stat-value { color: #3498DB; text-shadow: 0 0 10px rgba(52,152,219,0.3); }

.stat-card .stat-label {
    font-size: 0.6rem;
    color: var(--accent-dim);
    text-transform: uppercase;
    margin-top: 4px;
    font-weight: 700;
    letter-spacing: 1px;
}

/* Carte de motivation */
.motivation-card {
    background: var(--charcoal);
    margin: 15px;
    border-radius: 10px;
    padding: 20px;
    text-align: center;
    border-left: 4px solid var(--accent);
}

.motivation-card .quote-text {
    font-size: 0.9rem;
    font-style: italic;
    color: var(--accent);
    line-height: 1.5;
}

.motivation-card .quote-author {
    font-size: 0.75rem;
    color: var(--accent-dark);
    margin-top: 10px;
    font-weight: bold;
}

/* Grille de la semaine */
.weekly-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    /* 7 colonnes pour les jours de la semaine */
    gap: 5px;
    padding: 15px;
}

.weekly-day {
    text-align: center;
    padding: 10px 5px;
    background: var(--charcoal);
    border-radius: 8px;
}

.weekly-day .day-name {
    font-size: 0.6rem;
    color: var(--accent-dark);
    margin-bottom: 5px;
}

.weekly-day .day-score {
    font-size: 1rem;
    font-weight: bold;
    color: var(--accent);
}

.weekly-day.today {
    border: 2px solid var(--accent);
    /* Surligne le jour actuel */
}

.weekly-day.perfect {
    background: var(--accent);
    /* Style pour un jour parfait (100%) */
}

.weekly-day.perfect .day-score {
    color: var(--black);
}

.weekly-day.perfect .day-name {
    color: var(--black);
}

/* ============================================================ */
/* SECTION PARAMÈTRES - STYLE JEU VIDÉO / CYBERPUNK */
/* ============================================================ */

.settings-container {
    padding: 15px;
    position: relative;
}

/* Catégorie - Style carte de jeu */
.settings-category {
    background: linear-gradient(135deg, rgba(20, 20, 20, 0.95), rgba(30, 30, 30, 0.9));
    margin-bottom: 12px;
    overflow: hidden;
    border: 1px solid transparent;
    border-image: linear-gradient(135deg, var(--accent-dark), transparent, var(--accent-dark)) 1;
    position: relative;
    clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 12px 100%, 0 calc(100% - 12px));
}

.settings-category::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--accent), transparent);
    opacity: 0.6;
}

.settings-category::after {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 12px;
    height: 12px;
    background: var(--accent);
    clip-path: polygon(100% 0, 0 100%, 100% 100%);
    opacity: 0.3;
}

/* Header de catégorie - Style HUD */
.settings-category-header {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    background: linear-gradient(90deg, rgba(245, 245, 240, 0.08), transparent);
    border-bottom: 1px solid rgba(245, 245, 240, 0.1);
    position: relative;
}

.settings-category-header::before {
    content: '//';
    color: var(--accent);
    font-size: 0.7rem;
    opacity: 0.5;
    font-family: monospace;
}

.settings-category-icon {
    font-size: 1.1rem;
    filter: drop-shadow(0 0 4px rgba(245, 245, 240, 0.3));
}

.settings-category-title {
    color: var(--accent);
    font-size: 0.75rem;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 2px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', monospace;
}

/* Contenu de catégorie */
.settings-category-content {
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

/* Item de paramètre - Style menu de jeu */
.settings-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 14px;
    background: rgba(0, 0, 0, 0.3);
    border-left: 2px solid transparent;
    gap: 12px;
    transition: all 0.2s ease;
    position: relative;
    cursor: default;
}

.settings-item:hover {
    background: rgba(245, 245, 240, 0.05);
    border-left-color: var(--accent);
}

.settings-item:hover .settings-item-label {
    color: var(--accent);
    text-shadow: 0 0 8px rgba(245, 245, 240, 0.3);
}

.settings-item-info {
    flex: 1;
}

.settings-item-label {
    color: var(--accent-dim);
    font-size: 0.8rem;
    font-weight: 600;
    letter-spacing: 0.5px;
    transition: all 0.2s ease;
}

.settings-item-desc {
    color: var(--accent-dark);
    font-size: 0.65rem;
    margin-top: 2px;
    font-family: monospace;
    opacity: 0.7;
}

.settings-item-action {
    flex-shrink: 0;
}

/* Boutons style gaming */
.settings-btn {
    background: transparent;
    color: var(--accent-dim);
    border: 1px solid var(--accent-dark);
    padding: 10px 18px;
    font-size: 0.7rem;
    min-height: 44px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.15s ease;
    white-space: nowrap;
    text-transform: uppercase;
    letter-spacing: 1px;
    position: relative;
    clip-path: polygon(0 0, calc(100% - 6px) 0, 100% 6px, 100% 100%, 6px 100%, 0 calc(100% - 6px));
}

.settings-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--accent);
    opacity: 0;
    transition: opacity 0.15s ease;
    z-index: -1;
}

.settings-btn:hover {
    color: var(--black);
    border-color: var(--accent);
    text-shadow: none;
}

.settings-btn:hover::before {
    opacity: 1;
}

.settings-btn:active {
    transform: scale(0.95);
}

.settings-btn.primary {
    background: var(--accent);
    color: var(--black);
    border-color: var(--accent);
    box-shadow: 0 0 10px rgba(245, 245, 240, 0.2);
}

.settings-btn.primary:hover {
    box-shadow: 0 0 15px rgba(245, 245, 240, 0.4);
}

.settings-btn.danger {
    background: transparent;
    color: #FF6B6B;
    border-color: #8B0000;
}

.settings-btn.danger::before {
    background: #8B0000;
}

.settings-btn.danger:hover {
    color: #FFE5E5;
    border-color: #FF6B6B;
    box-shadow: 0 0 10px rgba(139, 0, 0, 0.4);
}

/* Wrapper pour l'input time avec icône */
.time-input-wrapper {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 6px 12px;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.3) 0%, rgba(20, 20, 20, 0.5) 100%);
    border: 1px solid var(--steel);
    clip-path: polygon(8px 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%, 0 8px);
    transition: all 0.3s ease;
}

.time-input-wrapper:hover {
    border-color: var(--accent-dark);
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(30, 30, 30, 0.6) 100%);
}

.time-input-wrapper:focus-within {
    border-color: var(--accent);
    box-shadow: 0 0 15px rgba(245, 245, 240, 0.15);
}

.time-icon {
    font-size: 1.3rem;
    animation: timeIconPulse 3s ease-in-out infinite;
}

@keyframes timeIconPulse {
    0%, 100% { transform: scale(1); opacity: 0.8; }
    50% { transform: scale(1.1); opacity: 1; }
}

.time-input-wrapper:focus-within .time-icon {
    animation: timeIconActive 1s ease-in-out infinite;
}

@keyframes timeIconActive {
    0%, 100% { transform: scale(1) rotate(0deg); }
    25% { transform: scale(1.1) rotate(-5deg); }
    75% { transform: scale(1.1) rotate(5deg); }
}

/* Input time style gaming - Horloge futuriste */
.settings-time-input {
    width: 110px;
    padding: 12px 16px;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(30, 30, 30, 0.8) 100%);
    color: var(--accent);
    border: 2px solid var(--accent-dark);
    border-radius: 0;
    font-size: 1.1rem;
    font-weight: bold;
    text-align: center;
    font-family: 'Courier New', monospace;
    letter-spacing: 2px;
    clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px));
    transition: all 0.3s ease;
    position: relative;
    box-shadow:
        inset 0 0 20px rgba(0, 0, 0, 0.5),
        0 0 10px rgba(245, 245, 240, 0.1);
    text-shadow: 0 0 10px rgba(245, 245, 240, 0.5);
}

.settings-time-input:hover {
    border-color: var(--accent);
    box-shadow:
        inset 0 0 20px rgba(0, 0, 0, 0.5),
        0 0 15px rgba(245, 245, 240, 0.2),
        0 0 30px rgba(245, 245, 240, 0.1);
    text-shadow: 0 0 15px rgba(245, 245, 240, 0.8);
}

.settings-time-input:focus {
    outline: none;
    border-color: var(--accent);
    background: linear-gradient(135deg, rgba(20, 20, 20, 0.8) 0%, rgba(40, 40, 40, 0.9) 100%);
    box-shadow:
        inset 0 0 25px rgba(0, 0, 0, 0.6),
        0 0 20px rgba(245, 245, 240, 0.3),
        0 0 40px rgba(245, 245, 240, 0.15);
    text-shadow: 0 0 20px rgba(245, 245, 240, 1);
    animation: clockPulse 2s ease-in-out infinite;
}

@keyframes clockPulse {
    0%, 100% {
        box-shadow:
            inset 0 0 25px rgba(0, 0, 0, 0.6),
            0 0 20px rgba(245, 245, 240, 0.3),
            0 0 40px rgba(245, 245, 240, 0.15);
    }
    50% {
        box-shadow:
            inset 0 0 25px rgba(0, 0, 0, 0.6),
            0 0 25px rgba(245, 245, 240, 0.4),
            0 0 50px rgba(245, 245, 240, 0.2);
    }
}

/* Style du picker natif */
.settings-time-input::-webkit-calendar-picker-indicator {
    filter: invert(1);
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.2s ease;
}

.settings-time-input::-webkit-calendar-picker-indicator:hover {
    opacity: 1;
}

.settings-section {
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* Bouton de réinitialisation */
.reset-btn {
    background: var(--steel);
    color: var(--accent);
    border: 1px solid var(--accent-dark);
    padding: 15px 30px;
    border-radius: 10px;
    font-size: 0.9rem;
    font-weight: bold;
    cursor: pointer;
    width: 100%;
    text-align: center;
    transition: all 0.2s ease;
}

.reset-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(245, 245, 240, 0.1);
}

.reset-btn:active {
    transform: scale(0.98);
}

/* Bouton de gestion des habitudes */
.edit-habits-btn {
    background: var(--accent);
    color: var(--accent);
    border: 1px solid var(--accent-dark);
}

.edit-habits-btn:hover {
    background: var(--accent-green);
}

/* Bouton de notifications */
.reset-btn#notifBtn {
    background: var(--charcoal);
    color: var(--accent);
}

.reset-btn#notifBtn:hover {
    background: var(--steel);
}

/* Bouton de suppression de compte */
.reset-btn#deleteAccountBtn {
    background: #8B0000;
    color: #FFE5E5;
    border: 1px solid #A00000;
    margin-top: 20px;
    border-top: 2px solid var(--steel);
    padding-top: 20px;
}

.reset-btn#deleteAccountBtn:hover {
    background: #A00000;
    box-shadow: 0 4px 12px rgba(139, 0, 0, 0.3);
}

/* Bouton de validation de journée */
.validate-day-btn {
    width: calc(100% - 30px);
    margin: 30px 15px 10px 15px;
    padding: 16px 24px;
    background: linear-gradient(135deg, #19E639 0%, #0DBF2F 50%, #0A9925 100%);
    color: #0A0A0A;
    border: none;
    border-radius: 14px;
    font-size: 0.95rem;
    font-weight: 800;
    letter-spacing: 2px;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(25, 230, 57, 0.25), inset 0 1px 0 rgba(255,255,255,0.2);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    text-transform: uppercase;
}

.validate-day-btn::before {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
    transition: left 0.5s ease;
}

.validate-day-btn:hover::before {
    left: 100%;
}

.validate-day-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(25, 230, 57, 0.35), inset 0 1px 0 rgba(255,255,255,0.2);
}

.validate-day-btn:active {
    transform: translateY(-1px) scale(0.98);
    box-shadow: 0 2px 10px rgba(25, 230, 57, 0.3);
}

/* Fenêtre modale (pour l'édition des habitudes) */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.9);
    z-index: 25000 !important;
    display: none;
    /* Cachée par défaut */
    align-items: center;
    justify-content: center;
    padding: 20px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.modal-overlay.active {
    display: flex;
    opacity: 1;
    /* Affichée quand la classe 'active' est ajoutée */
}

.modal {
    background: var(--charcoal);
    border-radius: 15px;
    padding: 25px;
    width: 100%;
    max-width: 400px;
    border: 1px solid var(--steel);
    animation: modalIn 0.3s ease-out;
    /* Animation d'apparition */
}

@keyframes modalIn {
    from { opacity: 0; transform: scale(0.95) translateY(10px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
}

.modal h3 {
    color: var(--accent);
    font-size: 1.1rem;
    margin-bottom: 20px;
    text-align: center;
}

.modal-habit-item {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 12px;
    padding: 10px;
    background: var(--dark-gray);
    border-radius: 8px;
}

.modal-habit-item .icon {
    font-size: 1.3rem;
    width: 35px;
    text-align: center;
}

.modal-habit-item input {
    flex: 1;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 5px;
    padding: 10px;
    color: var(--accent);
    font-size: 0.9rem;
    font-family: inherit;
}

.modal-habit-item input:focus {
    outline: none;
    border-color: var(--accent);
}

.modal-buttons {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

.modal-btn {
    flex: 1;
    padding: 12px;
    border-radius: 8px;
    font-size: 0.9rem;
    font-weight: bold;
    cursor: pointer;
    border: none;
    transition: all 0.2s ease;
}

.modal-btn.cancel {
    background: var(--steel);
    color: var(--accent);
}

.modal-btn.save {
    background: var(--accent);
    color: var(--black);
}

.modal-btn:active {
    transform: scale(0.95);
}

.edit-habits-btn {
    background: var(--charcoal);
    width: 100%;
}

/* ANIMATIONS */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

@keyframes scaleIn {
    from {
        opacity: 0;
        transform: scale(0.8);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

@keyframes checkPop {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.2);
    }

    100% {
        transform: scale(1);
    }
}

@keyframes confettiFall {
    0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
    }

    100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
    }
}

/* Assignation des animations aux éléments */
.header {
    animation: fadeIn 0.5s ease-out;
}

.kpi-card {
    animation: scaleIn 0.4s ease-out backwards;
}

.kpi-card:nth-child(1) {
    animation-delay: 0.1s;
}

.kpi-card:nth-child(2) {
    animation-delay: 0.2s;
}

.kpi-card:nth-child(3) {
    animation-delay: 0.3s;
}

.habit-item {
    animation: fadeInUp 0.4s ease-out backwards;
}

/* Délai d'animation pour chaque élément de la liste pour un effet d'escalier */
.habit-item:nth-child(1) {
    animation-delay: 0.05s;
}

.habit-item:nth-child(2) {
    animation-delay: 0.1s;
}

.habit-item:nth-child(3) {
    animation-delay: 0.15s;
}

.habit-item:nth-child(4) {
    animation-delay: 0.2s;
}

.habit-item:nth-child(5) {
    animation-delay: 0.25s;
}

.habit-item:nth-child(6) {
    animation-delay: 0.3s;
}

.habit-item:nth-child(7) {
    animation-delay: 0.35s;
}

.habit-item:nth-child(8) {
    animation-delay: 0.4s;
}

.habit-item:nth-child(9) {
    animation-delay: 0.45s;
}

.habit-item:nth-child(10) {
    animation-delay: 0.5s;
}

/* Legacy .habit-checkbox kept for manage-habits modal only */

.section-title {
    animation: fadeIn 0.4s ease-out;
}

.rank-display {
    animation: scaleIn 0.5s ease-out;
}

.stat-card {
    animation: fadeInUp 0.4s ease-out backwards;
}

.stats-grid .stat-card:nth-child(1) {
    animation-delay: 0.1s;
}

.stats-grid .stat-card:nth-child(2) {
    animation-delay: 0.15s;
}

.stats-grid .stat-card:nth-child(3) {
    animation-delay: 0.2s;
}

.stats-grid .stat-card:nth-child(4) {
    animation-delay: 0.25s;
}

.weekly-day {
    animation: scaleIn 0.3s ease-out backwards;
}

.weekly-day:nth-child(1) {
    animation-delay: 0.05s;
}

.weekly-day:nth-child(2) {
    animation-delay: 0.1s;
}

.weekly-day:nth-child(3) {
    animation-delay: 0.15s;
}

.weekly-day:nth-child(4) {
    animation-delay: 0.2s;
}

.weekly-day:nth-child(5) {
    animation-delay: 0.25s;
}

.weekly-day:nth-child(6) {
    animation-delay: 0.3s;
}

.weekly-day:nth-child(7) {
    animation-delay: 0.35s;
}

.motivation-card {
    animation: fadeInUp 0.5s ease-out;
}

.chart-wrapper {
    animation: fadeIn 0.6s ease-out backwards;
}

.chart-wrapper:nth-child(1) {
    animation-delay: 0.2s;
}

.chart-wrapper:nth-child(2) {
    animation-delay: 0.4s;
}

/* Transitions pour une meilleure expérience utilisateur */
.nav-item {
    transition: all 0.2s ease;
}

.nav-item:active {
    transform: scale(0.95);
}

.date-nav button {
    transition: all 0.2s ease;
}

.date-nav button:active {
    transform: scale(0.9);
}

.kpi-card .value {
    transition: all 0.3s ease;
}

/* Page transition handled by .page.active opacity/transform */

/* AUTH PAGE STYLES */
.auth-container {
    max-width: 400px;
    margin: 50px auto;
    padding: 20px;
}

.auth-logo {
    text-align: center;
    margin-bottom: 30px;
}

.auth-logo svg {
    width: 80px;
    height: 80px;
    margin-bottom: 15px;
}

.auth-logo h1 {
    font-size: 1.8rem;
    color: var(--accent);
    font-weight: 900;
    letter-spacing: 3px;
}

.auth-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.auth-tab {
    flex: 1;
    padding: 12px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    color: var(--accent);
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.2s;
}

.auth-tab.active {
    background: var(--accent);
    color: var(--black);
}

.auth-tab:active {
    transform: scale(0.98);
}

.auth-form {
    display: none;
}

.auth-form.active {
    display: block;
}

.auth-form input {
    width: 100%;
    padding: 15px;
    margin-bottom: 15px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 8px;
    color: var(--accent);
    font-size: 1rem;
    font-family: inherit;
}

.auth-form input:focus {
    outline: none;
    border-color: var(--accent);
}

.auth-btn {
    width: 100%;
    padding: 15px;
    background: var(--accent);
    color: var(--black);
    border: none;
    border-radius: 8px;
    font-weight: bold;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.2s;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.auth-btn:active {
    transform: scale(0.98);
}

.auth-error {
    color: #FF6B6B;
    font-size: 0.85rem;
    margin-top: 10px;
    text-align: center;
    padding: 10px;
    background: rgba(255, 107, 107, 0.1);
    border-radius: 5px;
    display: none;
}

.forgot-password-link {
    display: block;
    margin-top: 15px;
    text-align: center;
    color: var(--accent);
    font-size: 0.9rem;
    text-decoration: none;
    transition: opacity 0.2s;
}

.forgot-password-link:hover {
    opacity: 0.8;
    text-decoration: underline;
}

.auth-error.show {
    display: block;
}

.logout-btn {
    position: absolute;
    top: 20px;
    right: 15px;
    padding: 8px 15px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    color: var(--accent);
    border-radius: 5px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s;
    display: none;
}

.logout-btn:active {
    transform: scale(0.95);
}

.loading-spinner {
    text-align: center;
    padding: 50px;
    font-size: 2rem;
    animation: pulse 1.5s infinite;
}

/* Migration Modal Styles */
.migration-preview {
    background: var(--dark-gray);
    padding: 15px;
    border-radius: 8px;
    margin: 15px 0;
}

.migration-stat {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid var(--steel);
}

.migration-stat:last-child {
    border-bottom: none;
}

.migration-stat span {
    color: var(--accent-dim);
}

.migration-stat strong {
    color: var(--accent);
}

/* HABIT MANAGEMENT STYLES */
.modal-large {
    max-width: 500px;
    max-height: 85vh;
    overflow-y: auto;
    overflow-x: hidden;
}

.habits-management-list {
    max-height: 250px;
    overflow-y: auto;
    margin-bottom: 15px;
}

.habit-management-item {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 12px;
    background: var(--dark-gray);
    border-radius: 8px;
    margin-bottom: 10px;
    border: 2px solid transparent;
    transition: all 0.2s;
}

.habit-management-header {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
}

.habit-management-description {
    width: 100%;
    padding-left: 85px;
}

.habit-desc-input {
    width: 100%;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 5px;
    padding: 8px 12px;
    color: var(--accent-dim);
    font-size: 0.8rem;
    font-family: inherit;
}

.habit-desc-input:focus {
    outline: none;
    border-color: var(--accent);
    color: var(--accent);
}

.habit-desc-input::placeholder {
    color: var(--accent-dark);
    font-style: italic;
}

.habit-management-item.editing {
    border-color: var(--accent);
    background: var(--charcoal);
}

.habit-color-indicator {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    border: 2px solid var(--steel);
    flex-shrink: 0;
}

.habit-icon-display {
    font-size: 1.5rem;
    width: 40px;
    text-align: center;
    flex-shrink: 0;
}

.habit-name-input {
    flex: 1;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 5px;
    padding: 8px 12px;
    color: var(--accent);
    font-size: 0.9rem;
    font-family: inherit;
}

.habit-name-input:focus {
    outline: none;
    border-color: var(--accent);
}

.habit-name-input:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.habit-actions {
    display: flex;
    gap: 5px;
}

.habit-action-btn {
    padding: 6px 10px;
    border: 1px solid var(--steel);
    background: var(--charcoal);
    color: var(--accent);
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.85rem;
    transition: all 0.2s;
}

.habit-action-btn:hover {
    background: var(--steel);
}

.habit-action-btn.delete {
    background: rgba(138, 58, 58, 0.3);
    border-color: #8A3A3A;
    color: #FF6B6B;
}

.habit-action-btn.delete:hover {
    background: rgba(138, 58, 58, 0.5);
}

.add-habit-section {
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 15px;
}

.add-habit-section.collapsed {
    padding: 0;
    background: transparent;
    border: none;
}

.add-habit-toggle {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, var(--charcoal), var(--dark-gray));
    border: 2px dashed var(--steel);
    color: var(--accent);
    border-radius: 10px;
    cursor: pointer;
    font-weight: bold;
    font-size: 0.85rem;
    transition: all 0.2s;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.add-habit-toggle:hover {
    background: var(--steel);
    border-style: solid;
}

.add-habit-form {
    display: none;
    padding-top: 15px;
}

.add-habit-form.active {
    display: block;
}

.form-group {
    margin-bottom: 12px;
}

.form-group label {
    display: block;
    color: var(--accent-dim);
    font-size: 0.75rem;
    font-weight: bold;
    text-transform: uppercase;
    margin-bottom: 6px;
    letter-spacing: 0.5px;
}

.form-group input[type="text"] {
    width: 100%;
    padding: 10px 12px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 8px;
    color: var(--accent);
    font-size: 0.95rem;
    font-family: inherit;
    box-sizing: border-box;
}

.form-group input[type="text"]:focus {
    outline: none;
    border-color: var(--accent);
}

.form-group textarea {
    width: 100%;
    padding: 10px 12px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 8px;
    color: var(--accent);
    font-size: 0.9rem;
    font-family: inherit;
    box-sizing: border-box;
    resize: vertical;
    min-height: 60px;
}

.form-group textarea:focus {
    outline: none;
    border-color: var(--accent);
}

.form-group textarea::placeholder {
    color: var(--accent-dark);
    font-style: italic;
}

.optional-label {
    font-weight: normal;
    font-size: 0.65rem;
    color: var(--accent-dark);
    text-transform: none;
}

.icon-picker {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 8px;
    margin-top: 10px;
    width: 100%;
    box-sizing: border-box;
}

.icon-option {
    font-size: 1.3rem;
    padding: 8px;
    text-align: center;
    background: var(--dark-gray);
    border: 2px solid var(--steel);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    aspect-ratio: 1;
    min-width: 0;
}

.icon-option:hover {
    background: var(--charcoal);
    border-color: var(--accent-dark);
}

.icon-option.selected {
    border-color: var(--accent);
    background: var(--accent);
}

.color-picker-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 8px;
    margin-top: 10px;
    width: 100%;
    box-sizing: border-box;
}

.color-option {
    width: 100%;
    aspect-ratio: 1;
    border-radius: 8px;
    cursor: pointer;
    border: 3px solid transparent;
    transition: all 0.2s;
    min-width: 0;
}

.color-option:hover {
    border-color: var(--accent-dark);
}

.color-option.selected {
    border-color: var(--accent);
    box-shadow: 0 0 10px var(--accent-green);
}

/* Responsive adjustments for habit creation */
@media (max-width: 360px) {
    .icon-picker {
        grid-template-columns: repeat(5, 1fr);
        gap: 5px;
    }

    .icon-option {
        font-size: 1.1rem;
        padding: 6px;
    }

    .color-picker-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 6px;
    }
}

@media (min-width: 361px) and (max-width: 480px) {
    .icon-picker {
        grid-template-columns: repeat(6, 1fr);
        gap: 6px;
    }

    .icon-option {
        font-size: 1.2rem;
        padding: 7px;
    }

    .color-picker-grid {
        grid-template-columns: repeat(5, 1fr);
        gap: 7px;
    }
}

.form-actions {
    display: flex;
    gap: 10px;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid var(--steel);
}

.form-btn {
    flex: 1;
    padding: 10px;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    border: none;
    transition: all 0.2s;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-size: 0.85rem;
}

.form-btn.cancel {
    background: var(--steel);
    color: var(--accent);
}

.form-btn.save {
    background: var(--accent);
    color: var(--black);
}

.form-btn:active {
    transform: scale(0.98);
}

.move-buttons {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.move-btn {
    padding: 4px 8px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    color: var(--accent-dim);
    border-radius: 3px;
    cursor: pointer;
    font-size: 0.7rem;
}

.move-btn:hover {
    background: var(--steel);
    color: var(--accent);
}

.move-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}


/* ============================================================ */
/* SYSTÈME DE POPUP/TOAST NOTIFICATIONS */
/* ============================================================ */

.toast-container {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 100000;
    display: flex;
    flex-direction: column;
    gap: 10px;
    width: calc(100% - 40px);
    max-width: 400px;
    pointer-events: none;
}

.toast {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 16px;
    border-radius: 12px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    pointer-events: auto;
    animation: toastSlideIn 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    position: relative;
    overflow: hidden;
}

.toast::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 4px;
}

.toast.toast-success::before {
    background: #2ECC71;
}

.toast.toast-error::before {
    background: #E74C3C;
}

.toast.toast-warning::before {
    background: #F39C12;
}

.toast.toast-info::before {
    background: #3498DB;
}

.toast.toast-closing {
    animation: toastSlideOut 0.3s ease-in forwards;
}

@keyframes toastSlideIn {
    from {
        opacity: 0;
        transform: translateY(-20px) scale(0.9);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes toastSlideOut {
    from {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
    to {
        opacity: 0;
        transform: translateY(-20px) scale(0.9);
    }
}

.toast-icon {
    font-size: 1.4rem;
    flex-shrink: 0;
    line-height: 1;
}

.toast-content {
    flex: 1;
    min-width: 0;
}

.toast-message {
    color: var(--accent);
    font-size: 0.9rem;
    line-height: 1.5;
    word-wrap: break-word;
}

.toast-close {
    background: none;
    border: none;
    color: var(--accent-dark);
    font-size: 1.2rem;
    cursor: pointer;
    padding: 0;
    line-height: 1;
    transition: color 0.2s, transform 0.2s;
    flex-shrink: 0;
}

.toast-close:hover {
    color: var(--accent);
    transform: scale(1.1);
}

.toast-close:focus {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
    border-radius: 4px;
}

.toast-progress {
    position: absolute;
    bottom: 0;
    left: 0;
    height: 3px;
    background: var(--accent);
    opacity: 0.5;
    animation: toastProgress linear forwards;
}

@keyframes toastProgress {
    from {
        width: 100%;
    }
    to {
        width: 0%;
    }
}

/* Responsive adjustments */
@media (max-width: 480px) {
    .toast-container {
        top: 10px;
        width: calc(100% - 20px);
    }

    .toast {
        padding: 14px;
    }

    .toast-message {
        font-size: 0.85rem;
    }
}

/* ============================================================ */
/* CALENDRIER VISUEL - IMPACT PSYCHOLOGIQUE */
/* ============================================================ */

.calendar-view-btn {
    width: calc(100% - 30px);
    margin: 15px;
    padding: 14px 24px;
    background: linear-gradient(135deg, rgba(30,30,30,0.9), rgba(20,20,20,0.9));
    border: 1.5px solid var(--steel);
    color: var(--accent);
    border-radius: 14px;
    font-size: 0.85rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    text-transform: uppercase;
    letter-spacing: 1.5px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    position: relative;
    overflow: hidden;
    backdrop-filter: blur(4px);
}

.calendar-view-btn::before {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(245,245,240,0.06), transparent);
    transition: left 0.5s ease;
}

.calendar-view-btn:hover::before {
    left: 100%;
}

.calendar-view-btn:hover {
    border-color: var(--accent-dim);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(245, 245, 240, 0.08);
}

.calendar-view-btn:active {
    transform: scale(0.97);
}

/* Modal calendrier */
.modal-calendar {
    max-width: 95%;
    width: 500px;
    max-height: 90vh;
    overflow-y: auto;
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    padding: 20px;
}

.calendar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 10px;
}

.calendar-header h3 {
    font-size: 1.1rem;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin: 0;
}

.calendar-nav-btn {
    background: var(--charcoal);
    border: 1px solid var(--steel);
    color: var(--accent);
    width: 40px;
    height: 40px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.calendar-nav-btn:hover {
    background: var(--steel);
    border-color: var(--accent);
}

.calendar-nav-btn:active {
    transform: scale(0.95);
}

.calendar-subtitle {
    text-align: center;
    font-size: 0.75rem;
    color: var(--accent-dark);
    margin-bottom: 15px;
    font-style: italic;
}

/* Légende */
.calendar-legend {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 15px;
    padding: 10px;
    background: var(--charcoal);
    border-radius: 8px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.7rem;
    color: var(--accent-dim);
}

.legend-box {
    width: 16px;
    height: 16px;
    border-radius: 4px;
}

.legend-success {
    background: linear-gradient(135deg, #2ECC71, #27AE60);
    box-shadow: 0 0 6px rgba(46, 204, 113, 0.4);
}

.legend-fail {
    background: linear-gradient(135deg, #E74C3C, #C0392B);
    box-shadow: 0 0 6px rgba(231, 76, 60, 0.4);
}

.legend-future {
    background: var(--steel);
    border: 1px dashed var(--accent-dark);
}

/* Container du calendrier */
.calendar-grid-container {
    max-height: 50vh;
    overflow-y: auto;
    padding-right: 5px;
}

/* Grille pour chaque habitude */
.calendar-habit-section {
    margin-bottom: 15px;
    background: var(--charcoal);
    border-radius: 10px;
    padding: 12px;
    border: 1px solid var(--steel);
}

.calendar-habit-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--steel);
}

.calendar-habit-icon {
    font-size: 1.3rem;
}

.calendar-habit-name {
    font-size: 0.85rem;
    font-weight: bold;
    color: var(--accent);
    flex: 1;
}

.calendar-habit-percent {
    font-size: 0.8rem;
    font-weight: bold;
    padding: 4px 10px;
    border-radius: 12px;
    background: var(--dark-gray);
}

.calendar-habit-percent.good {
    color: #2ECC71;
}

.calendar-habit-percent.medium {
    color: #F39C12;
}

.calendar-habit-percent.bad {
    color: #E74C3C;
}

/* Grille des jours */
.calendar-days-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 4px;
}

.calendar-day-header {
    text-align: center;
    font-size: 0.6rem;
    color: var(--accent-dark);
    font-weight: bold;
    text-transform: uppercase;
    padding: 5px 0;
}

.calendar-day {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    font-weight: bold;
    border-radius: 6px;
    transition: all 0.2s ease;
    position: relative;
}

.calendar-day.empty {
    background: transparent;
}

.calendar-day.success {
    background: linear-gradient(135deg, #2ECC71, #27AE60);
    color: white;
    box-shadow: 0 0 8px rgba(46, 204, 113, 0.3);
}

.calendar-day.fail {
    background: linear-gradient(135deg, #E74C3C, #C0392B);
    color: white;
    box-shadow: 0 0 8px rgba(231, 76, 60, 0.3);
}

.calendar-day.no-data {
    background: var(--charcoal);
    color: var(--accent-dark);
    opacity: 0.4;
}

.calendar-day.future {
    background: var(--steel);
    color: var(--accent-dark);
    opacity: 0.5;
}

.calendar-day.today {
    border: 2px solid var(--accent);
    box-shadow: 0 0 10px rgba(245, 245, 240, 0.3);
}

/* Résumé du mois */
.calendar-summary {
    margin-top: 15px;
    padding: 15px;
    background: var(--charcoal);
    border-radius: 10px;
    border: 1px solid var(--steel);
}

.summary-title {
    font-size: 0.75rem;
    color: var(--accent-dark);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 12px;
    text-align: center;
}

.summary-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
}

.summary-stat {
    text-align: center;
    padding: 10px;
    background: var(--dark-gray);
    border-radius: 8px;
}

.summary-stat-value {
    display: block;
    font-size: 1.5rem;
    font-weight: 900;
    margin-bottom: 4px;
}

.summary-stat-value.green {
    color: #2ECC71;
}

.summary-stat-value.red {
    color: #E74C3C;
}

.summary-stat-value.blue {
    color: #3498DB;
}

.summary-stat-label {
    font-size: 0.65rem;
    color: var(--accent-dark);
    text-transform: uppercase;
}

/* Message motivationnel */
.calendar-motivation {
    margin-top: 12px;
    padding: 12px;
    background: linear-gradient(90deg, rgba(46, 204, 113, 0.1), transparent);
    border-left: 3px solid #2ECC71;
    border-radius: 0 8px 8px 0;
    font-size: 0.8rem;
    color: var(--accent);
    font-style: italic;
}

.calendar-motivation.warning {
    background: linear-gradient(90deg, rgba(231, 76, 60, 0.1), transparent);
    border-left-color: #E74C3C;
}

/* Animation d'apparition des jours */
@keyframes dayPop {
    from {
        opacity: 0;
        transform: scale(0.5);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

.calendar-day {
    animation: dayPop 0.3s ease-out backwards;
}

/* Responsive */
@media (max-width: 400px) {
    .modal-calendar {
        padding: 15px;
    }

    .calendar-legend {
        gap: 10px;
        flex-wrap: wrap;
    }

    .legend-item {
        font-size: 0.6rem;
    }

    .calendar-day {
        font-size: 0.6rem;
    }

    .summary-stats {
        grid-template-columns: repeat(3, 1fr);
        gap: 6px;
    }

    .summary-stat-value {
        font-size: 1.2rem;
    }
}

/* ============================================================ */
/* STYLES POUR LA PAGE TODAY (MODULE)                           */
/* ============================================================ */

.today-page {
    padding: 20px;
    max-width: 600px;
    margin: 0 auto;
}

.today-header {
    text-align: center;
    margin-bottom: 25px;
}

.today-header h2 {
    font-size: 1.8rem;
    color: var(--accent);
    margin-bottom: 5px;
    text-transform: uppercase;
    letter-spacing: 2px;
}

.today-date {
    color: var(--accent-dark);
    font-size: 0.9rem;
    margin-bottom: 15px;
    text-transform: capitalize;
}

.today-score {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    padding: 15px;
    background: var(--charcoal);
    border-radius: 12px;
    border: 1px solid var(--steel);
}

.score-value {
    font-size: 2.5rem;
    font-weight: 900;
    color: var(--accent);
    text-shadow: 0 0 20px rgba(245, 245, 240, 0.3);
}

.score-label {
    font-size: 0.85rem;
    color: var(--accent-dark);
}

/* Liste des habitudes */
.habit-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 25px;
}

.habit-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 10px;
    transition: all 0.3s ease;
}

.habit-item:hover {
    border-color: var(--accent-dark);
    transform: translateX(5px);
}

.habit-item.completed {
    background: linear-gradient(90deg, rgba(46, 204, 113, 0.15), var(--charcoal));
    border-color: #2ECC71;
}

.habit-item.locked {
    opacity: 0.6;
    pointer-events: none;
}

.habit-info {
    display: flex;
    align-items: center;
    gap: 12px;
}

.habit-icon {
    font-size: 1.5rem;
}

.habit-name {
    font-size: 1rem;
    color: var(--accent);
    font-weight: 500;
}

.habit-checkbox {
    width: 24px;
    height: 24px;
    cursor: pointer;
    accent-color: #2ECC71;
}

.no-habits {
    text-align: center;
    color: var(--accent-dark);
    padding: 30px;
    font-style: italic;
}

/* Bouton de validation */
.validate-btn {
    width: 100%;
    padding: 18px 24px;
    font-size: 1.1rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    background: linear-gradient(135deg, var(--steel) 0%, var(--charcoal) 100%);
    color: var(--accent);
    border: 2px solid var(--steel);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.validate-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

.validate-btn:not(:disabled) {
    background: linear-gradient(135deg, #2ECC71 0%, #27AE60 100%);
    border-color: #2ECC71;
    color: #fff;
    box-shadow: 0 0 20px rgba(46, 204, 113, 0.4);
    animation: pulseGlow 2s ease-in-out infinite;
}

.validate-btn:not(:disabled):hover {
    transform: translateY(-2px);
    box-shadow: 0 0 30px rgba(46, 204, 113, 0.6);
}

.validate-btn:not(:disabled):active {
    transform: translateY(0);
}

.validate-btn.validated {
    background: linear-gradient(135deg, #27AE60 0%, #1E8449 100%);
    border-color: #27AE60;
    color: #fff;
    animation: none;
}

@keyframes pulseGlow {
    0%, 100% {
        box-shadow: 0 0 20px rgba(46, 204, 113, 0.4);
    }
    50% {
        box-shadow: 0 0 35px rgba(46, 204, 113, 0.7);
    }
}

/* Banner de journée validée */
.day-validated-banner {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 16px 20px;
    margin-bottom: 20px;
    background: linear-gradient(135deg, rgba(46, 204, 113, 0.2), rgba(39, 174, 96, 0.1));
    border: 2px solid #2ECC71;
    border-radius: 12px;
    animation: slideIn 0.5s ease-out;
}

.day-validated-banner.success-animation {
    animation: successPop 0.6s ease-out;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes successPop {
    0% {
        opacity: 0;
        transform: scale(0.5);
    }
    50% {
        transform: scale(1.05);
    }
    100% {
        opacity: 1;
        transform: scale(1);
    }
}

.validated-icon {
    font-size: 1.8rem;
    animation: bounce 1s ease infinite;
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); }
}

.validated-text {
    font-size: 1.1rem;
    font-weight: 600;
    color: #2ECC71;
    text-transform: uppercase;
    letter-spacing: 1px;
}

/* Animation confettis */
@keyframes confettiFall {
    0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
    }
}

.confetti {
    animation: confettiFall 3s linear forwards;
}

/* ============================================================
   SYSTÈME DE RANGS PERSONNALISABLES
   ============================================================ */

/* Bouton d'édition des rangs */
.edit-ranks-btn {
    background: transparent;
    border: 1px solid var(--steel);
    color: var(--accent-dim);
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.edit-ranks-btn:hover {
    background: var(--charcoal);
    color: var(--accent);
    border-color: var(--accent-dim);
}

.edit-ranks-btn:active {
    transform: scale(0.95);
}

/* Conteneur des boutons d'édition */
.rank-edit-buttons {
    display: flex;
    gap: 10px;
    padding: 0 15px 15px;
}

.rank-edit-buttons .modal-btn {
    flex: 1;
    padding: 12px;
    font-size: 0.9rem;
}

/* ============================================================
   SÉLECTEUR DE PALETTE DE COULEURS (GRILLE RESPONSIVE)
   ============================================================ */

.palette-selector {
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 10px;
    padding: 15px;
    margin-bottom: 15px;
}

.palette-selector-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 15px;
}

.palette-icon {
    font-size: 1.2rem;
}

.palette-label {
    font-size: 0.8rem;
    font-weight: bold;
    color: var(--accent);
    letter-spacing: 1px;
}

/* Grille des palettes */
.palette-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
}

/* Carte de palette individuelle */
.palette-card {
    background: var(--dark-gray);
    border: 2px solid var(--steel);
    border-radius: 10px;
    padding: 12px 10px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
}

.palette-card:hover {
    border-color: var(--accent-dim);
    transform: translateY(-2px);
}

.palette-card:active {
    transform: scale(0.98);
}

.palette-card.selected {
    border-color: var(--accent);
    background: rgba(245, 245, 240, 0.08);
    box-shadow: 0 0 0 1px var(--accent);
}

.palette-card.selected::before {
    content: '✓';
    position: absolute;
    top: 5px;
    right: 8px;
    font-size: 0.75rem;
    color: var(--accent);
    font-weight: bold;
}

/* Couleurs de la palette */
.palette-card-colors {
    display: flex;
    justify-content: center;
    gap: 4px;
    margin-bottom: 8px;
}

.palette-card-dot {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    border: 1px solid rgba(255, 255, 255, 0.2);
    flex-shrink: 0;
}

/* Nom de la palette */
.palette-card-name {
    font-size: 0.65rem;
    color: var(--accent-dim);
    text-align: center;
    font-weight: 500;
    letter-spacing: 0.5px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.palette-card.selected .palette-card-name {
    color: var(--accent);
}

/* Étoile recommandée */
.palette-recommended {
    position: absolute;
    top: 5px;
    left: 8px;
    font-size: 0.7rem;
    color: #FFD700;
}

/* Responsive - 3 colonnes sur écrans moyens */
@media (min-width: 400px) {
    .palette-grid {
        grid-template-columns: repeat(3, 1fr);
    }

    .palette-card-dot {
        width: 16px;
        height: 16px;
    }
}

/* Responsive - 4 colonnes sur grands écrans */
@media (min-width: 500px) {
    .palette-grid {
        grid-template-columns: repeat(4, 1fr);
    }
}

/* Responsive - petits écrans */
@media (max-width: 320px) {
    .palette-card {
        padding: 10px 8px;
    }

    .palette-card-dot {
        width: 14px;
        height: 14px;
    }

    .palette-card-name {
        font-size: 0.6rem;
    }
}

/* ============================================================
   CARTE DE RANG EN MODE ÉDITION
   ============================================================ */

/* Carte de rang en mode édition */
.rank-edit-card {
    padding: 12px !important;
}

.rank-edit-row {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
}

/* Aperçu de couleur du rang */
.rank-color-preview {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    flex-shrink: 0;
    border: 2px solid rgba(255, 255, 255, 0.2);
}

/* Input pour le nom du rang */
.rank-name-input {
    flex: 1;
    min-width: 100px;
    background: var(--charcoal);
    border: 1px solid;
    border-radius: 5px;
    padding: 8px 10px;
    font-size: 0.85rem;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.rank-name-input:focus {
    outline: none;
    box-shadow: 0 0 0 2px rgba(245, 245, 240, 0.2);
}

/* Score fixe (non modifiable) */
.rank-score-fixed {
    font-size: 0.75rem;
    font-weight: 600;
    padding: 6px 10px;
    background: var(--dark-gray);
    border-radius: 5px;
    white-space: nowrap;
    opacity: 0.8;
}

/* Responsive pour petits écrans */
@media (max-width: 360px) {
    .rank-edit-row {
        flex-direction: column;
        align-items: stretch;
    }

    .rank-name-input {
        width: 100%;
    }

    .rank-score-edit {
        justify-content: center;
    }

    .palette-color-dot {
        width: 24px;
        height: 24px;
    }
}

/* ============================================================
   SCHEDULE PICKER - Sélecteur de planification
   ============================================================ */

/* Conteneur des boutons de type de planification */
.schedule-type-picker {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.schedule-type-btn {
    flex: 1;
    padding: 12px 16px;
    border: 2px solid var(--steel);
    border-radius: 12px;
    background: var(--charcoal);
    color: var(--accent-dim);
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.schedule-type-btn:hover {
    border-color: var(--accent-dark);
}

.schedule-type-btn.active {
    border-color: var(--accent);
    background: var(--steel);
    color: var(--accent);
}

/* Sélecteur de jours de la semaine */
.days-of-week-picker {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 12px;
    flex-wrap: wrap;
    padding: 12px 8px;
    background: rgba(255,255,255,0.02);
    border-radius: 14px;
}

.day-checkbox {
    width: 44px;
    height: 44px;
    border-radius: 12px;
    border: 2px solid var(--steel);
    background: var(--charcoal);
    color: var(--accent-dim);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.85rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
}

.day-checkbox:hover {
    border-color: var(--accent-dark);
    transform: scale(1.05);
}

.day-checkbox.selected {
    border-color: var(--accent-green);
    background: rgba(25, 230, 57, 0.2);
    color: var(--accent-green);
}

/* Version mini pour la gestion des habitudes existantes */
.habit-management-schedule {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid var(--steel);
}

.schedule-type-picker-mini {
    display: flex;
    gap: 8px;
    margin-bottom: 10px;
}

.schedule-type-btn-mini {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid var(--steel);
    border-radius: 8px;
    background: var(--dark-gray);
    color: var(--accent-dim);
    font-size: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.schedule-type-btn-mini:hover {
    border-color: var(--accent-dark);
}

.schedule-type-btn-mini.active {
    border-color: var(--accent);
    background: var(--steel);
    color: var(--accent);
}

.days-of-week-picker-mini {
    display: flex;
    justify-content: center;
    gap: 6px;
    flex-wrap: wrap;
}

.day-checkbox-mini {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    border: 1px solid var(--steel);
    background: var(--dark-gray);
    color: var(--accent-dim);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
}

.day-checkbox-mini:hover {
    border-color: var(--accent-dark);
}

.day-checkbox-mini.selected {
    border-color: var(--accent-green);
    background: rgba(25, 230, 57, 0.15);
    color: var(--accent-green);
}

/* Responsive pour le schedule picker */
@media (max-width: 400px) {
    .schedule-type-picker {
        flex-direction: column;
    }

    .day-checkbox {
        width: 36px;
        height: 36px;
        font-size: 0.8rem;
    }

    .day-checkbox-mini {
        width: 28px;
        height: 28px;
        font-size: 0.65rem;
    }
}

/* ============================================================ */
/* SYSTÈME DE BADGES D'ACHIEVEMENTS */
/* ============================================================ */

.badges-header {
    padding: 15px;
    background: var(--dark-gray);
    border-bottom: 2px solid var(--steel);
}

.badges-title {
    font-size: 1rem;
    font-weight: 900;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 10px;
}

.badges-progress {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.85rem;
    color: var(--accent-dim);
    font-weight: 600;
}

.progress-bar-small {
    flex: 1;
    height: 8px;
    background: var(--charcoal);
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid var(--steel);
}

.progress-fill-small {
    height: 100%;
    background: linear-gradient(90deg, var(--accent-green), #27AE60);
    transition: width 0.5s ease;
    box-shadow: 0 0 10px rgba(25, 231, 57, 0.5);
}

.badges-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 12px;
    padding: 15px;
    background: var(--black);
}

.badge-card {
    position: relative;
    background: var(--dark-gray);
    border: 2px solid;
    border-radius: 12px;
    padding: 15px 10px;
    text-align: center;
    transition: all 0.3s ease;
    cursor: pointer;
    overflow: hidden;
}

.badge-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: currentColor;
    opacity: 0.5;
}

.badge-card.unlocked {
    transform: scale(1);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.badge-card.unlocked:hover {
    transform: translateY(-5px) scale(1.02);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
}

.badge-card.locked {
    opacity: 0.5;
    border-color: var(--steel);
}

.badge-icon {
    margin-bottom: 8px;
    transition: transform 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--accent-dim);
}

.badge-icon svg {
    width: 32px;
    height: 32px;
}

.badge-card.unlocked:hover .badge-icon {
    transform: scale(1.2) rotate(5deg);
}

.badge-icon.grayscale {
    filter: grayscale(100%);
    opacity: 0.3;
}

.badge-card.unlocked .badge-icon {
    filter: drop-shadow(0 0 6px currentColor);
}

.badge-name {
    font-size: 0.75rem;
    font-weight: bold;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 4px;
}

.badge-desc {
    font-size: 0.65rem;
    color: var(--accent-dark);
    line-height: 1.3;
}

.badge-lock {
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 1rem;
    opacity: 0.6;
}

/* Animation de déblocage */
@keyframes badgeUnlock {
    0% {
        transform: scale(0.5) rotate(-180deg);
        opacity: 0;
    }
    50% {
        transform: scale(1.2) rotate(10deg);
    }
    100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
    }
}

.badge-card.newly-unlocked {
    animation: badgeUnlock 0.6s ease-out;
}

/* Responsive badges */
@media (max-width: 600px) {
    .badges-grid {
        grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
        gap: 10px;
        padding: 10px;
    }

    .badge-card {
        padding: 12px 8px;
    }

    .badge-icon {
        font-size: 2rem;
    }

    .badge-name {
        font-size: 0.7rem;
    }

    .badge-desc {
        font-size: 0.6rem;
    }
}

/* Thème clair pour badges */
[data-theme="light"] .badges-header {
    background: var(--dark-gray);
    border-bottom: 2px solid var(--steel);
}

[data-theme="light"] .badges-grid {
    background: var(--black);
}

[data-theme="light"] .badge-card {
    background: var(--dark-gray);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .badge-card.unlocked {
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
}

[data-theme="light"] .badge-card.unlocked:hover {
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
}

/* Modal de confirmation - Doit être au-dessus du tutoriel */
#confirmModal {
    z-index: 35000 !important;
}

/* Assurer que les modals restent visibles en thème clair */
[data-theme="light"] .modal-overlay {
    background: rgba(255, 255, 255, 0.95);
    z-index: 25000 !important;
}

[data-theme="light"] #confirmModal {
    z-index: 35000 !important;
}

[data-theme="light"] .modal-calendar {
    background: var(--dark-gray);
    border: 2px solid var(--steel);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
}

/* ============================================================ */
/* PAGE PROFIL */
/* ============================================================ */

.profile-container {
    padding: 20px 15px;
}

.profile-avatar-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 25px;
    padding: 20px 0;
}

.profile-avatar {
    font-size: 4rem;
    width: 90px;
    height: 90px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--charcoal);
    border-radius: 50%;
    border: 3px solid var(--steel);
    margin-bottom: 10px;
}

.profile-change-avatar-btn {
    background: none;
    border: 1px solid var(--steel);
    color: var(--accent-dim);
    padding: 6px 16px;
    border-radius: 20px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s;
}

.profile-change-avatar-btn:hover {
    border-color: var(--accent);
    color: var(--accent);
}

.profile-info-section {
    margin-bottom: 25px;
}

.profile-field {
    display: flex;
    align-items: center;
    padding: 12px 15px;
    background: var(--charcoal);
    border-radius: 10px;
    margin-bottom: 8px;
    border: 1px solid var(--dark-gray);
}

.profile-label {
    font-size: 0.75rem;
    color: var(--accent-dim);
    text-transform: uppercase;
    letter-spacing: 1px;
    min-width: 60px;
}

.profile-value {
    flex: 1;
    color: var(--accent);
    font-size: 1rem;
    font-weight: bold;
    margin-left: 10px;
}

.profile-edit-btn {
    background: none;
    border: none;
    font-size: 1.1rem;
    cursor: pointer;
    padding: 5px;
    opacity: 0.6;
    transition: opacity 0.2s;
}

.profile-edit-btn:hover {
    opacity: 1;
}

/* Avatar Picker */
.avatar-picker-grid {
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    gap: 8px;
    padding: 15px 0;
}

.avatar-option {
    font-size: 1.8rem;
    width: 100%;
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--charcoal);
    border-radius: 10px;
    border: 2px solid transparent;
    cursor: pointer;
    transition: all 0.2s;
}

.avatar-option:hover {
    border-color: var(--steel);
    transform: scale(1.1);
}

.avatar-option.selected {
    border-color: var(--accent);
    background: var(--dark-gray);
}

/* Responsive avatar grid */
@media (max-width: 480px) {
    .avatar-picker-grid {
        grid-template-columns: repeat(6, 1fr);
    }
}

/* ============================================================
   GROUPS STYLES
   ============================================================ */

.groups-container {
    padding: 15px;
    padding-bottom: 100px;
}

.groups-header {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.group-action-btn {
    flex: 1;
    padding: 12px 16px;
    border: 1px solid var(--steel);
    border-radius: 12px;
    background: var(--dark-gray);
    color: var(--accent);
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
}

.group-action-btn:hover,
.group-action-btn:active {
    background: var(--charcoal);
    border-color: var(--accent-dim);
}

.group-action-btn-secondary {
    background: transparent;
}

/* Group cards */
.group-card {
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 12px;
    cursor: pointer;
    transition: transform 0.15s, box-shadow 0.15s;
}

.group-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.group-card:active {
    transform: translateY(0);
}

.group-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.group-card-name {
    font-size: 1.05rem;
    font-weight: 700;
    color: var(--accent);
}

.group-card-count {
    font-size: 0.75rem;
    color: var(--accent-dim);
}

.group-card-avatars {
    display: flex;
    gap: 4px;
    margin-bottom: 8px;
}

.group-card-avatar {
    font-size: 1.3rem;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--charcoal);
    border-radius: 50%;
}

.group-card-avatar-more {
    font-size: 0.7rem;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--charcoal);
    border-radius: 50%;
    color: var(--accent-dim);
}

.group-card-desc {
    font-size: 0.8rem;
    color: var(--accent-dim);
    line-height: 1.3;
}

/* Group empty state */
.group-empty {
    text-align: center;
    padding: 40px 20px;
    color: var(--accent-dim);
}

.group-empty-icon {
    font-size: 2.5rem;
    margin-bottom: 12px;
}

/* Group detail */
.group-detail {
    padding: 5px 0;
}

.group-detail-header {
    text-align: center;
    margin-bottom: 20px;
}

.group-detail-name {
    font-size: 1.3rem;
    font-weight: 800;
    color: var(--accent);
    margin: 0 0 6px;
}

.group-detail-desc {
    font-size: 0.85rem;
    color: var(--accent-dim);
    margin: 0 0 12px;
}

.group-code-section {
    margin: 14px 0;
}

.group-code-label {
    display: block;
    font-size: 0.7rem;
    color: var(--accent-dim);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 6px;
}

.group-code {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 10px;
    padding: 10px 18px;
    cursor: pointer;
    transition: border-color 0.2s;
}

.group-code:hover {
    border-color: var(--accent-dim);
}

.group-code-value {
    font-family: monospace;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--accent);
    letter-spacing: 4px;
}

.group-code-copy {
    font-size: 1.1rem;
}

.group-detail-count {
    font-size: 0.8rem;
    color: var(--accent-dim);
    margin-top: 10px;
}

/* Group habits */
.group-detail-habits {
    margin-bottom: 20px;
    padding: 12px;
    background: var(--charcoal);
    border-radius: 10px;
}

.group-detail-habits-title {
    font-size: 0.75rem;
    color: var(--accent-dim);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 8px;
}

.group-detail-habits-list {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.group-habit-tag {
    display: inline-block;
    padding: 4px 10px;
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    border-radius: 20px;
    font-size: 0.78rem;
    color: var(--accent);
}

/* Group members list */
.group-members-title {
    font-size: 0.85rem;
    font-weight: 700;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 12px;
    padding-bottom: 6px;
    border-bottom: 1px solid var(--steel);
}

.group-members-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 20px;
}

.group-member {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 12px;
    background: var(--charcoal);
    border-radius: 10px;
    border: 1px solid transparent;
    transition: border-color 0.2s;
}

.group-member-me {
    border-color: var(--accent-dim);
}

.group-member-position {
    font-size: 0.85rem;
    font-weight: 700;
    color: var(--accent-dim);
    min-width: 20px;
    text-align: center;
}

.group-member-avatar {
    font-size: 1.5rem;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.group-member-info {
    flex: 1;
    min-width: 0;
}

.group-member-pseudo {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--accent);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.group-member-rank {
    font-size: 0.65rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.group-member-score {
    font-size: 1rem;
    font-weight: 700;
    color: var(--accent);
    min-width: 40px;
    text-align: right;
}

.group-detail-actions {
    text-align: center;
    padding-top: 10px;
}

.group-danger-btn {
    padding: 10px 20px;
    background: transparent;
    border: 1px solid #8B0000;
    border-radius: 10px;
    color: #FF6B6B;
    font-size: 0.85rem;
    cursor: pointer;
    transition: background 0.2s;
}

.group-danger-btn:hover {
    background: rgba(139, 0, 0, 0.15);
}

/* Habits selection in create modal */
.group-habits-select {
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid var(--steel);
    border-radius: 8px;
    padding: 8px;
    background: var(--charcoal);
}

.group-habit-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 6px;
    cursor: pointer;
    border-radius: 6px;
    transition: background 0.15s;
}

.group-habit-checkbox:hover {
    background: var(--dark-gray);
}

.group-habit-checkbox input[type="checkbox"] {
    width: 18px;
    height: 18px;
    accent-color: var(--accent);
    cursor: pointer;
}

.group-habit-icon {
    font-size: 1.1rem;
}

.group-habit-name {
    font-size: 0.85rem;
    color: var(--accent);
}

/* Profile groups section */
.profile-groups-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.profile-group-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 14px;
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    border-radius: 10px;
    cursor: pointer;
    transition: border-color 0.2s;
}

.profile-group-item:hover {
    border-color: var(--accent-dim);
}

.profile-group-name {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--accent);
}

.profile-group-count {
    font-size: 0.8rem;
    color: var(--accent-dim);
}

/* Nav label size for 5 items */
.bottom-nav .nav-item .label {
    font-size: 0.55rem;
}

/* ============================================================ */
/* MICRO-INTERACTIONS & POLISH                                  */
/* ============================================================ */

/* Buttons - micro-interactions */
button, .modal-btn, .auth-btn, .settings-btn, .form-btn, .validate-day-btn {
    transition: transform 0.15s ease, background 0.2s ease, box-shadow 0.2s ease;
}

button:active, .modal-btn:active, .auth-btn:active, .settings-btn:active, .form-btn:active {
    transform: scale(0.95);
    opacity: 0.85;
}

/* Cards - hover lift */
.stat-card, .kpi-card {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.stat-card:hover, .kpi-card:hover {
    transform: translateY(-2px);
}

/* Chart wrapper improvements */
.chart-wrapper {
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 12px;
    padding: 18px;
    margin-bottom: 15px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

/* ============================================================ */
/* SKELETON LOADER                                              */
/* ============================================================ */

.skeleton {
    background: linear-gradient(90deg, var(--charcoal) 25%, var(--steel) 50%, var(--charcoal) 75%);
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
    border-radius: 8px;
}

.skeleton-habit {
    height: 65px;
    margin-bottom: 1px;
}

.skeleton-kpi {
    height: 80px;
    border-radius: 10px;
}

@keyframes shimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

/* ============================================================ */
/* PULL-TO-REFRESH VISUAL INDICATOR                             */
/* ============================================================ */

.pull-indicator {
    text-align: center;
    padding: 0;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease, padding 0.3s ease, opacity 0.3s ease;
    opacity: 0;
    color: var(--accent-dark);
    font-size: 0.75rem;
}

.pull-indicator.visible {
    max-height: 40px;
    padding: 10px 0;
    opacity: 1;
}

.pull-indicator .pull-icon {
    display: inline-block;
    animation: pullSpin 1s linear infinite;
}

@keyframes pullSpin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* ============================================================ */
/* LIGHT THEME - COMPREHENSIVE IMPROVEMENTS                     */
/* ============================================================ */

/* Bottom nav in light mode */
[data-theme="light"] .bottom-nav {
    background: var(--black);
    border-top: 1px solid var(--steel);
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .nav-item.active {
    background: var(--charcoal);
}

/* Inputs in light mode */
[data-theme="light"] .auth-form input,
[data-theme="light"] .form-group input[type="text"],
[data-theme="light"] .form-group textarea,
[data-theme="light"] .habit-name-input,
[data-theme="light"] .habit-desc-input,
[data-theme="light"] #editPseudoInput,
[data-theme="light"] #editBioInput,
[data-theme="light"] #setupPseudoInput,
[data-theme="light"] #deleteAccountInput,
[data-theme="light"] #joinGroupCode,
[data-theme="light"] #createGroupName,
[data-theme="light"] #createGroupDesc {
    background: var(--dark-gray);
    border-color: var(--steel);
    color: var(--accent);
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.06);
}

[data-theme="light"] .auth-form input:focus,
[data-theme="light"] .form-group input[type="text"]:focus,
[data-theme="light"] .form-group textarea:focus,
[data-theme="light"] .habit-name-input:focus,
[data-theme="light"] .habit-desc-input:focus {
    border-color: var(--accent-green);
    box-shadow: 0 0 0 3px rgba(25, 135, 84, 0.15);
}

/* Buttons in light mode */
[data-theme="light"] .auth-btn {
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

[data-theme="light"] .modal-btn.save {
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

[data-theme="light"] .modal-btn.cancel {
    background: var(--charcoal);
    border: 1px solid var(--steel);
}

[data-theme="light"] .validate-day-btn {
    box-shadow: 0 4px 15px rgba(25, 150, 57, 0.3), inset 0 1px 0 rgba(255,255,255,0.3);
}

[data-theme="light"] .validate-day-btn:hover {
    box-shadow: 0 8px 25px rgba(25, 150, 57, 0.35), inset 0 1px 0 rgba(255,255,255,0.3);
}

[data-theme="light"] .calendar-view-btn {
    background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(245,245,245,0.9));
    border-color: var(--steel);
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}

[data-theme="light"] .calendar-view-btn:hover {
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
}

[data-theme="light"] .share-day-btn {
    background: rgba(0,0,0,0.02);
    border-color: var(--steel);
}

[data-theme="light"] .share-day-btn:hover {
    background: rgba(0,0,0,0.04);
    box-shadow: 0 6px 20px rgba(0,0,0,0.08);
}

/* Cards depth in light mode */
[data-theme="light"] .kpi-card {
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.6);
    border-color: rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .stat-card {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

[data-theme="light"] .rank-display {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

[data-theme="light"] .motivation-card {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

/* Chart wrapper light mode */
[data-theme="light"] .chart-wrapper {
    background: var(--dark-gray);
    border-color: var(--steel);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

/* Date nav light mode */
[data-theme="light"] .date-nav {
    background: var(--dark-gray);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

/* Group cards light mode */
[data-theme="light"] .group-card {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

[data-theme="light"] .group-card:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

/* Profile in light mode */
[data-theme="light"] .profile-avatar {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .profile-field {
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.04);
}

/* Weekly grid light mode */
[data-theme="light"] .weekly-day {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
}

/* Toast in light mode */
[data-theme="light"] .toast {
    background: var(--dark-gray);
    border-color: var(--steel);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12);
}

/* Skeleton in light mode */
[data-theme="light"] .skeleton {
    background: linear-gradient(90deg, var(--charcoal) 25%, var(--dark-gray) 50%, var(--charcoal) 75%);
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
}

/* Ripple effect in light mode */
[data-theme="light"] .habit-item::after {
    background: rgba(0, 0, 0, 0.06);
}

/* Badge cards in light mode */
[data-theme="light"] .badge-card {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

/* Settings in light mode - additional contrast */
[data-theme="light"] .settings-category {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    border-image: none;
    border: 1px solid var(--steel);
    border-radius: 8px;
    clip-path: none;
}

[data-theme="light"] .settings-btn {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
}

/* Add habit section in light mode */
[data-theme="light"] .add-habit-section {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

/* Group habit select in light mode */
[data-theme="light"] .group-habits-select {
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.06);
}

/* ============================================================ */
/* PWA INSTALL BANNER                                           */
/* ============================================================ */

.install-banner {
    position: fixed;
    bottom: calc(60px + env(safe-area-inset-bottom));
    left: 0;
    right: 0;
    background: var(--dark-gray);
    border-top: 3px solid var(--accent-green);
    padding: 16px 20px;
    z-index: 99;
    display: none;
    flex-direction: column;
    gap: 12px;
    transform: translateY(100%);
    transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
}

.install-banner.visible {
    transform: translateY(0);
}

.install-banner-content {
    display: flex;
    align-items: center;
    gap: 12px;
}

.install-banner-icon {
    font-size: 2rem;
    flex-shrink: 0;
}

.install-banner-text {
    flex: 1;
}

.install-banner-title {
    font-size: 0.95rem;
    font-weight: 700;
    color: var(--accent);
    letter-spacing: 0.5px;
}

.install-banner-desc {
    font-size: 0.8rem;
    color: var(--accent-dim);
    margin-top: 2px;
}

.install-banner-actions {
    display: flex;
    gap: 10px;
}

.install-banner-btn {
    flex: 1;
    padding: 10px 16px;
    border-radius: 8px;
    font-size: 0.85rem;
    font-weight: 700;
    cursor: pointer;
    border: none;
    transition: all 0.2s ease;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.install-banner-btn.dismiss {
    background: var(--charcoal);
    color: var(--accent-dim);
    border: 1px solid var(--steel);
}

.install-banner-btn.dismiss:hover {
    background: var(--steel);
    color: var(--accent);
}

.install-banner-btn.install {
    background: var(--accent-green);
    color: var(--black);
}

.install-banner-btn.install:hover {
    box-shadow: 0 0 15px rgba(25, 230, 57, 0.3);
}

.install-banner-btn:active {
    transform: scale(0.97);
}

/* ============================================================ */
/* SHARE DAY BUTTON                                             */
/* ============================================================ */

.share-day-btn {
    width: calc(100% - 30px);
    margin: 8px 15px 20px 15px;
    padding: 14px 24px;
    background: rgba(245, 245, 240, 0.05);
    color: var(--accent);
    border: 1.5px solid var(--steel);
    border-radius: 14px;
    font-size: 0.85rem;
    font-weight: 700;
    letter-spacing: 1.5px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    text-transform: uppercase;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    backdrop-filter: blur(4px);
    position: relative;
    overflow: hidden;
}

.share-day-btn::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 14px;
    background: linear-gradient(135deg, rgba(245,245,240,0.08), transparent);
    opacity: 0;
    transition: opacity 0.3s;
}

.share-day-btn:hover {
    border-color: var(--accent);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(245, 245, 240, 0.08);
}

.share-day-btn:hover::after {
    opacity: 1;
}

.share-day-btn:active {
    transform: scale(0.97);
}

/* Light theme */
[data-theme="light"] .install-banner {
    background: var(--dark-gray);
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
}

/* ============================================================ */
/* HEATMAP (style GitHub)                                       */
/* ============================================================ */

.heatmap-container { padding: 15px; overflow-x: auto; }
.heatmap-grid { display: grid; grid-template-rows: repeat(7, 12px); grid-auto-flow: column; gap: 3px; }
.heatmap-cell { width: 12px; height: 12px; border-radius: 2px; cursor: pointer; transition: transform 0.15s; }
.heatmap-cell:hover { transform: scale(1.5); z-index: 1; }
.heatmap-tooltip { position: absolute; background: var(--dark-gray); border: 1px solid var(--steel); padding: 6px 10px; border-radius: 6px; font-size: 0.75rem; pointer-events: none; z-index: 100; white-space: nowrap; color: var(--accent); }
.heatmap-months { display: flex; gap: 3px; margin-bottom: 6px; font-size: 0.65rem; color: var(--accent-dim); }

/* ============================================================ */
/* CELEBRATION OVERLAY                                          */
/* ============================================================ */

.celebration-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.85);
    z-index: 50000;
    display: none;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    cursor: pointer;
}

.celebration-overlay.active {
    display: flex;
    opacity: 1;
}

.celebration-content {
    text-align: center;
    animation: celebrationIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.celebration-icon {
    font-size: 5rem;
    animation: celebrationBounce 1s ease-in-out infinite;
    filter: drop-shadow(0 0 20px currentColor);
}

.celebration-title {
    font-size: 2rem;
    font-weight: 900;
    letter-spacing: 3px;
    margin-top: 20px;
    text-shadow: 0 0 30px currentColor;
}

.celebration-subtitle {
    font-size: 1.1rem;
    color: var(--accent-dim);
    margin-top: 10px;
    font-weight: 600;
}

@keyframes celebrationIn {
    from { opacity: 0; transform: scale(0.3) rotate(-10deg); }
    to { opacity: 1; transform: scale(1) rotate(0deg); }
}

@keyframes celebrationBounce {
    0%, 100% { transform: translateY(0) scale(1); }
    50% { transform: translateY(-15px) scale(1.1); }
}

/* ============================================================ */
/* LEVEL UP OVERLAY — ÉPIQUE RPG                                */
/* ============================================================ */

.levelup-overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0, 0, 0, 0.0);
    backdrop-filter: blur(0px);
    -webkit-backdrop-filter: blur(0px);
    z-index: 60000;
    display: none;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    cursor: pointer;
    transition: background 0.4s ease, backdrop-filter 0.4s ease;
}

.levelup-overlay.active {
    display: flex;
    animation: levelupOverlayIn 0.5s ease forwards;
}

.levelup-overlay.closing {
    animation: levelupOverlayOut 0.5s ease forwards;
}

@keyframes levelupOverlayIn {
    from {
        background: rgba(0, 0, 0, 0.0);
        backdrop-filter: blur(0px);
        -webkit-backdrop-filter: blur(0px);
    }
    to {
        background: rgba(0, 0, 0, 0.85);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
    }
}

@keyframes levelupOverlayOut {
    from {
        opacity: 1;
        transform: scale(1);
    }
    to {
        opacity: 0;
        transform: scale(0.9);
    }
}

.levelup-canvas {
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}

.levelup-content {
    position: relative;
    z-index: 2;
    text-align: center;
    animation: levelupContentIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
    animation-delay: 0.1s;
    opacity: 0;
}

@keyframes levelupContentIn {
    0% {
        opacity: 0;
        transform: scale(0.3) translateY(40px);
    }
    70% {
        transform: scale(1.1) translateY(-5px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.levelup-flash {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 300px;
    height: 300px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255, 215, 0, 0.3) 0%, transparent 70%);
    animation: levelupFlashPulse 1.5s ease-in-out infinite;
    pointer-events: none;
}

@keyframes levelupFlashPulse {
    0%, 100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0.6;
    }
    50% {
        transform: translate(-50%, -50%) scale(1.3);
        opacity: 1;
    }
}

.levelup-title {
    font-size: 3rem;
    font-weight: 900;
    letter-spacing: 6px;
    color: #FFD700;
    text-shadow:
        0 0 20px rgba(255, 215, 0, 0.8),
        0 0 40px rgba(255, 215, 0, 0.5),
        0 0 80px rgba(255, 215, 0, 0.3);
    animation: levelupTitleGlow 1.2s ease-in-out infinite alternate;
    margin-bottom: 15px;
}

@keyframes levelupTitleGlow {
    from {
        text-shadow:
            0 0 20px rgba(255, 215, 0, 0.8),
            0 0 40px rgba(255, 215, 0, 0.5),
            0 0 80px rgba(255, 215, 0, 0.3);
        transform: scale(1);
    }
    to {
        text-shadow:
            0 0 30px rgba(255, 215, 0, 1),
            0 0 60px rgba(255, 215, 0, 0.7),
            0 0 100px rgba(255, 215, 0, 0.4),
            0 0 150px rgba(255, 215, 0, 0.2);
        transform: scale(1.05);
    }
}

.levelup-level-container {
    margin: 20px 0 30px;
}

.levelup-label {
    font-size: 0.9rem;
    font-weight: 700;
    letter-spacing: 4px;
    color: rgba(255, 215, 0, 0.6);
    margin-bottom: 5px;
}

.levelup-number {
    font-size: 6rem;
    font-weight: 900;
    color: #FFF;
    text-shadow:
        0 0 30px rgba(255, 215, 0, 0.6),
        0 0 60px rgba(255, 215, 0, 0.3);
    line-height: 1;
    font-variant-numeric: tabular-nums;
}

.levelup-xp-bar {
    width: 220px;
    height: 8px;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 4px;
    margin: 0 auto 25px;
    overflow: hidden;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
}

.levelup-xp-bar-fill {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #FFD700, #FFA500, #FFD700);
    border-radius: 4px;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
    transition: width 1.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.levelup-tap {
    font-size: 0.75rem;
    letter-spacing: 3px;
    color: rgba(255, 255, 255, 0.4);
    animation: levelupTapPulse 2s ease-in-out infinite;
}

@keyframes levelupTapPulse {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.7; }
}

/* ============================================================ */
/* SPLASH SCREEN                                                */
/* ============================================================ */

.splash-screen {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: #0A0A0A;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    transition: opacity 0.5s ease, visibility 0.5s ease;
}
.splash-screen.hidden {
    opacity: 0;
    visibility: hidden;
}
.splash-content {
    text-align: center;
}
.splash-logo {
    width: 80px;
    height: 80px;
    margin-bottom: 20px;
    animation: splashPulse 1.5s ease-in-out infinite;
}
.splash-arrow {
    stroke-dasharray: 200;
    stroke-dashoffset: 200;
    animation: splashDraw 1.2s ease-out forwards;
}
.splash-arrowhead {
    stroke-dasharray: 50;
    stroke-dashoffset: 50;
    animation: splashDraw 0.8s ease-out 0.5s forwards;
}
@keyframes splashDraw {
    to { stroke-dashoffset: 0; }
}
@keyframes splashPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}
.splash-title {
    font-size: 1.5rem;
    font-weight: 800;
    letter-spacing: 4px;
    color: #F5F5F0;
    margin-bottom: 8px;
}
.splash-tagline {
    font-size: 0.85rem;
    color: #8A8A85;
    letter-spacing: 2px;
    margin-bottom: 30px;
}
.splash-loader {
    width: 40px;
    height: 3px;
    background: #1E1E1E;
    border-radius: 3px;
    margin: 0 auto;
    overflow: hidden;
    position: relative;
}
.splash-loader::after {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 60%;
    background: #19E639;
    border-radius: 3px;
    animation: splashLoad 1.2s ease-in-out infinite;
}
@keyframes splashLoad {
    0% { left: -60%; }
    100% { left: 100%; }
}

/* ============================================================ */
/* ONBOARDING OVERLAY                                           */
/* ============================================================ */

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.onboarding-overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0, 0, 0, 0.9);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9000;
    padding: 20px;
}
.onboarding-overlay.active {
    display: flex;
}
.onboarding-card {
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    border-radius: 16px;
    padding: 40px 30px;
    max-width: 380px;
    width: 100%;
    text-align: center;
    position: relative;
    animation: modalIn 0.3s ease;
}
.onboarding-skip {
    position: absolute;
    top: 12px;
    right: 16px;
    background: none;
    border: none;
    color: var(--accent-dim);
    font-size: 0.8rem;
    cursor: pointer;
    padding: 4px 8px;
}
.onboarding-icon {
    font-size: 3.5rem;
    margin-bottom: 20px;
    animation: float 3s ease-in-out infinite;
}
.onboarding-title {
    font-size: 1.2rem;
    font-weight: 700;
    letter-spacing: 2px;
    color: var(--accent);
    margin-bottom: 12px;
}
.onboarding-text {
    font-size: 0.9rem;
    color: var(--accent-dim);
    line-height: 1.6;
    margin-bottom: 24px;
}
.onboarding-dots {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 24px;
}
.onboarding-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--steel);
    transition: background 0.3s, transform 0.3s;
}
.onboarding-dot.active {
    background: var(--accent-green);
    transform: scale(1.3);
}
.onboarding-buttons {
    display: flex;
    gap: 10px;
}
.onboarding-btn {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 8px;
    font-size: 0.85rem;
    font-weight: 700;
    letter-spacing: 1px;
    cursor: pointer;
    transition: transform 0.15s, background 0.2s;
}
.onboarding-btn:active { transform: scale(0.97); }
.onboarding-btn.primary {
    background: var(--accent);
    color: var(--black);
}
.onboarding-btn.secondary {
    background: var(--charcoal);
    color: var(--accent-dim);
}

/* ============================================================ */
/* CATEGORY PICKER & FILTERS                                    */
/* ============================================================ */

.category-picker {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}
.category-option {
    padding: 6px 12px;
    border-radius: 20px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    color: var(--accent-dim);
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s;
}
.category-option.active {
    background: var(--accent);
    color: var(--black);
    border-color: var(--accent);
}
.category-filters {
    display: flex;
    gap: 6px;
    padding: 0 15px 10px;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}
.category-filter {
    padding: 5px 12px;
    border-radius: 16px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    color: var(--accent-dim);
    font-size: 0.75rem;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s;
}
.category-filter.active {
    background: var(--accent-green);
    color: var(--black);
    border-color: var(--accent-green);
}
.category-filters::-webkit-scrollbar { display: none; }

/* Light theme variants for categories & onboarding */
[data-theme="light"] .category-option {
    background: var(--dark-gray);
    border-color: var(--steel);
    color: var(--accent-dim);
}
[data-theme="light"] .category-option.active {
    background: var(--accent);
    color: var(--dark-gray);
    border-color: var(--accent);
}
[data-theme="light"] .category-filter {
    background: var(--dark-gray);
    border-color: var(--steel);
    color: var(--accent-dim);
}
[data-theme="light"] .category-filter.active {
    background: var(--accent-green);
    color: var(--dark-gray);
    border-color: var(--accent-green);
}
[data-theme="light"] .onboarding-overlay {
    background: rgba(255, 255, 255, 0.95);
}
[data-theme="light"] .onboarding-card {
    background: var(--dark-gray);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
}

/* ============================================================ */
/* ONBOARDING AMÉLIORÉ - Création d'habitudes                   */
/* ============================================================ */

.habit-onboarding-overlay {
    position: fixed;
    inset: 0;
    background: rgba(5, 5, 5, 0.97);
    z-index: 30000;
    display: none;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.4s ease;
}

.habit-onboarding-overlay.active {
    display: flex;
    opacity: 1;
}

.onb-container {
    width: 100%;
    max-width: 480px;
    max-height: 90vh;
    padding: 30px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
}

/* Dots navigation */
.onb-dots {
    display: flex;
    gap: 10px;
    margin-bottom: 30px;
}

.onb-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--steel);
    transition: all 0.3s ease;
}

.onb-dot.active {
    background: var(--accent);
    box-shadow: 0 0 10px rgba(245, 245, 240, 0.4);
    transform: scale(1.2);
}

/* Steps container */
.onb-steps-container {
    width: 100%;
    transition: transform 0.3s ease, opacity 0.3s ease;
}

.onb-steps-container.slide-out-left {
    transform: translateX(-30px);
    opacity: 0;
}
.onb-steps-container.slide-in-right {
    animation: slideInRight 0.4s ease forwards;
}
.onb-steps-container.slide-out-right {
    transform: translateX(30px);
    opacity: 0;
}
.onb-steps-container.slide-in-left {
    animation: slideInLeft 0.4s ease forwards;
}

@keyframes slideInRight {
    from { transform: translateX(30px); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}
@keyframes slideInLeft {
    from { transform: translateX(-30px); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

/* Step content */
.onb-step {
    text-align: center;
    width: 100%;
}

.onb-big-icon {
    font-size: 4rem;
    margin-bottom: 20px;
    animation: onbIconPulse 2s ease-in-out infinite;
}

@keyframes onbIconPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

.onb-title {
    font-size: 1.8rem;
    font-weight: 900;
    color: var(--accent);
    margin-bottom: 8px;
    letter-spacing: 1px;
}

.onb-subtitle {
    font-size: 1rem;
    color: var(--accent-dim);
    margin-bottom: 20px;
}

.onb-text {
    font-size: 0.9rem;
    color: var(--accent-dark);
    line-height: 1.6;
    margin-bottom: 30px;
    padding: 0 10px;
}

/* CTA Button */
.onb-cta-btn {
    display: inline-block;
    padding: 16px 40px;
    background: linear-gradient(135deg, #19E639, #0DBF2F);
    color: #0A0A0A;
    border: none;
    border-radius: 14px;
    font-size: 1rem;
    font-weight: 800;
    cursor: pointer;
    letter-spacing: 1px;
    text-transform: uppercase;
    transition: all 0.3s ease;
    box-shadow: 0 4px 20px rgba(25, 230, 57, 0.3);
    position: relative;
    overflow: hidden;
}

.onb-cta-btn::before {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s ease;
}

.onb-cta-btn:hover::before {
    left: 100%;
}

.onb-cta-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 25px rgba(25, 230, 57, 0.4);
}

.onb-cta-btn:active {
    transform: scale(0.97);
}

.onb-cta-btn.disabled {
    background: var(--steel);
    color: var(--accent-dark);
    box-shadow: none;
    cursor: not-allowed;
}

.onb-cta-btn.disabled:hover {
    transform: none;
    box-shadow: none;
}

.onb-cta-btn.disabled::before {
    display: none;
}

.onb-cta-btn.shake {
    animation: onbShake 0.5s ease;
}

@keyframes onbShake {
    0%, 100% { transform: translateX(0); }
    20% { transform: translateX(-8px); }
    40% { transform: translateX(8px); }
    60% { transform: translateX(-4px); }
    80% { transform: translateX(4px); }
}

/* Back button */
.onb-back-btn {
    padding: 12px 24px;
    background: transparent;
    color: var(--accent-dim);
    border: 1px solid var(--steel);
    border-radius: 10px;
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.onb-back-btn:hover {
    border-color: var(--accent);
    color: var(--accent);
}

/* Templates grid */
.onb-templates-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin: 20px 0 30px;
    padding: 0 5px;
}

.onb-template-card {
    background: var(--charcoal);
    border: 2px solid var(--steel);
    border-radius: 14px;
    padding: 16px 10px;
    cursor: pointer;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    text-align: center;
    overflow: hidden;
}

.onb-template-card:hover {
    border-color: var(--accent-dim);
    transform: translateY(-2px);
}

.onb-template-card.selected {
    border-color: #19E639;
    background: rgba(25, 230, 57, 0.08);
    box-shadow: 0 0 20px rgba(25, 230, 57, 0.15);
}

.onb-template-card:active {
    transform: scale(0.96);
}

.onb-template-check {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    border: 2px solid var(--steel);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.25s ease;
    background: transparent;
}

.onb-template-check svg {
    width: 14px;
    height: 14px;
    opacity: 0;
    transition: opacity 0.2s ease;
    color: white;
}

.onb-template-card.selected .onb-template-check {
    background: #19E639;
    border-color: #19E639;
}

.onb-template-card.selected .onb-template-check svg {
    opacity: 1;
}

.onb-template-icon {
    font-size: 2.2rem;
    margin-bottom: 8px;
}

.onb-template-name {
    font-size: 0.75rem;
    font-weight: 800;
    color: var(--accent);
    letter-spacing: 0.5px;
    margin-bottom: 4px;
}

.onb-template-desc {
    font-size: 0.65rem;
    color: var(--accent-dark);
    line-height: 1.3;
}

/* Custom habit section */
.onb-custom-section {
    margin: 20px 0 24px;
    padding: 0 5px;
}

.onb-custom-title {
    font-size: 0.85rem;
    font-weight: 700;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 12px;
    text-align: center;
}

.onb-custom-input-row {
    display: flex;
    align-items: center;
    gap: 8px;
}

.onb-custom-emoji-btn {
    width: 44px;
    height: 44px;
    border-radius: 10px;
    border: 1px solid var(--steel);
    background: var(--charcoal);
    font-size: 1.3rem;
    cursor: pointer;
    flex-shrink: 0;
    transition: all 0.2s;
}

.onb-custom-emoji-btn:active {
    transform: scale(0.95);
}

.onb-custom-input {
    flex: 1;
    padding: 12px 14px;
    border-radius: 10px;
    border: 1px solid var(--steel);
    background: var(--charcoal);
    color: var(--accent);
    font-size: 0.9rem;
    font-weight: 600;
    outline: none;
    transition: border-color 0.2s;
}

.onb-custom-input:focus {
    border-color: var(--accent-green);
}

.onb-custom-input::placeholder {
    color: var(--accent-dim);
    font-weight: 400;
}

.onb-custom-add-btn {
    width: 44px;
    height: 44px;
    border-radius: 10px;
    border: none;
    background: var(--accent-green);
    color: var(--black);
    font-size: 1.2rem;
    cursor: pointer;
    flex-shrink: 0;
    transition: all 0.2s;
}

.onb-custom-add-btn:active {
    transform: scale(0.9);
}

.onb-custom-add-btn.added {
    background: var(--accent-green);
}

.onb-emoji-picker {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    padding: 10px;
    margin-top: 8px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 10px;
    justify-content: center;
}

.onb-emoji-option {
    width: 38px;
    height: 38px;
    border: none;
    background: var(--dark-gray);
    border-radius: 8px;
    font-size: 1.2rem;
    cursor: pointer;
    transition: all 0.15s;
}

.onb-emoji-option:active {
    transform: scale(0.9);
    background: var(--accent-green);
}

.onb-custom-added {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 10px;
    padding: 10px 14px;
    background: rgba(25, 230, 57, 0.1);
    border: 1px solid rgba(25, 230, 57, 0.3);
    border-radius: 10px;
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--accent-green);
}

.onb-custom-remove {
    background: none;
    border: none;
    color: var(--accent-dim);
    font-size: 1rem;
    cursor: pointer;
    padding: 4px 8px;
}

/* Light theme */
[data-theme="light"] .onb-custom-emoji-btn,
[data-theme="light"] .onb-custom-input {
    background: #E9ECEF;
    border-color: #DEE2E6;
    color: #212529;
}

[data-theme="light"] .onb-emoji-picker {
    background: #E9ECEF;
    border-color: #DEE2E6;
}

[data-theme="light"] .onb-emoji-option {
    background: #F8F9FA;
}

/* Templates actions */
.onb-templates-actions {
    display: flex;
    gap: 12px;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
}

/* Recap list */
.onb-recap-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin: 20px auto 25px;
    max-width: 300px;
}

.onb-recap-habit {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    background: var(--charcoal);
    border-radius: 10px;
    border-left: 3px solid #19E639;
    animation: onbRecapIn 0.4s ease backwards;
}

.onb-recap-habit:nth-child(1) { animation-delay: 0.1s; }
.onb-recap-habit:nth-child(2) { animation-delay: 0.15s; }
.onb-recap-habit:nth-child(3) { animation-delay: 0.2s; }
.onb-recap-habit:nth-child(4) { animation-delay: 0.25s; }
.onb-recap-habit:nth-child(5) { animation-delay: 0.3s; }
.onb-recap-habit:nth-child(6) { animation-delay: 0.35s; }
.onb-recap-habit:nth-child(7) { animation-delay: 0.4s; }
.onb-recap-habit:nth-child(8) { animation-delay: 0.45s; }

@keyframes onbRecapIn {
    from { opacity: 0; transform: translateX(-15px); }
    to { opacity: 1; transform: translateX(0); }
}

.onb-recap-icon {
    font-size: 1.4rem;
}

.onb-recap-name {
    font-size: 0.85rem;
    font-weight: 700;
    color: var(--accent);
}

/* Light theme */
[data-theme="light"] .habit-onboarding-overlay {
    background: rgba(248, 249, 250, 0.98);
}

[data-theme="light"] .onb-template-card {
    background: var(--dark-gray);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

[data-theme="light"] .onb-template-card.selected {
    background: rgba(25, 135, 84, 0.06);
    border-color: #198754;
    box-shadow: 0 0 20px rgba(25, 135, 84, 0.12);
}

[data-theme="light"] .onb-template-card.selected .onb-template-check {
    background: #198754;
    border-color: #198754;
}

[data-theme="light"] .onb-cta-btn {
    background: linear-gradient(135deg, #198754, #157347);
    box-shadow: 0 4px 20px rgba(25, 135, 84, 0.25);
}

[data-theme="light"] .onb-recap-habit {
    background: var(--dark-gray);
    border-left-color: #198754;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
}

[data-theme="light"] .onb-dot.active {
    background: var(--accent);
    box-shadow: 0 0 8px rgba(33, 37, 41, 0.3);
}

/* Responsive - petit écran */
@media (max-width: 380px) {
    .onb-templates-grid {
        gap: 8px;
    }
    .onb-template-card {
        padding: 12px 8px;
    }
    .onb-template-icon {
        font-size: 1.8rem;
    }
    .onb-title {
        font-size: 1.4rem;
    }
    .onb-big-icon {
        font-size: 3rem;
    }
}

/* ============================================================ */
/* ACCESSIBILITÉ - Focus visible                                */
/* ============================================================ */

:focus-visible {
    outline: 2px solid var(--accent-green);
    outline-offset: 2px;
}

/* ============================================================ */
/* BARRE XP                                                     */
/* ============================================================ */

.xp-bar-container {
    margin: 0 15px 15px;
    padding: 14px 16px;
    background: linear-gradient(145deg, var(--dark-gray), rgba(30, 30, 30, 0.9));
    border: 1px solid var(--steel);
    border-radius: 14px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.04);
}
.xp-bar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}
.xp-level {
    font-size: 0.85rem;
    font-weight: 800;
    letter-spacing: 2px;
    color: var(--accent-green);
    text-shadow: 0 0 10px rgba(25, 230, 57, 0.3);
}
.xp-amount {
    font-size: 0.75rem;
    color: var(--accent-dim);
}
.xp-bar {
    height: 14px;
    background: var(--charcoal);
    border-radius: 8px;
    overflow: hidden;
    position: relative;
    box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.5), inset 0 -1px 2px rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(0, 0, 0, 0.3);
}
.xp-bar-fill {
    height: 100%;
    background: linear-gradient(180deg, #5BF27E 0%, var(--accent-green) 40%, #1AAF3D 100%);
    border-radius: 7px;
    transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 0 12px rgba(25, 230, 57, 0.4), inset 0 2px 3px rgba(255, 255, 255, 0.35), inset 0 -2px 3px rgba(0, 0, 0, 0.2);
    position: relative;
}
/* Glossy shine stripe on the fill */
.xp-bar-fill::after {
    content: '';
    position: absolute;
    top: 1px;
    left: 4px;
    right: 4px;
    height: 40%;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.35), transparent);
    border-radius: 4px;
    pointer-events: none;
}
.xp-today {
    font-size: 0.7rem;
    color: var(--accent-dim);
    text-align: right;
    margin-top: 8px;
}

.xp-bar-header {
    position: relative;
}
.xp-info-btn {
    cursor: pointer;
    font-size: 0.75rem;
    opacity: 0.6;
    transition: opacity 0.2s;
    padding: 2px 4px;
}
.xp-info-btn:hover {
    opacity: 1;
}
.xp-status {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 6px;
}
.xp-fatigue-badge {
    font-size: 0.65rem;
    font-weight: 700;
    color: #FF6B6B;
    background: rgba(255, 107, 107, 0.1);
    padding: 2px 8px;
    border-radius: 10px;
    letter-spacing: 1px;
    animation: fatiguePulse 2s ease-in-out infinite;
}
@keyframes fatiguePulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}
.xp-info-panel {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid var(--steel);
    animation: slideDown 0.2s ease;
}
@keyframes slideDown {
    from { opacity: 0; max-height: 0; }
    to { opacity: 1; max-height: 500px; }
}
.xp-info-title {
    font-size: 0.7rem;
    font-weight: 800;
    letter-spacing: 1.5px;
    color: var(--accent);
    margin-bottom: 8px;
}
.xp-info-rules {
    display: flex;
    flex-direction: column;
    gap: 5px;
}
.xp-info-rule {
    font-size: 0.72rem;
    color: var(--accent-dim);
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.xp-info-rule strong {
    color: var(--accent-green);
    font-weight: 700;
}
.xp-info-divider {
    height: 1px;
    background: var(--steel);
    margin: 10px 0;
}

[data-theme="light"] .xp-bar-container {
    background: linear-gradient(145deg, #f5f5f0, #e8e8e3);
    box-shadow: 0 4px 12px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.8);
}
[data-theme="light"] .xp-bar {
    box-shadow: inset 0 3px 6px rgba(0,0,0,0.12), inset 0 -1px 2px rgba(255,255,255,0.3);
}
[data-theme="light"] .xp-fatigue-badge {
    background: rgba(255, 107, 107, 0.08);
}

/* Fatigue mode */
.xp-bar-container.fatigued {
    border-color: #555;
    background: linear-gradient(135deg, var(--dark-gray), rgba(60, 60, 60, 0.5));
}
.xp-bar-container.fatigued .xp-level {
    color: #888;
}
.xp-bar-container.fatigued .xp-bar-fill {
    background: linear-gradient(180deg, #999 0%, #666 40%, #555 100%);
    box-shadow: inset 0 2px 3px rgba(255,255,255,0.15), inset 0 -2px 3px rgba(0,0,0,0.2);
}
.xp-bar-container.fatigued .xp-today {
    color: #FF6B6B;
    font-weight: 600;
}
.xp-bar-container.fatigued .xp-amount {
    color: #888;
}
[data-theme="light"] .xp-bar-container.fatigued {
    background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
    border-color: #ccc;
}
[data-theme="light"] .xp-bar-container.fatigued .xp-bar-fill {
    background: linear-gradient(90deg, #bbb, #ccc);
}

/* ============================================================ */
/* ANALYTICS AVANCÉS                                            */
/* ============================================================ */

.analytics-container {
    padding: 0 15px 20px;
}
.analytics-card {
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    border-radius: 12px;
    padding: 18px;
    margin-bottom: 12px;
}
.analytics-card-title {
    font-size: 0.8rem;
    font-weight: 700;
    letter-spacing: 1px;
    color: var(--accent-dim);
    margin-bottom: 12px;
    text-transform: uppercase;
}
.analytics-bar-row {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
}
.analytics-bar-label {
    font-size: 0.75rem;
    color: var(--accent-dim);
    width: 30px;
    text-align: right;
}
.analytics-bar {
    flex: 1;
    height: 8px;
    background: var(--charcoal);
    border-radius: 4px;
    overflow: hidden;
}
.analytics-bar-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.5s ease;
}
.analytics-bar-value {
    font-size: 0.75rem;
    color: var(--accent);
    width: 35px;
}
.analytics-highlight {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 0;
    border-bottom: 1px solid var(--steel);
}
.analytics-highlight:last-child {
    border-bottom: none;
}
.analytics-highlight-label {
    font-size: 0.8rem;
    color: var(--accent-dim);
}
.analytics-highlight-value {
    font-size: 1rem;
    font-weight: 700;
    color: var(--accent);
}
.analytics-trend {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.9rem;
    padding: 10px 0;
}
.analytics-trend-up { color: var(--accent-green); }
.analytics-trend-down { color: #FF6B6B; }
.analytics-trend-stable { color: var(--accent-dim); }

[data-theme="light"] .analytics-card {
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}

/* ============================================================ */
/* RESPONSIVE STATS PAGE                                        */
/* ============================================================ */

/* --- Small phones (≤360px) --- */
@media (max-width: 360px) {
    /* Rank display */
    .rank-display {
        margin: 10px 8px;
        padding: 14px 10px;
    }
    .rank-display .rank-name {
        font-size: 1.3rem;
    }
    .rank-display .rank-title {
        font-size: 0.6rem;
        letter-spacing: 1px;
    }

    /* KPI cards — stack 1 column */
    .kpi-container {
        grid-template-columns: 1fr;
        gap: 8px;
        padding: 10px 8px;
    }
    .kpi-card {
        padding: 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        text-align: left;
    }
    .kpi-card .value {
        font-size: 1.3rem;
        margin: 0;
    }
    .kpi-card .label {
        font-size: 0.55rem;
    }
    .kpi-card .sub {
        display: none;
    }

    /* Weekly grid — keep 7 cols but reduce */
    .weekly-grid {
        gap: 3px;
        padding: 10px 8px;
    }
    .weekly-day {
        padding: 6px 2px;
        border-radius: 6px;
    }
    .weekly-day .day-name {
        font-size: 0.5rem;
    }
    .weekly-day .day-score {
        font-size: 0.7rem;
    }

    /* Stats grid — 1 column */
    .stats-grid {
        grid-template-columns: 1fr 1fr;
        gap: 8px;
        padding: 10px 8px;
    }
    .stat-card {
        padding: 10px;
    }
    .stat-card .stat-value {
        font-size: 1.3rem;
    }
    .stat-card .stat-label {
        font-size: 0.55rem;
    }

    /* Charts */
    .chart-container {
        padding: 10px 8px;
    }
    .chart-wrapper {
        padding: 10px;
        margin-bottom: 10px;
    }
    .chart-title {
        font-size: 0.7rem;
    }
    canvas {
        max-height: 160px;
    }

    /* Calendar button */
    .calendar-view-btn {
        width: calc(100% - 16px);
        margin: 10px 8px;
        padding: 12px 16px;
        font-size: 0.75rem;
    }

    /* Section titles */
    #page-stats .section-title {
        padding: 10px 8px;
        font-size: 0.75rem;
        letter-spacing: 1px;
    }

    /* Analytics */
    .analytics-container {
        padding: 0 8px 15px;
    }
    .analytics-card {
        padding: 12px;
    }
    .analytics-card-title {
        font-size: 0.7rem;
    }
    .analytics-highlight-label {
        font-size: 0.7rem;
    }
    .analytics-highlight-value {
        font-size: 0.85rem;
    }
}

/* --- Medium phones (361px - 480px) --- */
@media (min-width: 361px) and (max-width: 480px) {
    /* Rank display */
    .rank-display {
        margin: 12px 10px;
        padding: 16px 12px;
    }
    .rank-display .rank-name {
        font-size: 1.6rem;
    }

    /* KPI — 3 cols tighter */
    .kpi-container {
        gap: 8px;
        padding: 12px 10px;
    }
    .kpi-card {
        padding: 10px 6px;
    }
    .kpi-card .value {
        font-size: 1.2rem;
    }
    .kpi-card .label {
        font-size: 0.55rem;
        letter-spacing: 0.5px;
    }
    .kpi-card .sub {
        font-size: 0.5rem;
    }

    /* Weekly grid */
    .weekly-grid {
        gap: 4px;
        padding: 12px 10px;
    }
    .weekly-day {
        padding: 8px 3px;
    }
    .weekly-day .day-name {
        font-size: 0.55rem;
    }
    .weekly-day .day-score {
        font-size: 0.85rem;
    }

    /* Stats grid */
    .stats-grid {
        gap: 8px;
        padding: 12px 10px;
    }
    .stat-card {
        padding: 12px;
    }
    .stat-card .stat-value {
        font-size: 1.5rem;
    }
    .stat-card .stat-label {
        font-size: 0.6rem;
    }

    /* Charts */
    .chart-container {
        padding: 12px 10px;
    }
    .chart-wrapper {
        padding: 12px;
    }
    canvas {
        max-height: 180px;
    }

    /* Calendar button */
    .calendar-view-btn {
        width: calc(100% - 20px);
        margin: 12px 10px;
        padding: 12px 20px;
        font-size: 0.8rem;
    }

    /* Analytics */
    .analytics-container {
        padding: 0 10px 15px;
    }
    .analytics-card {
        padding: 14px;
    }
}

/* --- Ensure charts don't overflow on any mobile --- */
@media (max-width: 600px) {
    .chart-wrapper canvas {
        width: 100% !important;
        height: auto !important;
    }

    /* Badges dans stats */
    #badgesContainer {
        padding: 0 10px;
    }
}

/* ============================================================ */
/* SYSTÈME DE RÉCOMPENSES - THÈMES DÉBLOQUABLES                */
/* ============================================================ */

.reward-themes-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    padding: 15px;
}

.reward-theme-card {
    background: var(--charcoal);
    border: 2px solid var(--steel);
    border-radius: 14px;
    padding: 14px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    cursor: pointer;
}

.reward-theme-card.unlocked:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    border-color: var(--accent-dim);
}

.reward-theme-card.unlocked:active {
    transform: scale(0.97);
}

.reward-theme-card.selected {
    border-color: var(--accent);
    box-shadow: 0 0 20px rgba(245, 245, 240, 0.15);
}

.reward-theme-card.selected::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: var(--accent);
}

.reward-theme-card.locked {
    opacity: 0.5;
}

.reward-theme-preview {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.reward-theme-card.unlocked:hover .reward-theme-preview {
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
}

.reward-theme-emoji {
    font-size: 1.6rem;
}

.reward-theme-info {
    text-align: center;
}

.reward-theme-name {
    font-size: 0.85rem;
    font-weight: 800;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 1px;
}

.reward-theme-desc {
    font-size: 0.65rem;
    color: var(--accent-dark);
    margin-top: 3px;
}

.reward-theme-check {
    position: absolute;
    top: 8px;
    right: 10px;
    font-size: 1rem;
    color: var(--accent-green);
    font-weight: bold;
    text-shadow: 0 0 8px currentColor;
}

/* Responsive */
@media (max-width: 360px) {
    .reward-themes-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
        padding: 10px;
    }
    .reward-theme-card {
        padding: 10px;
    }
    .reward-theme-preview {
        width: 44px;
        height: 44px;
    }
    .reward-theme-emoji {
        font-size: 1.2rem;
    }
    .reward-theme-name {
        font-size: 0.75rem;
    }
}

/* Thème reward transitions */
[data-reward-theme] {
    transition: --accent 0.4s ease, --accent-dim 0.4s ease, --accent-dark 0.4s ease, --accent-green 0.4s ease;
}

/* ============================================================ */
/* GROUP TABS (Chat / Classement)                               */
/* ============================================================ */

.group-tabs {
    display: flex;
    gap: 6px;
    padding: 12px 0;
    margin: 0;
    background: transparent;
}

.group-tab {
    flex: 1;
    padding: 10px 16px;
    border: none;
    border-radius: 50px;
    background: var(--charcoal);
    color: var(--accent-dim);
    font-size: 0.85rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.25s ease;
    letter-spacing: 0.5px;
    position: relative;
    overflow: hidden;
}

.group-tab::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 50px;
    border: 2px solid transparent;
    transition: border-color 0.25s ease;
}

.group-tab.active {
    background: var(--accent);
    color: var(--black);
}

.group-tab.active::before {
    border-color: var(--accent);
}

.group-tab:not(.active):hover {
    background: var(--steel);
    color: var(--accent);
}

.group-tab:active {
    transform: scale(0.97);
}

/* Light theme */
[data-theme="light"] .group-tab {
    background: var(--charcoal);
    color: var(--accent-dim);
}

[data-theme="light"] .group-tab.active {
    background: var(--accent);
    color: var(--dark-gray);
}

[data-theme="light"] .group-tab:not(.active):hover {
    background: var(--steel);
}

.group-tab-content {
    min-height: 100px;
}

/* ============================================================ */
/* LEADERBOARD - CLASSEMENT DES MEMBRES                         */
/* ============================================================ */

.leaderboard-loading,
.leaderboard-empty {
    text-align: center;
    padding: 30px 15px;
    color: var(--accent-dim);
    font-size: 0.9rem;
}

.leaderboard-loading-icon,
.leaderboard-empty-icon {
    font-size: 2rem;
    margin-bottom: 10px;
}

.leaderboard-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 8px 0;
}

.leaderboard-card {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 12px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 14px;
    transition: all 0.3s ease;
    animation: fadeInUp 0.4s ease-out backwards;
    position: relative;
    overflow: hidden;
}

/* Top 3 gradients */
.leaderboard-top-1 {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(255, 215, 0, 0.05));
    border-color: rgba(255, 215, 0, 0.4);
}

.leaderboard-top-2 {
    background: linear-gradient(135deg, rgba(192, 192, 192, 0.15), rgba(192, 192, 192, 0.05));
    border-color: rgba(192, 192, 192, 0.4);
}

.leaderboard-top-3 {
    background: linear-gradient(135deg, rgba(205, 127, 50, 0.15), rgba(205, 127, 50, 0.05));
    border-color: rgba(205, 127, 50, 0.4);
}

/* Light theme top 3 */
[data-theme="light"] .leaderboard-top-1 {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.12), rgba(255, 215, 0, 0.04));
    border-color: rgba(200, 170, 0, 0.5);
}

[data-theme="light"] .leaderboard-top-2 {
    background: linear-gradient(135deg, rgba(160, 160, 160, 0.12), rgba(160, 160, 160, 0.04));
    border-color: rgba(160, 160, 160, 0.5);
}

[data-theme="light"] .leaderboard-top-3 {
    background: linear-gradient(135deg, rgba(205, 127, 50, 0.12), rgba(205, 127, 50, 0.04));
    border-color: rgba(180, 110, 40, 0.5);
}

/* Highlight current user */
.leaderboard-me {
    border-color: var(--accent-green) !important;
    box-shadow: 0 0 12px rgba(25, 230, 57, 0.15);
}

[data-theme="light"] .leaderboard-me {
    border-color: var(--accent-green) !important;
    box-shadow: 0 0 12px rgba(25, 135, 84, 0.15);
}

.leaderboard-position {
    font-size: 1.2rem;
    font-weight: 900;
    min-width: 32px;
    text-align: center;
    color: var(--accent);
}

.leaderboard-avatar {
    font-size: 1.6rem;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.leaderboard-info {
    flex: 1;
    min-width: 0;
}

.leaderboard-pseudo {
    font-size: 0.9rem;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.leaderboard-you {
    font-size: 0.7rem;
    font-weight: 500;
    color: var(--accent-green);
}

.leaderboard-meta {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 6px;
}

.leaderboard-rank {
    font-size: 0.65rem;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.leaderboard-streak {
    font-size: 0.7rem;
    color: var(--accent-dim);
}

.leaderboard-bar {
    width: 100%;
    height: 6px;
    background: var(--steel);
    border-radius: 3px;
    overflow: hidden;
}

.leaderboard-bar-fill {
    height: 100%;
    border-radius: 3px;
    background: var(--accent);
    transition: width 0.6s ease;
}

.leaderboard-bar-fill.leaderboard-top-1 {
    background: linear-gradient(90deg, #FFD700, #FFC107);
}

.leaderboard-bar-fill.leaderboard-top-2 {
    background: linear-gradient(90deg, #C0C0C0, #A8A8A8);
}

.leaderboard-bar-fill.leaderboard-top-3 {
    background: linear-gradient(90deg, #CD7F32, #B8860B);
}

.leaderboard-score {
    font-size: 1.1rem;
    font-weight: 900;
    color: var(--accent);
    min-width: 48px;
    text-align: right;
}

.leaderboard-footer {
    text-align: center;
    font-size: 0.7rem;
    color: var(--accent-dark);
    padding: 12px 0 4px;
    font-style: italic;
}

/* ============================================================ */
/* CHAT - MESSAGERIE GROUPE                                     */
/* ============================================================ */

/* ============================================================ */
/* CHAT SYSTEM - UPGRADED                                       */
/* ============================================================ */

.chat-section {
    margin-top: 16px;
    border-top: 1px solid var(--steel);
    padding-top: 12px;
}

.chat-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 4px 10px;
}

.chat-header-title {
    font-size: 0.8rem;
    font-weight: 700;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 1px;
}

.chat-header-status {
    font-size: 0.65rem;
    color: var(--accent-dim);
}

/* Messages wrapper (for new messages floating btn) */
.chat-messages-wrapper {
    position: relative;
}

/* Messages container */
.chat-messages {
    height: 300px;
    overflow-y: auto;
    padding: 10px 6px;
    display: flex;
    flex-direction: column;
    gap: 2px;
    background: var(--black);
    border-radius: 10px;
    border: 1px solid var(--steel);
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    position: relative;
}

.chat-messages::-webkit-scrollbar {
    width: 4px;
}
.chat-messages::-webkit-scrollbar-thumb {
    background: var(--steel);
    border-radius: 2px;
}

.chat-empty {
    text-align: center;
    padding: 40px 20px;
    color: var(--accent-dim);
    font-size: 0.85rem;
}

.chat-loading {
    text-align: center;
    padding: 40px 20px;
    color: var(--accent-dim);
    font-size: 0.85rem;
}

/* Date separator */
.chat-date-separator {
    text-align: center;
    padding: 10px 0 6px;
}

.chat-date-separator span {
    font-size: 0.6rem;
    color: var(--accent-dim);
    background: var(--charcoal);
    padding: 3px 10px;
    border-radius: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* ---- Bubbles ---- */
.chat-bubble {
    max-width: 80%;
    padding: 8px 12px;
    border-radius: 18px;
    word-break: break-word;
    position: relative;
    animation: chatBubbleIn 0.25s ease-out;
    transition: background 0.2s;
}

@keyframes chatBubbleIn {
    from {
        opacity: 0;
        transform: translateY(12px) scale(0.97);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* Highlight when scrolling to a replied message */
.chat-bubble-highlight {
    animation: bubbleHighlight 1.5s ease;
}

@keyframes bubbleHighlight {
    0%, 100% { background: inherit; }
    30% { background: rgba(25, 230, 57, 0.2); }
    70% { background: rgba(25, 230, 57, 0.1); }
}

/* --- My bubbles (right) --- */
.chat-bubble-me {
    align-self: flex-end;
    background: var(--accent);
    color: var(--black);
}

/* iMessage-style corners for my bubbles */
.chat-bubble-me.chat-bubble-single {
    border-radius: 18px 18px 4px 18px;
}
.chat-bubble-me.chat-bubble-first {
    border-radius: 18px 18px 4px 18px;
    margin-bottom: 1px;
}
.chat-bubble-me.chat-bubble-middle {
    border-radius: 18px 4px 4px 18px;
    margin-bottom: 1px;
}
.chat-bubble-me.chat-bubble-last {
    border-radius: 18px 4px 18px 18px;
}

/* --- Other's bubbles (left) --- */
.chat-bubble-other {
    align-self: flex-start;
    background: var(--charcoal);
    color: var(--accent);
    border: 1px solid var(--steel);
}

/* iMessage-style corners for other's bubbles */
.chat-bubble-other.chat-bubble-single {
    border-radius: 18px 18px 18px 4px;
}
.chat-bubble-other.chat-bubble-first {
    border-radius: 18px 18px 18px 4px;
    margin-bottom: 1px;
}
.chat-bubble-other.chat-bubble-middle {
    border-radius: 4px 18px 18px 4px;
    margin-bottom: 1px;
}
.chat-bubble-other.chat-bubble-last {
    border-radius: 4px 18px 18px 18px;
}

/* Grouped spacing */
.chat-bubble-first,
.chat-bubble-single {
    margin-top: 6px;
}

.chat-bubble-sender {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 4px;
}

.chat-bubble-sender-bottom {
    display: flex;
    align-items: center;
    gap: 5px;
    margin-top: 4px;
    opacity: 0.7;
}

.chat-bubble-avatar {
    font-size: 1rem;
    line-height: 1;
}

.chat-bubble-name {
    font-size: 0.65rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.chat-bubble-text {
    font-size: 0.85rem;
    line-height: 1.4;
}

.chat-bubble-time {
    font-size: 0.55rem;
    opacity: 0.5;
    text-align: right;
    margin-top: 3px;
}

.chat-bubble-me .chat-bubble-time {
    color: var(--dark-gray);
}

/* Reply button (inside bubble) */
.chat-reply-btn {
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 50%;
    width: 22px;
    height: 22px;
    font-size: 0.7rem;
    cursor: pointer;
    color: var(--accent-dim);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.2s;
}

.chat-bubble-me .chat-msg-actions {
    right: auto;
    left: 4px;
}

.chat-bubble:hover .chat-reply-btn {
    opacity: 1;
}

/* On mobile: always show on active */
@media (hover: none) {
    .chat-reply-btn {
        opacity: 0.5;
    }
}

/* System messages */
.chat-bubble-system {
    align-self: center;
    background: transparent;
    border: 1px solid var(--steel);
    max-width: 90%;
    text-align: center;
    padding: 6px 16px;
    border-radius: 20px;
    margin: 6px 0;
}

.chat-bubble-system .chat-bubble-text {
    font-style: italic;
    font-size: 0.75rem;
    color: var(--accent-dim);
}

.chat-bubble-system .chat-bubble-time {
    text-align: center;
    color: var(--accent-dark);
}

/* ---- Reply quote inside bubble ---- */
.chat-reply-quote {
    background: rgba(128, 128, 128, 0.15);
    border-left: 3px solid var(--accent-green);
    border-radius: 4px;
    padding: 4px 8px;
    margin-bottom: 6px;
    cursor: pointer;
    transition: background 0.2s;
}

.chat-reply-quote:active {
    background: rgba(128, 128, 128, 0.25);
}

.chat-reply-quote-author {
    display: block;
    font-size: 0.6rem;
    font-weight: 700;
    color: var(--accent-green);
    margin-bottom: 2px;
}

.chat-reply-quote-text {
    display: block;
    font-size: 0.7rem;
    color: var(--accent-dim);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 200px;
}

.chat-bubble-me .chat-reply-quote {
    background: rgba(0, 0, 0, 0.1);
    border-left-color: var(--dark-gray);
}

.chat-bubble-me .chat-reply-quote-author {
    color: var(--dark-gray);
}

.chat-bubble-me .chat-reply-quote-text {
    color: rgba(0, 0, 0, 0.6);
}

/* ---- Reactions ---- */
.chat-reactions {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 4px;
}

.chat-reaction-badge {
    display: inline-flex;
    align-items: center;
    gap: 2px;
    background: rgba(128, 128, 128, 0.15);
    border: 1px solid rgba(128, 128, 128, 0.2);
    border-radius: 12px;
    padding: 2px 6px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.2s;
}

.chat-reaction-badge:active {
    transform: scale(0.9);
}

.chat-reaction-mine {
    background: rgba(25, 230, 57, 0.15);
    border-color: rgba(25, 230, 57, 0.3);
}

.chat-reaction-count {
    font-size: 0.6rem;
    font-weight: 700;
    color: var(--accent-dim);
}

.chat-bubble-me .chat-reaction-badge {
    background: rgba(0, 0, 0, 0.1);
    border-color: rgba(0, 0, 0, 0.15);
}

.chat-bubble-me .chat-reaction-mine {
    background: rgba(0, 0, 0, 0.2);
    border-color: rgba(0, 0, 0, 0.3);
}

.chat-bubble-me .chat-reaction-count {
    color: var(--dark-gray);
}

/* Reaction popup */
.chat-reaction-popup {
    position: absolute;
    z-index: 100;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 24px;
    padding: 6px 8px;
    display: flex;
    gap: 4px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    animation: reactionPopIn 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes reactionPopIn {
    from {
        opacity: 0;
        transform: translateX(-50%) scale(0.5);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) scale(1);
    }
}

.chat-reaction-option {
    background: none;
    border: none;
    font-size: 1.3rem;
    cursor: pointer;
    padding: 4px 6px;
    border-radius: 8px;
    transition: all 0.15s;
    line-height: 1;
}

.chat-reaction-option:hover {
    background: var(--steel);
    transform: scale(1.2);
}

.chat-reaction-option:active {
    transform: scale(0.9);
}

/* ---- Typing indicator ---- */
.chat-typing-indicator {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    font-size: 0.7rem;
    color: var(--accent-dim);
}

.chat-typing-text {
    font-style: italic;
}

.chat-typing-dots {
    display: inline-flex;
    gap: 2px;
}

.chat-typing-dots span {
    animation: typingBounce 1.4s infinite;
    font-weight: 900;
    font-size: 1rem;
    line-height: 0.5;
}

.chat-typing-dots span:nth-child(2) {
    animation-delay: 0.2s;
}

.chat-typing-dots span:nth-child(3) {
    animation-delay: 0.4s;
}

@keyframes typingBounce {
    0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
    30% { transform: translateY(-4px); opacity: 1; }
}

/* ---- Reply preview bar ---- */
.chat-reply-preview {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: var(--charcoal);
    border-left: 3px solid var(--accent-green);
    border-radius: 8px;
    margin-bottom: 6px;
    animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
    from { opacity: 0; transform: translateY(-8px); }
    to { opacity: 1; transform: translateY(0); }
}

.chat-reply-preview-content {
    flex: 1;
    min-width: 0;
}

.chat-reply-preview-author {
    display: block;
    font-size: 0.65rem;
    font-weight: 700;
    color: var(--accent-green);
}

.chat-reply-preview-text {
    display: block;
    font-size: 0.75rem;
    color: var(--accent-dim);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.chat-reply-preview-close {
    background: none;
    border: none;
    color: var(--accent-dim);
    font-size: 1rem;
    cursor: pointer;
    padding: 4px;
    opacity: 0.7;
    transition: opacity 0.2s;
}

.chat-reply-preview-close:hover {
    opacity: 1;
}

/* ---- New messages floating button ---- */
.chat-new-messages-btn {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--accent-green);
    color: var(--black);
    border: none;
    border-radius: 20px;
    padding: 6px 16px;
    font-size: 0.75rem;
    font-weight: 700;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
    z-index: 10;
    box-shadow: 0 2px 12px rgba(25, 230, 57, 0.3);
    animation: newMsgBtnIn 0.3s ease-out;
    transition: all 0.2s;
}

.chat-new-messages-btn:active {
    transform: translateX(-50%) scale(0.95);
}

@keyframes newMsgBtnIn {
    from { opacity: 0; transform: translateX(-50%) translateY(10px); }
    to { opacity: 1; transform: translateX(-50%) translateY(0); }
}

/* ---- Unread badge on group cards ---- */
.group-unread-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: #E74C3C;
    color: white;
    font-size: 0.6rem;
    font-weight: 800;
    min-width: 18px;
    height: 18px;
    border-radius: 9px;
    padding: 0 5px;
    margin-left: 6px;
    animation: unreadPulse 2s infinite;
    vertical-align: middle;
}

@keyframes unreadPulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.4); }
    50% { box-shadow: 0 0 0 4px rgba(231, 76, 60, 0); }
}

/* Audio message */
.chat-audio-msg {
    display: flex;
    align-items: center;
    gap: 8px;
    min-width: 160px;
}

.chat-play-btn {
    background: none;
    border: none;
    font-size: 1.2rem;
    cursor: pointer;
    padding: 0;
    line-height: 1;
}

.chat-audio-wave {
    flex: 1;
    height: 6px;
    background: rgba(128, 128, 128, 0.3);
    border-radius: 3px;
    overflow: hidden;
    position: relative;
}

.chat-audio-progress {
    height: 100%;
    width: 0%;
    background: var(--accent-green);
    border-radius: 3px;
    transition: width 0.1s linear;
}

.chat-bubble-me .chat-audio-wave {
    background: rgba(0, 0, 0, 0.15);
}
.chat-bubble-me .chat-audio-progress {
    background: var(--dark-gray);
}

.chat-audio-duration {
    font-size: 0.65rem;
    opacity: 0.7;
    min-width: 28px;
}

/* Input area */
.chat-input-area {
    margin-top: 8px;
}

.chat-input-row {
    display: flex;
    align-items: center;
    gap: 8px;
}

.chat-text-input {
    flex: 1;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 20px;
    padding: 10px 16px;
    color: var(--accent);
    font-size: 0.85rem;
    outline: none;
    transition: border-color 0.2s;
}

.chat-text-input:focus {
    border-color: var(--accent);
}

.chat-text-input::placeholder {
    color: var(--accent-dim);
}

.chat-send-btn {
    background: var(--accent);
    color: var(--black);
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 1.1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    flex-shrink: 0;
}

.chat-send-btn:active {
    transform: scale(0.9);
}

.chat-mic-btn {
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 1.1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    flex-shrink: 0;
}

.chat-mic-btn.recording {
    background: #E74C3C;
    border-color: #E74C3C;
    animation: recordPulse 1s infinite;
}

@keyframes recordPulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.4); }
    50% { box-shadow: 0 0 0 8px rgba(231, 76, 60, 0); }
}

/* Recording bar */
.chat-recording-bar {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    background: rgba(231, 76, 60, 0.1);
    border: 1px solid rgba(231, 76, 60, 0.3);
    border-radius: 10px;
    margin-bottom: 8px;
}

.chat-recording-dot {
    width: 10px;
    height: 10px;
    background: #E74C3C;
    border-radius: 50%;
    animation: recordPulse 1s infinite;
}

.chat-recording-time {
    font-size: 0.85rem;
    color: #E74C3C;
    font-weight: 700;
    font-variant-numeric: tabular-nums;
    flex: 1;
}

.chat-cancel-record {
    background: none;
    border: none;
    color: var(--accent-dim);
    font-size: 1.1rem;
    cursor: pointer;
    padding: 4px 8px;
}

/* Light theme chat overrides */
[data-theme="light"] .chat-messages {
    background: #F8F9FA;
    border-color: #DEE2E6;
}

[data-theme="light"] .chat-bubble-other {
    background: #E9ECEF;
    color: #212529;
    border-color: #DEE2E6;
}

[data-theme="light"] .chat-bubble-me {
    background: #212529;
    color: #F5F5F0;
}

[data-theme="light"] .chat-text-input {
    background: #E9ECEF;
    border-color: #DEE2E6;
    color: #212529;
}

[data-theme="light"] .chat-date-separator span {
    background: #E9ECEF;
    color: #6C757D;
}

[data-theme="light"] .chat-reaction-popup {
    background: #FFFFFF;
    border-color: #DEE2E6;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

[data-theme="light"] .chat-reply-preview {
    background: #E9ECEF;
}

[data-theme="light"] .chat-typing-indicator {
    color: #6C757D;
}

[data-theme="light"] .chat-reply-btn {
    background: #E9ECEF;
    border-color: #DEE2E6;
    color: #6C757D;
}

[data-theme="light"] .chat-new-messages-btn {
    background: #198754;
    box-shadow: 0 2px 12px rgba(25, 135, 84, 0.3);
}

/* Responsive chat */
@media (max-width: 360px) {
    .chat-messages {
        height: 220px;
    }
    .chat-bubble {
        max-width: 85%;
        padding: 6px 10px;
    }
    .chat-bubble-text {
        font-size: 0.8rem;
    }
    .chat-text-input {
        padding: 8px 12px;
        font-size: 0.8rem;
    }
    .chat-send-btn, .chat-mic-btn {
        width: 36px;
        height: 36px;
        font-size: 1rem;
    }
}

@media (min-width: 361px) and (max-width: 480px) {
    .chat-messages {
        height: 260px;
    }
}

/* ============================================================ */
/* CHALLENGES SYSTEM                                            */
/* ============================================================ */

/* Duration picker */
.challenge-duration-picker {
    display: flex;
    gap: 8px;
}

.challenge-duration-btn {
    flex: 1;
    padding: 10px;
    background: var(--dark-gray);
    border: 2px solid var(--steel);
    border-radius: 8px;
    color: var(--accent-dim);
    font-weight: bold;
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
}

.challenge-duration-btn.active {
    background: var(--accent);
    color: var(--black);
    border-color: var(--accent);
}

.challenge-duration-btn:hover:not(.active) {
    border-color: var(--accent-dim);
}

/* Create challenge button */
.challenge-create-btn {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, var(--charcoal), var(--dark-gray));
    border: 2px dashed var(--steel);
    color: var(--accent);
    border-radius: 10px;
    cursor: pointer;
    font-weight: bold;
    font-size: 0.85rem;
    transition: all 0.2s;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 15px;
}

.challenge-create-btn:hover {
    background: var(--steel);
    border-style: solid;
}

/* Challenge empty state */
.challenge-empty {
    text-align: center;
    padding: 30px 15px;
    color: var(--accent-dim);
}

/* Challenge section titles */
.challenge-section-title {
    font-size: 0.8rem;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: var(--accent-dim);
    padding: 8px 0;
    margin-bottom: 8px;
}

/* Challenge card */
.challenge-card {
    background: linear-gradient(135deg, var(--charcoal), var(--dark-gray));
    border: 1px solid var(--steel);
    border-left: 4px solid var(--accent-green);
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 10px;
    cursor: pointer;
    transition: all 0.2s;
}

.challenge-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    border-color: var(--accent-dim);
}

.challenge-card-ended {
    border-left-color: var(--accent-dark);
    opacity: 0.75;
}

.challenge-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 6px;
    gap: 8px;
}

.challenge-card-name {
    font-size: 1rem;
    font-weight: 700;
    color: var(--accent);
    flex: 1;
}

.challenge-card-desc {
    font-size: 0.8rem;
    color: var(--accent-dim);
    margin-bottom: 8px;
    font-style: italic;
}

.challenge-card-meta {
    display: flex;
    gap: 12px;
    font-size: 0.75rem;
    color: var(--accent-dark);
    margin-bottom: 8px;
    flex-wrap: wrap;
}

/* Status badges */
.challenge-status-badge {
    font-size: 0.7rem;
    font-weight: 800;
    padding: 4px 10px;
    border-radius: 20px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: nowrap;
}

.challenge-badge-active {
    background: rgba(25, 230, 57, 0.15);
    color: #19E639;
    border: 1px solid rgba(25, 230, 57, 0.3);
    animation: badgePulse 2s ease-in-out infinite;
}

.challenge-badge-ended {
    background: rgba(108, 117, 125, 0.15);
    color: #6C757D;
    border: 1px solid rgba(108, 117, 125, 0.3);
}

@keyframes badgePulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(25, 230, 57, 0.3); }
    50% { box-shadow: 0 0 10px 2px rgba(25, 230, 57, 0.2); }
}

/* Progress bar */
.challenge-progress-bar {
    height: 6px;
    background: var(--steel);
    border-radius: 4px;
    overflow: hidden;
    margin-top: 4px;
}

.challenge-progress-bar-large {
    height: 10px;
    margin-top: 8px;
}

.challenge-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent-green), #27AE60);
    border-radius: 4px;
    transition: width 0.5s ease;
}

/* Countdown colors */
.challenge-countdown-green { color: #2ECC71; }
.challenge-countdown-orange { color: #F39C12; }
.challenge-countdown-red { color: #E74C3C; }

/* Join button on card */
.challenge-join-btn {
    margin-top: 10px;
    padding: 8px 16px;
    background: var(--accent);
    color: var(--black);
    border: none;
    border-radius: 8px;
    font-weight: 700;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s;
    width: 100%;
}

.challenge-join-btn:hover {
    transform: scale(1.02);
    box-shadow: 0 2px 10px rgba(245,245,240,0.2);
}

/* ============================================================ */
/* CHALLENGE DETAIL VIEW                                         */
/* ============================================================ */

.challenge-detail {
    padding: 5px 0;
}

.challenge-back-btn {
    background: none;
    border: none;
    color: var(--accent-dim);
    font-size: 0.85rem;
    cursor: pointer;
    padding: 8px 0;
    margin-bottom: 10px;
    transition: color 0.2s;
}

.challenge-back-btn:hover {
    color: var(--accent);
}

.challenge-detail-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
    gap: 10px;
}

.challenge-detail-name {
    font-size: 1.15rem;
    font-weight: 800;
    color: var(--accent);
    margin: 0;
}

.challenge-detail-desc {
    font-size: 0.85rem;
    color: var(--accent-dim);
    font-style: italic;
    margin-bottom: 12px;
}

.challenge-detail-info {
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    border-radius: 10px;
    padding: 12px;
    margin-bottom: 15px;
}

.challenge-info-item {
    display: flex;
    justify-content: space-between;
    padding: 6px 0;
    border-bottom: 1px solid var(--steel);
}

.challenge-info-item:last-child {
    border-bottom: none;
}

.challenge-info-label {
    font-size: 0.75rem;
    color: var(--accent-dark);
    text-transform: uppercase;
    font-weight: 600;
}

.challenge-info-value {
    font-size: 0.8rem;
    color: var(--accent);
    font-weight: 600;
    text-align: right;
    max-width: 60%;
}

/* Countdown section */
.challenge-countdown-section {
    text-align: center;
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    border-radius: 10px;
    padding: 15px;
    margin-bottom: 15px;
}

.challenge-countdown-label {
    font-size: 0.7rem;
    color: var(--accent-dark);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 5px;
}

.challenge-countdown-value {
    font-size: 2rem;
    font-weight: 900;
    margin-bottom: 5px;
}

/* Leaderboard */
.challenge-leaderboard-title {
    font-size: 0.9rem;
    font-weight: 800;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 10px;
}

.challenge-leaderboard {
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    border-radius: 10px;
    overflow: hidden;
}

.challenge-participant {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px;
    border-bottom: 1px solid var(--steel);
    transition: background 0.2s;
}

.challenge-participant:last-child {
    border-bottom: none;
}

.challenge-participant-me {
    background: rgba(25, 230, 57, 0.08);
    border-left: 3px solid var(--accent-green);
}

.challenge-participant-rank {
    font-size: 1.2rem;
    min-width: 30px;
    text-align: center;
    font-weight: 800;
    color: var(--accent-dim);
}

.challenge-participant-avatar {
    font-size: 1.4rem;
}

.challenge-participant-info {
    flex: 1;
    min-width: 0;
}

.challenge-participant-name {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--accent);
    margin-bottom: 4px;
}

.challenge-participant-bar-bg {
    height: 6px;
    background: var(--steel);
    border-radius: 3px;
    overflow: hidden;
}

.challenge-participant-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent-green), #27AE60);
    border-radius: 3px;
    transition: width 0.5s ease;
}

.challenge-participant-score {
    font-size: 0.95rem;
    font-weight: 800;
    color: var(--accent);
    min-width: 40px;
    text-align: right;
}

/* Detail actions */
.challenge-detail-actions {
    margin-top: 15px;
}

.challenge-leave-btn {
    width: 100%;
    padding: 12px;
    background: rgba(138, 58, 58, 0.2);
    border: 1px solid #8A3A3A;
    color: #FF6B6B;
    border-radius: 8px;
    font-weight: 700;
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.2s;
}

.challenge-leave-btn:hover {
    background: rgba(138, 58, 58, 0.4);
}

.challenge-join-btn-large {
    width: 100%;
    padding: 14px;
    background: var(--accent);
    color: var(--black);
    border: none;
    border-radius: 10px;
    font-weight: 800;
    font-size: 0.95rem;
    cursor: pointer;
    transition: all 0.2s;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.challenge-join-btn-large:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(245,245,240,0.2);
}

/* ============================================================ */
/* CHALLENGE - LIGHT THEME                                       */
/* ============================================================ */

[data-theme="light"] .challenge-card {
    background: linear-gradient(135deg, var(--dark-gray), var(--charcoal));
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

[data-theme="light"] .challenge-badge-active {
    background: rgba(25, 135, 84, 0.12);
    color: #198754;
    border-color: rgba(25, 135, 84, 0.3);
}

[data-theme="light"] .challenge-badge-ended {
    background: rgba(108, 117, 125, 0.12);
    color: #6C757D;
}

[data-theme="light"] .challenge-progress-fill {
    background: linear-gradient(90deg, #198754, #20c997);
}

[data-theme="light"] .challenge-participant-bar-fill {
    background: linear-gradient(90deg, #198754, #20c997);
}

[data-theme="light"] .challenge-leaderboard {
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

[data-theme="light"] .challenge-detail-info {
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

[data-theme="light"] .challenge-countdown-section {
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

[data-theme="light"] .challenge-countdown-green { color: #198754; }
[data-theme="light"] .challenge-countdown-orange { color: #E67E22; }
[data-theme="light"] .challenge-countdown-red { color: #DC3545; }

/* ============================================================ */
/* CHALLENGE - RESPONSIVE                                        */
/* ============================================================ */

@media (max-width: 400px) {
    .challenge-card-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .challenge-card-meta {
        gap: 8px;
    }
    
    .challenge-duration-picker {
        flex-direction: column;
    }
    
    .challenge-participant {
        padding: 10px;
        gap: 8px;
    }
    
    .challenge-participant-avatar {
        font-size: 1.1rem;
    }
    
    .challenge-countdown-value {
        font-size: 1.5rem;
    }
}

/* ============================================================
   STREAK DISPLAY WIDGET - Flamme animée & compteur
   ============================================================ */

.streak-widget {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 25px 20px 20px;
    margin: 15px;
    border-radius: 16px;
    background: var(--dark-gray);
    border: 1px solid var(--steel);
    position: relative;
    overflow: hidden;
}

.streak-flame-container {
    position: relative;
    width: 80px;
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 8px;
}

.streak-flame {
    animation: streakPulse 1.5s ease-in-out infinite, streakWobble 3s ease-in-out infinite;
    filter: drop-shadow(0 0 8px rgba(255, 120, 0, 0.5));
    z-index: 2;
    line-height: 1;
}

.streak-count {
    font-size: 3.2rem;
    font-weight: 900;
    color: var(--accent);
    line-height: 1;
    margin-bottom: 4px;
}

.streak-label {
    font-size: 0.9rem;
    color: var(--accent-dim);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
}

.streak-tier-label {
    margin-top: 8px;
    font-size: 0.75rem;
    font-weight: 800;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 3px 12px;
    border-radius: 20px;
    background: rgba(255, 215, 0, 0.15);
    color: #FFD700;
}

.streak-best {
    margin-top: 10px;
    font-size: 0.78rem;
    color: var(--accent-dark);
}

/* --- Tier: Zero (grisé) --- */
.streak-tier-zero .streak-flame {
    filter: grayscale(1) opacity(0.4);
    animation: none;
}
.streak-tier-zero .streak-count {
    color: var(--accent-dark);
}
.streak-tier-zero .streak-label {
    color: var(--accent-dark);
    font-style: italic;
}

/* --- Tier: Normal (orange chaud) --- */
.streak-tier-normal .streak-flame {
    filter: drop-shadow(0 0 10px rgba(255, 120, 0, 0.6));
}

/* --- Tier: Gold (>= 7 jours) --- */
.streak-tier-gold .streak-flame {
    filter: drop-shadow(0 0 14px rgba(255, 215, 0, 0.7)) drop-shadow(0 0 30px rgba(255, 180, 0, 0.3));
}
.streak-tier-gold .streak-count {
    background: linear-gradient(135deg, #FFD700, #FFA500);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
.streak-tier-gold .streak-tier-label {
    background: rgba(255, 215, 0, 0.15);
    color: #FFD700;
}

/* --- Tier: Legendary (>= 30 jours, bleu) --- */
.streak-tier-legendary .streak-flame {
    filter: drop-shadow(0 0 16px rgba(80, 160, 255, 0.8)) drop-shadow(0 0 40px rgba(60, 130, 255, 0.4)) hue-rotate(200deg);
}
.streak-tier-legendary .streak-count {
    background: linear-gradient(135deg, #50A0FF, #8040FF);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
.streak-tier-legendary .streak-tier-label {
    background: rgba(80, 160, 255, 0.15);
    color: #50A0FF;
}

/* Halo pour le tier legendary */
.streak-halo {
    position: absolute;
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(80, 160, 255, 0.25) 0%, transparent 70%);
    animation: streakHalo 2s ease-in-out infinite;
    z-index: 1;
}

/* Particules flottantes */
.streak-particle {
    position: absolute;
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background: #FFD700;
    opacity: 0;
    animation: streakParticleFloat 2.5s ease-out infinite;
    z-index: 1;
}
.streak-tier-legendary .streak-particle {
    background: #50A0FF;
}

/* --- Animations --- */
@keyframes streakPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.12); }
}

@keyframes streakWobble {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(3deg); }
    75% { transform: rotate(-3deg); }
}

@keyframes streakHalo {
    0%, 100% { transform: scale(1); opacity: 0.5; }
    50% { transform: scale(1.3); opacity: 0.8; }
}

@keyframes streakParticleFloat {
    0% { transform: translateY(0) scale(1); opacity: 0.8; }
    100% { transform: translateY(-50px) scale(0); opacity: 0; }
}

/* --- Light theme adjustments --- */
[data-theme="light"] .streak-widget {
    background: var(--dark-gray);
    border: 2px solid var(--steel);
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
}
[data-theme="light"] .streak-tier-gold .streak-count {
    background: linear-gradient(135deg, #B8860B, #D2691E);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
[data-theme="light"] .streak-tier-legendary .streak-count {
    background: linear-gradient(135deg, #2060C0, #5030A0);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
[data-theme="light"] .streak-tier-label {
    background: rgba(0, 0, 0, 0.06);
}
[data-theme="light"] .streak-tier-gold .streak-tier-label {
    color: #B8860B;
}
[data-theme="light"] .streak-tier-legendary .streak-tier-label {
    color: #2060C0;
}

/* Responsive */
@media (max-width: 360px) {
    .streak-widget {
        padding: 20px 15px 15px;
        margin: 10px;
    }
    .streak-count {
        font-size: 2.5rem;
    }
    .streak-flame-container {
        width: 65px;
        height: 65px;
    }
}

/* ============================================================ */
/* GUIDED TOUR - Tour guidé interactif                          */
/* ============================================================ */

/* Overlay sombre avec cutout */
.gt-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.75);
    z-index: 99990;
    transition: clip-path 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
    pointer-events: auto;
}

.gt-overlay-final {
    background: rgba(0, 0, 0, 0.85);
    clip-path: none !important;
}

.gt-overlay-exit {
    opacity: 0;
    transition: opacity 0.4s ease;
}

/* Élément highlighté */
.gt-highlighted {
    position: relative !important;
    z-index: 99991 !important;
    border-radius: 12px;
    animation: gt-glow-pulse 2s ease-in-out infinite;
    pointer-events: auto;
}

@keyframes gt-glow-pulse {
    0%, 100% {
        box-shadow: 0 0 0 3px rgba(245, 245, 240, 0.4), 0 0 20px rgba(245, 245, 240, 0.15);
    }
    50% {
        box-shadow: 0 0 0 5px rgba(245, 245, 240, 0.6), 0 0 30px rgba(245, 245, 240, 0.25);
    }
}

[data-theme="light"] .gt-highlighted {
    animation: gt-glow-pulse-light 2s ease-in-out infinite;
}

@keyframes gt-glow-pulse-light {
    0%, 100% {
        box-shadow: 0 0 0 3px rgba(33, 37, 41, 0.3), 0 0 20px rgba(33, 37, 41, 0.1);
    }
    50% {
        box-shadow: 0 0 0 5px rgba(33, 37, 41, 0.5), 0 0 30px rgba(33, 37, 41, 0.2);
    }
}

/* Tooltip */
.gt-tooltip {
    position: absolute;
    z-index: 99992;
    background: var(--dark-gray);
    border: 1.5px solid var(--steel);
    border-radius: 16px;
    padding: 20px;
    max-width: 320px;
    width: calc(100vw - 32px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
    opacity: 0;
    transform: translateY(10px);
    pointer-events: auto;
}

.gt-tooltip-enter {
    animation: gt-tooltip-in 0.35s ease forwards;
}

.gt-tooltip-exit {
    animation: gt-tooltip-out 0.3s ease forwards;
}

@keyframes gt-tooltip-in {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes gt-tooltip-out {
    from { opacity: 1; transform: translateY(0); }
    to { opacity: 0; transform: translateY(-10px); }
}

/* Tooltip final centré */
.gt-tooltip-final {
    text-align: center;
    max-width: 360px;
    padding: 30px 24px;
}

.gt-final-icon {
    font-size: 3rem;
    margin-bottom: 12px;
    animation: gt-bounce 1s ease infinite;
}

@keyframes gt-bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
}

/* Flèche du tooltip */
.gt-tooltip-arrow {
    position: absolute;
    width: 0;
    height: 0;
    border: 8px solid transparent;
}

.gt-arrow-top {
    top: -16px;
    left: 50%;
    transform: translateX(-50%);
    border-bottom-color: var(--steel);
}

.gt-arrow-top::after {
    content: '';
    position: absolute;
    top: 2px;
    left: -7px;
    width: 0;
    height: 0;
    border: 7px solid transparent;
    border-bottom-color: var(--dark-gray);
}

.gt-arrow-bottom {
    bottom: -16px;
    left: 50%;
    transform: translateX(-50%);
    border-top-color: var(--steel);
}

.gt-arrow-bottom::after {
    content: '';
    position: absolute;
    bottom: 2px;
    left: -7px;
    width: 0;
    height: 0;
    border: 7px solid transparent;
    border-top-color: var(--dark-gray);
}

/* Titre et texte du tooltip */
.gt-tooltip-title {
    font-size: 1.1rem;
    font-weight: 800;
    color: var(--accent);
    margin-bottom: 8px;
    letter-spacing: 0.5px;
}

.gt-tooltip-text {
    font-size: 0.9rem;
    color: var(--accent-dim);
    line-height: 1.5;
    margin-bottom: 16px;
}

/* Barre de progression */
.gt-progress {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 16px;
}

.gt-progress-bar {
    flex: 1;
    height: 4px;
    background: var(--steel);
    border-radius: 4px;
    overflow: hidden;
}

.gt-progress-fill {
    height: 100%;
    background: var(--accent-green);
    border-radius: 4px;
    transition: width 0.4s ease;
}

.gt-progress-text {
    font-size: 0.75rem;
    color: var(--accent-dark);
    font-weight: 600;
    white-space: nowrap;
}

/* Boutons du tooltip */
.gt-tooltip-buttons {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
}

.gt-btn-skip {
    background: transparent;
    border: 1px solid var(--steel);
    color: var(--accent-dark);
    padding: 8px 16px;
    border-radius: 10px;
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.gt-btn-skip:hover,
.gt-btn-skip:active {
    background: var(--charcoal);
    color: var(--accent);
}

.gt-btn-next {
    background: var(--accent);
    border: none;
    color: var(--black);
    padding: 8px 20px;
    border-radius: 10px;
    font-size: 0.85rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
}

.gt-btn-next:hover,
.gt-btn-next:active {
    opacity: 0.85;
    transform: scale(1.02);
}

.gt-btn-finish {
    background: var(--accent-green);
    border: none;
    color: #0A0A0A;
    padding: 14px 32px;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 800;
    cursor: pointer;
    width: 100%;
    transition: all 0.2s ease;
    letter-spacing: 0.5px;
}

.gt-btn-finish:hover,
.gt-btn-finish:active {
    opacity: 0.9;
    transform: scale(1.02);
}

/* Light theme ajustements */
[data-theme="light"] .gt-overlay {
    background: rgba(0, 0, 0, 0.6);
}

[data-theme="light"] .gt-tooltip {
    background: #FFFFFF;
    border-color: #CED4DA;
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
}

[data-theme="light"] .gt-arrow-top {
    border-bottom-color: #CED4DA;
}

[data-theme="light"] .gt-arrow-top::after {
    border-bottom-color: #FFFFFF;
}

[data-theme="light"] .gt-arrow-bottom {
    border-top-color: #CED4DA;
}

[data-theme="light"] .gt-arrow-bottom::after {
    border-top-color: #FFFFFF;
}

[data-theme="light"] .gt-btn-skip {
    border-color: #CED4DA;
}

[data-theme="light"] .gt-btn-skip:hover {
    background: #E9ECEF;
}

/* Responsive mobile */
@media (max-width: 480px) {
    .gt-tooltip {
        max-width: calc(100vw - 24px);
        padding: 16px;
        border-radius: 14px;
    }

    .gt-tooltip-final {
        max-width: calc(100vw - 32px);
        padding: 24px 18px;
    }

    .gt-tooltip-title {
        font-size: 1rem;
    }

    .gt-tooltip-text {
        font-size: 0.85rem;
    }

    .gt-btn-next, .gt-btn-skip {
        padding: 8px 14px;
        font-size: 0.8rem;
    }

    .gt-btn-finish {
        padding: 12px 24px;
        font-size: 0.95rem;
    }
}

/* ============================================================
   SCORE ANIMATION — Pulse + Particules dopamine
   ============================================================ */

/* Pulse glow on KPI value change */
@keyframes kpiPulse {
    0% { transform: scale(1); filter: brightness(1); }
    25% { transform: scale(1.35); filter: brightness(1.5); text-shadow: 0 0 20px var(--accent), 0 0 40px var(--accent); }
    50% { transform: scale(1.15); filter: brightness(1.2); }
    100% { transform: scale(1); filter: brightness(1); text-shadow: none; }
}

.kpi-pulse {
    animation: kpiPulse 0.6s cubic-bezier(0.22, 1, 0.36, 1);
    display: inline-block;
}

/* Floating emoji particles on score increase */
@keyframes scoreParticleFloat {
    0% { opacity: 1; transform: translateY(0) scale(1) rotate(0deg); }
    60% { opacity: 1; }
    100% { opacity: 0; transform: translateY(-80px) scale(0.5) rotate(25deg); }
}

.score-particle {
    position: absolute;
    font-size: 1.2rem;
    pointer-events: none;
    z-index: 9999;
    animation: scoreParticleFloat 0.9s ease-out forwards;
    will-change: transform, opacity;
}

/* ============================================================
   BODY FREEZE — Used during guided tour to lock background
   ============================================================ */
body.tour-active {
    overflow: hidden !important;
    position: fixed !important;
    width: 100% !important;
    touch-action: none !important;
}

body.tour-active .bottom-nav {
    pointer-events: none;
}

body.tour-active .header {
    pointer-events: none;
}

/* ============================================================
   ACTION BUTTONS — Premium styled action buttons
   ============================================================ */
.today-actions {
    display: flex;
    gap: 10px;
    padding: 12px 15px 20px;
}

.action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 14px 20px;
    border-radius: 14px;
    font-size: 0.8rem;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.2s ease;
    border: none;
    position: relative;
    overflow: hidden;
}

.action-btn svg {
    flex-shrink: 0;
}

.action-btn-primary {
    flex: 2;
    background: linear-gradient(135deg, #2ECC71, #27AE60);
    color: #0A0A0A;
    box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3), inset 0 1px 0 rgba(255,255,255,0.2);
}

.action-btn-primary svg { stroke: #0A0A0A; }

.action-btn-primary:active {
    transform: scale(0.96);
    box-shadow: 0 2px 8px rgba(46, 204, 113, 0.2);
}

.action-btn-secondary {
    flex: 1;
    background: var(--charcoal);
    color: var(--accent);
    border: 1px solid var(--steel);
    box-shadow: 0 2px 8px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.04);
}

.action-btn-secondary:active {
    transform: scale(0.96);
}

/* ============================================================
   STATS — Rang card + Calendar card (top row)
   ============================================================ */
.stats-top-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    padding: 15px;
}

.rank-card, .calendar-card {
    background: linear-gradient(145deg, var(--charcoal), rgba(30, 30, 30, 0.9));
    border: 1px solid var(--steel);
    border-radius: 14px;
    padding: 16px 14px;
    text-align: center;
    position: relative;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.04);
    cursor: pointer;
    transition: transform 0.2s ease;
}

.rank-card:active, .calendar-card:active {
    transform: scale(0.96);
}

.rank-card::before {
    content: '';
    position: absolute;
    top: 0; left: 20%; right: 20%;
    height: 3px;
    border-radius: 0 0 4px 4px;
    background: linear-gradient(90deg, #F39C12, #E67E22);
}

.calendar-card::before {
    content: '';
    position: absolute;
    top: 0; left: 20%; right: 20%;
    height: 3px;
    border-radius: 0 0 4px 4px;
    background: linear-gradient(90deg, #3498DB, #2980B9);
}

.rank-card-icon svg { stroke: #F39C12; filter: drop-shadow(0 0 6px rgba(243,156,18,0.3)); }
.calendar-card-icon svg { stroke: #3498DB; filter: drop-shadow(0 0 6px rgba(52,152,219,0.3)); }

.rank-card-label, .calendar-card-label {
    font-size: 0.65rem;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 2px;
    font-weight: 800;
    margin-top: 8px;
}

.rank-card-name {
    font-size: 1.4rem;
    font-weight: 900;
    color: #FFB84D;
    text-shadow: 0 0 15px rgba(255,184,77,0.5), 0 0 30px rgba(243,156,18,0.3);
    margin: 6px 0 10px;
    letter-spacing: 3px;
}

.calendar-card-month {
    font-size: 1.1rem;
    font-weight: 900;
    color: #3498DB;
    text-shadow: 0 0 10px rgba(52,152,219,0.3);
    margin-top: 4px;
    letter-spacing: 1px;
}

.rank-card-bar {
    height: 8px;
    background: rgba(255,184,77,0.2);
    border-radius: 4px;
    overflow: hidden;
    border: 1px solid rgba(255,184,77,0.15);
}

.rank-card-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #FFB84D, #F39C12, #E67E22);
    border-radius: 4px;
    transition: width 0.5s ease;
    box-shadow: 0 0 12px rgba(255,184,77,0.5);
}

/* ============================================================
   GROUP ENHANCEMENTS — Nav badge, Preview, Online, Pin, Goal
   ============================================================ */

/* Nav notification badge */
.nav-badge {
    position: absolute;
    top: -4px;
    right: -6px;
    background: #E74C3C;
    color: white;
    font-size: 0.55rem;
    font-weight: 800;
    min-width: 16px;
    height: 16px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 4px;
    box-shadow: 0 2px 6px rgba(231, 76, 60, 0.5);
    animation: badgePulse 2s ease infinite;
}

@keyframes badgePulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

/* Group card — last message preview */
.group-card-preview {
    font-size: 0.75rem;
    color: var(--accent-dim);
    margin-top: 6px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.3;
}

.group-card-meta {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.7rem;
    color: var(--accent-dim);
}

.group-card-time {
    color: var(--accent-dark);
    font-size: 0.65rem;
}

/* Online indicator */
.group-online-dot {
    width: 7px;
    height: 7px;
    background: #2ECC71;
    border-radius: 50%;
    box-shadow: 0 0 6px rgba(46, 204, 113, 0.6);
    animation: onlinePulse 2s ease infinite;
}

@keyframes onlinePulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

.group-online-count {
    color: #2ECC71;
    font-size: 0.65rem;
    font-weight: 700;
}

/* Pinned message bar */
.chat-pinned {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: linear-gradient(135deg, rgba(255,184,77,0.12), rgba(255,184,77,0.04));
    border-left: 3px solid #FFB84D;
    border-radius: 0 8px 8px 0;
    margin: 0 10px 6px;
    cursor: pointer;
    transition: background 0.2s;
}

.chat-pinned svg {
    stroke: #FFB84D;
    flex-shrink: 0;
}

.chat-pinned-text {
    font-size: 0.75rem;
    color: var(--accent);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
}

.chat-pinned-close {
    background: none;
    border: none;
    color: var(--accent-dim);
    font-size: 0.8rem;
    cursor: pointer;
    padding: 2px 6px;
}

/* Pin button in chat */
.chat-msg-actions {
    display: flex;
    gap: 4px;
    position: absolute;
    top: 4px;
    right: 4px;
    opacity: 0;
    transition: opacity 0.2s;
}

.chat-bubble:hover .chat-msg-actions,
.chat-bubble:active .chat-msg-actions {
    opacity: 1;
}

.chat-pin-btn {
    background: none;
    border: none;
    font-size: 0.7rem;
    cursor: pointer;
    padding: 2px 4px;
    opacity: 0.6;
}

.chat-pin-btn:active {
    opacity: 1;
}

/* Reaction animation */
@keyframes reactionPop {
    0% { transform: scale(0.5); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
}

.chat-reaction-badge {
    animation: reactionPop 0.3s ease;
}

/* Group goal */
.group-goal {
    padding: 14px;
    margin: 0 0 10px;
    background: linear-gradient(145deg, rgba(255,184,77,0.08), rgba(255,184,77,0.02));
    border: 1px solid rgba(255,184,77,0.15);
    border-radius: 12px;
}

.group-goal-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
}

.group-goal-title {
    font-size: 0.7rem;
    font-weight: 800;
    color: #FFB84D;
    text-transform: uppercase;
    letter-spacing: 1.5px;
}

.group-goal-text {
    font-size: 0.85rem;
    color: var(--accent);
    margin-bottom: 10px;
    line-height: 1.4;
}

.group-goal-bar {
    height: 8px;
    background: rgba(255,184,77,0.15);
    border-radius: 4px;
    overflow: hidden;
}

.group-goal-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #FFB84D, #F39C12);
    border-radius: 4px;
    transition: width 0.5s ease;
    box-shadow: 0 0 8px rgba(255,184,77,0.4);
}

.group-goal-progress {
    font-size: 0.65rem;
    color: #FFB84D;
    text-align: right;
    margin-top: 4px;
    font-weight: 700;
}

/* ============================================================
   RANKS MODAL
   ============================================================ */
.ranks-modal-overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.7);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    padding: 20px;
}
.ranks-modal-overlay.active { opacity: 1; }

.ranks-modal {
    background: var(--card-bg, #1a1a1a);
    border-radius: 20px;
    width: 100%;
    max-width: 360px;
    padding: 24px;
    transform: translateY(30px) scale(0.95);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 20px 60px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.05);
}
.ranks-modal-overlay.active .ranks-modal {
    transform: translateY(0) scale(1);
}

.ranks-modal-header {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.85rem;
    font-weight: 800;
    letter-spacing: 2px;
    color: var(--text-primary, #fff);
    margin-bottom: 20px;
    padding-bottom: 14px;
    border-bottom: 1px solid rgba(255,255,255,0.08);
}

.ranks-modal-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 18px;
}

.ranks-modal-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 14px;
    border-radius: 12px;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.06);
    transition: all 0.2s ease;
}

.ranks-modal-item.ranks-modal-current {
    background: rgba(255,255,255,0.08);
    border-color: var(--rank-color);
    box-shadow: 0 0 20px rgba(255,255,255,0.05), inset 0 0 20px rgba(255,255,255,0.02);
}

.ranks-modal-icon {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.ranks-modal-icon svg { color: var(--rank-color); }

.ranks-modal-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--rank-color);
    opacity: 0.5;
}

.ranks-modal-current .ranks-modal-dot { opacity: 1; }

.ranks-modal-info { flex: 1; }

.ranks-modal-name {
    font-weight: 800;
    font-size: 0.85rem;
    letter-spacing: 1px;
}

.ranks-modal-range {
    font-size: 0.7rem;
    color: rgba(255,255,255,0.4);
    margin-top: 2px;
}

.ranks-modal-you {
    font-size: 0.7rem;
    font-weight: 700;
    color: var(--rank-color);
    letter-spacing: 1px;
    animation: rankPulse 1.5s ease-in-out infinite;
}

@keyframes rankPulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

.ranks-modal-score {
    text-align: center;
    font-size: 0.8rem;
    color: rgba(255,255,255,0.5);
    margin-bottom: 16px;
}
.ranks-modal-score strong { color: var(--text-primary, #fff); }

.ranks-modal-close {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 12px;
    background: rgba(255,255,255,0.08);
    color: var(--text-primary, #fff);
    font-size: 0.85rem;
    font-weight: 700;
    cursor: pointer;
    transition: background 0.2s;
}
.ranks-modal-close:active { background: rgba(255,255,255,0.15); }

.rank-card { cursor: pointer; }

/* ============================================================
   CHAT — NEW UX (message menu, audio preview, send btn states)
   ============================================================ */

/* Hide old hover actions */
.chat-msg-actions { display: none !important; }

/* "..." button on each message */
.chat-msg-more-btn {
    position: absolute;
    top: 4px;
    right: -8px;
    width: 28px;
    height: 28px;
    border: none;
    background: var(--card-bg, #1a1a1a);
    color: rgba(255,255,255,0.5);
    border-radius: 50%;
    font-size: 1rem;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.2s;
    z-index: 5;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}
.chat-bubble:hover .chat-msg-more-btn,
.chat-bubble:active .chat-msg-more-btn { opacity: 1; }
.chat-bubble-me .chat-msg-more-btn { right: auto; left: -8px; }

/* Message menu dropdown */
.chat-msg-menu {
    position: absolute;
    bottom: -4px;
    left: 50%;
    transform: translateX(-50%) translateY(100%);
    background: var(--card-bg, #222);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 10px;
    padding: 4px;
    z-index: 100;
    display: flex;
    gap: 2px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.5);
    animation: menuPop 0.15s ease-out;
}
@keyframes menuPop {
    from { opacity: 0; transform: translateX(-50%) translateY(100%) scale(0.9); }
    to { opacity: 1; transform: translateX(-50%) translateY(100%) scale(1); }
}
.chat-msg-menu button {
    background: none;
    border: none;
    color: var(--text-primary, #fff);
    padding: 8px 12px;
    font-size: 0.75rem;
    border-radius: 8px;
    cursor: pointer;
    white-space: nowrap;
    transition: background 0.15s;
}
.chat-msg-menu button:active { background: rgba(255,255,255,0.1); }

/* Relative positioning for bubbles to anchor menu */
.chat-bubble { position: relative; }

/* Send button states */
.chat-send-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    flex-shrink: 0;
}
.chat-send-btn-disabled {
    background: rgba(255,255,255,0.08);
    color: rgba(255,255,255,0.3);
}
.chat-send-btn-active {
    background: #4CAF50;
    color: #fff;
    box-shadow: 0 0 16px rgba(76, 175, 80, 0.4);
    animation: sendBtnPop 0.3s ease-out;
}
@keyframes sendBtnPop {
    0% { transform: scale(0.8); }
    50% { transform: scale(1.15); }
    100% { transform: scale(1); }
}

/* Audio preview bar */
.chat-audio-preview {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
    padding: 4px;
}
.chat-audio-preview-delete {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    border: none;
    background: rgba(244, 67, 54, 0.15);
    color: #F44336;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: background 0.2s;
}
.chat-audio-preview-delete:active { background: rgba(244, 67, 54, 0.3); }
.chat-audio-preview-wave {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255,255,255,0.05);
    border-radius: 20px;
    padding: 8px 14px;
}
.chat-audio-preview-icon { font-size: 1.1rem; }
.chat-audio-preview-duration {
    font-size: 0.85rem;
    color: rgba(255,255,255,0.6);
    font-weight: 600;
    font-variant-numeric: tabular-nums;
}
.chat-audio-preview-send {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    border: none;
    background: #4CAF50;
    color: #fff;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    box-shadow: 0 0 12px rgba(76, 175, 80, 0.3);
    transition: transform 0.2s;
}
.chat-audio-preview-send:active { transform: scale(0.9); }

/* ============================================================
   DESKTOP — SCROLL FIX + CENTERING
   ============================================================ */
@media (min-width: 769px) {
    /* Restore scrollbar on desktop */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(255,255,255,0.03); }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.12); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }
    body { scrollbar-width: thin; scrollbar-color: rgba(255,255,255,0.12) transparent; -ms-overflow-style: auto; }
    
    /* Center content */
    .page {
        max-width: 640px;
        margin-left: auto;
        margin-right: auto;
    }
    .header {
        max-width: 640px;
        margin-left: auto;
        margin-right: auto;
    }
    
    /* Touch "..." always visible on hover for desktop */
    .chat-bubble:hover .chat-msg-more-btn { opacity: 1; }
}

/* ============================================================
   SCORE BANNER — Full width on Habitudes page
   ============================================================ */
.score-banner {
    display: flex;
    align-items: center;
    gap: 14px;
    margin: 15px;
    padding: 16px 20px;
    background: var(--charcoal);
    border: 1px solid var(--steel);
    border-radius: 16px;
    position: relative;
    overflow: hidden;
    box-shadow: 0 2px 12px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,255,255,0.04);
}
.score-banner::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, #2ECC71, #27AE60);
    border-radius: 0 0 4px 4px;
}
.score-banner-icon {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border-radius: 12px;
    background: rgba(46, 204, 113, 0.1);
    color: #2ECC71;
}
.score-banner-info {
    flex: 1;
    min-width: 0;
}
.score-banner-label {
    font-size: 0.65rem;
    font-weight: 800;
    letter-spacing: 2px;
    color: rgba(255,255,255,0.5);
    text-transform: uppercase;
    margin-bottom: 6px;
}
.score-banner-bar {
    width: 100%;
    height: 8px;
    background: rgba(255,255,255,0.06);
    border-radius: 4px;
    overflow: hidden;
}
.score-banner-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #2ECC71, #27AE60);
    border-radius: 4px;
    transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 0 8px rgba(46, 204, 113, 0.4);
}
.score-banner-value {
    flex-shrink: 0;
    font-size: 2rem;
    font-weight: 900;
    color: #2ECC71;
    text-shadow: 0 0 15px rgba(46, 204, 113, 0.4);
    min-width: 70px;
    text-align: right;
    font-variant-numeric: tabular-nums;
}

/* ============================================================
   MODE RANKED — COMING SOON CARD
   ============================================================ */
.ranked-coming-soon {
    display: flex;
    align-items: center;
    gap: 14px;
    margin: 15px;
    padding: 16px 18px;
    background: linear-gradient(135deg, rgba(243, 156, 18, 0.08), rgba(231, 76, 60, 0.08));
    border: 1px solid rgba(243, 156, 18, 0.2);
    border-radius: 16px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
}
.ranked-coming-soon::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, #F39C12, #E74C3C, #9B59B6);
}
.ranked-coming-soon:active {
    transform: scale(0.98);
}
.ranked-coming-soon-icon {
    width: 48px;
    height: 48px;
    border-radius: 14px;
    background: rgba(243, 156, 18, 0.12);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #F39C12;
    flex-shrink: 0;
}
.ranked-coming-soon-content { flex: 1; }
.ranked-coming-soon-title {
    font-size: 0.9rem;
    font-weight: 900;
    letter-spacing: 2px;
    color: #F39C12;
    text-shadow: 0 0 12px rgba(243, 156, 18, 0.3);
}
.ranked-coming-soon-desc {
    font-size: 0.7rem;
    color: rgba(255,255,255,0.4);
    margin-top: 3px;
    letter-spacing: 0.5px;
}
.ranked-coming-soon-badge {
    flex-shrink: 0;
    padding: 5px 10px;
    border-radius: 8px;
    background: rgba(243, 156, 18, 0.15);
    color: #F39C12;
    font-size: 0.6rem;
    font-weight: 800;
    letter-spacing: 1.5px;
    border: 1px solid rgba(243, 156, 18, 0.3);
    animation: rankedPulse 2s ease-in-out infinite;
}
@keyframes rankedPulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(243, 156, 18, 0.2); }
    50% { box-shadow: 0 0 12px 4px rgba(243, 156, 18, 0.15); }
}

/* ============================================================
   WEEK DOTS — Overview on Habitudes page
   ============================================================ */
.week-dots {
    display: flex;
    justify-content: center;
    gap: 4px;
    padding: 10px 15px 0;
}
.week-dot {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    flex: 1;
    max-width: 48px;
    padding: 6px 2px;
    border-radius: 10px;
    transition: all 0.2s ease;
}
.week-dot-label {
    font-size: 0.65rem;
    font-weight: 700;
    color: rgba(255,255,255,0.35);
    letter-spacing: 0.5px;
}
.week-dot-indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: rgba(255,255,255,0.08);
    transition: all 0.3s ease;
}

/* TODAY — highlighted background */
.week-dot-current {
    background: rgba(46, 204, 113, 0.12);
    border: 1px solid rgba(46, 204, 113, 0.25);
}
.week-dot-current .week-dot-label {
    color: #2ECC71;
    font-weight: 900;
    font-size: 0.7rem;
}
.week-dot-current .week-dot-indicator {
    width: 10px;
    height: 10px;
    background: #2ECC71;
    box-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
}

/* Past days — colored dots */
.week-dot-good .week-dot-indicator {
    background: #2ECC71;
    box-shadow: 0 0 6px rgba(46, 204, 113, 0.3);
}
.week-dot-good .week-dot-label { color: rgba(46, 204, 113, 0.6); }
.week-dot-partial .week-dot-indicator {
    background: #F39C12;
}
.week-dot-partial .week-dot-label { color: rgba(243, 156, 18, 0.5); }
.week-dot-missed .week-dot-indicator {
    background: rgba(231, 76, 60, 0.6);
}
.week-dot-missed .week-dot-label { color: rgba(231, 76, 60, 0.4); }
.week-dot-rest .week-dot-indicator {
    background: rgba(255,255,255,0.12);
}
.week-dot-future .week-dot-indicator {
    background: rgba(255,255,255,0.05);
}

.score-banner-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 6px;
}
.score-banner-count {
    font-size: 0.7rem;
    font-weight: 700;
    color: rgba(46, 204, 113, 0.7);
    font-variant-numeric: tabular-nums;
}

/* 3-column stats grid for Stats Fun */
.stats-grid-3 {
    grid-template-columns: repeat(3, 1fr) !important;
}

/* Rank card in profile — ensure text visibility */
.stat-card-rank {
    cursor: pointer;
    text-align: center;
}
.stat-card-rank::before {
    background: linear-gradient(90deg, #F39C12, #E67E22) !important;
}
.stat-card-rank .stat-card-icon svg {
    stroke: #F39C12;
}
.stat-card-rank .stat-value {
    text-shadow: 0 0 12px currentColor, 0 1px 2px rgba(0,0,0,0.8) !important;
    font-weight: 900 !important;
}
