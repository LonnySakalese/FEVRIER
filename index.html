<!DOCTYPE html>
<!-- D√©claration du type de document HTML5 -->
<html lang="fr">
<!-- Balise d'ouverture HTML, avec la langue du contenu d√©finie sur "fran√ßais" -->

<head>
    <!-- Section d'en-t√™te du document, contenant les m√©tadonn√©es et les liens -->
    <meta charset="UTF-8">
    <!-- D√©clare l'encodage des caract√®res du document comme √©tant UTF-8 -->
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <!-- Configure le viewport pour un affichage optimal sur les appareils mobiles -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!-- Permet √† l'application web d'√™tre ajout√©e √† l'√©cran d'accueil sur iOS -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Style de la barre de statut sur iOS -->
    <meta name="apple-mobile-web-app-title" content="Warrior">
    <!-- Titre de l'application pour l'√©cran d'accueil iOS -->
    <meta name="theme-color" content="#0A0A0A">
    <!-- Couleur du th√®me pour la barre d'adresse du navigateur sur les mobiles -->
    <meta name="description" content="PROJET FEVRIER : l'application de suivi d'habitudes qui forge ta discipline. Streaks, rangs, badges et statistiques.">
    <meta property="og:title" content="PROJET FEVRIER ‚Äî Forge ta discipline">
    <meta property="og:description" content="Suivi d'habitudes minimaliste. Streaks, rangs, badges et statistiques pour devenir meilleur chaque jour.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://lonnysakalese.github.io/FEVRIER/">
    <meta property="og:image" content="https://lonnysakalese.github.io/FEVRIER/icons/icon-512.png">
    <meta property="og:locale" content="fr_FR">
    <meta name="mobile-web-app-capable" content="yes">
    <!-- Permet √† l'application web d'√™tre ajout√©e √† l'√©cran d'accueil sur Android -->

    <!-- LIENS EXTERNES ET INTERNES -->
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://firestore.googleapis.com" crossorigin>

    <link rel="manifest" href="manifest.json">
    <!-- Lien vers le fichier manifest pour la PWA (Progressive Web App) -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%230A0A0A' width='100' height='100' rx='20'/><path d='M 23 74 Q 27 70 31 66 Q 39 58 47 54 Q 55 50 62 39 Q 68 29 74 19' fill='none' stroke='%23F5F5F0' stroke-width='6' stroke-linecap='round'/><path d='M 66 16 L 77 18 L 75 29' fill='none' stroke='%23F5F5F0' stroke-width='6' stroke-linecap='round'/></svg>">
    <!-- Favicon SVG int√©gr√© directement dans le HTML -->
    <link rel="apple-touch-icon" href="favicon.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon.svg">
    <link rel="apple-touch-icon" sizes="152x152" href="favicon.svg">
    <link rel="apple-touch-icon" sizes="120x120" href="favicon.svg">
    <!-- Ic√¥nes pour l'√©cran d'accueil sur les appareils Apple -->
    <title>PROJET FEVRIER</title>
    <!-- Titre de la page qui s'affiche dans l'onglet du navigateur -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Inclusion de la biblioth√®que Chart.js pour les graphiques -->

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-messaging-compat.js"></script>
    <!-- Inclusion des biblioth√®ques Firebase pour l'authentification et la base de donn√©es -->

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="responsive.css">
</head>

<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-content">
            <svg class="splash-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                <rect fill="#0A0A0A" width="100" height="100" rx="20"/>
                <path d="M 23 74 Q 27 70 31 66 Q 39 58 47 54 Q 55 50 62 39 Q 68 29 74 19" fill="none" stroke="#F5F5F0" stroke-width="6" stroke-linecap="round" class="splash-arrow"/>
                <path d="M 66 16 L 77 18 L 75 29" fill="none" stroke="#F5F5F0" stroke-width="6" stroke-linecap="round" class="splash-arrowhead"/>
            </svg>
            <div class="splash-title">PROJET FEVRIER</div>
            <div class="splash-tagline">Forge ta discipline</div>
            <div class="splash-loader"></div>
        </div>
    </div>

    <!-- Onboarding Overlay (ancien - tutorial simple) -->
    <div class="onboarding-overlay" id="onboardingOverlay">
        <div class="onboarding-card">
            <button class="onboarding-skip" onclick="skipTutorial()">Passer</button>
            <div class="onboarding-icon" id="onboardingIcon">üéØ</div>
            <h2 class="onboarding-title" id="onboardingTitle">D√âFINIS TES HABITUDES</h2>
            <p class="onboarding-text" id="onboardingText"></p>
            <div class="onboarding-dots">
                <span class="onboarding-dot active"></span>
                <span class="onboarding-dot"></span>
                <span class="onboarding-dot"></span>
            </div>
            <div class="onboarding-buttons">
                <button class="onboarding-btn secondary" id="onboardingPrev" onclick="prevTutorialStep()">‚Üê RETOUR</button>
                <button class="onboarding-btn primary" id="onboardingNext" onclick="nextTutorialStep()">SUIVANT ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- Onboarding am√©lior√© - Cr√©ation d'habitudes -->
    <div class="habit-onboarding-overlay" id="habitOnboardingOverlay">
        <div class="onb-container">
            <div class="onb-dots">
                <span class="onb-dot active"></span>
                <span class="onb-dot"></span>
                <span class="onb-dot"></span>
            </div>
            <div class="onb-steps-container">
                <!-- Contenu rendu dynamiquement par onboarding.js -->
            </div>
        </div>
    </div>

    <!-- Page d'authentification (affich√©e si non connect√©) -->
    <div id="page-auth" class="page">
        <div class="auth-container">
            <div class="auth-logo">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                    <rect fill="#0A0A0A" width="100" height="100" rx="20" />
                    <path d="M 23 74 Q 27 70 31 66 Q 39 58 47 54 Q 55 50 62 39 Q 68 29 74 19" fill="none"
                        stroke="#F5F5F0" stroke-width="6" stroke-linecap="round" />
                    <path d="M 66 16 L 77 18 L 75 29" fill="none" stroke="#F5F5F0" stroke-width="6"
                        stroke-linecap="round" />
                </svg>
                <h1>PROJET FEVRIER</h1>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" onclick="showAuthTab('login')" data-i18n="auth.login">CONNEXION</button>
                <button class="auth-tab" onclick="showAuthTab('signup')" data-i18n="auth.signup">INSCRIPTION</button>
            </div>

            <!-- Formulaire de connexion -->
            <div id="auth-login" class="auth-form active">
                <input type="email" id="login-email" placeholder="Email" data-i18n="auth.email" autocomplete="email" required>
                <input type="password" id="login-password" placeholder="Mot de passe (min 8 caract√®res)" data-i18n="auth.password"
                    autocomplete="current-password" required>
                <button class="auth-btn" onclick="handleLogin()" data-i18n="auth.loginBtn">Se connecter</button>
                <div class="auth-error" id="login-error"></div>
                <a href="#" class="forgot-password-link" onclick="handleForgotPassword(); return false;" data-i18n="auth.forgotPassword">Mot de passe
                    oubli√© ?</a>
            </div>

            <!-- Formulaire d'inscription -->
            <div id="auth-signup" class="auth-form">
                <input type="email" id="signup-email" placeholder="Email" data-i18n="auth.email" autocomplete="email" required>
                <input type="password" id="signup-password" placeholder="Mot de passe (min 8 caract√®res)" data-i18n="auth.password"
                    autocomplete="new-password" required>
                <input type="password" id="signup-confirm" placeholder="Confirmer le mot de passe" data-i18n="auth.confirmPassword"
                    autocomplete="new-password" required>
                <button class="auth-btn" onclick="handleSignup()" data-i18n="auth.signupBtn">S'inscrire</button>
                <div class="auth-error" id="signup-error"></div>
            </div>
        </div>
    </div>

    <!-- En-t√™te principal de l'application -->
    <div class="header">
        <h1>PROJET FEVRIER</h1>
        <div class="quote">TEXTE</div>
    </div>

    <!-- Page "Aujourd'hui" : affiche les habitudes du jour -->
    <div id="page-today" class="page active" role="main">
        <!-- Pull-to-refresh visual indicator -->
        <div class="pull-indicator" id="pullIndicator">
            <span class="pull-icon">‚Üª</span> Mise √† jour...
        </div>
        <!-- Navigation pour changer de date -->
        <div class="date-nav">
            <button class="date-nav-btn" onclick="changeDate(-1)" aria-label="Jour pr√©c√©dent">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
            </button>
            <div class="current-date" id="currentDate"></div>
            <button class="date-nav-btn date-nav-today" onclick="changeDate(0)" aria-label="Aujourd'hui" id="dateNavToday" style="display:none;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            </button>
        </div>

        <!-- Week overview dots -->
        <div class="week-dots" id="weekDots"></div>

        <!-- Score du jour ‚Äî full width -->
        <div class="score-banner">
            <div class="score-banner-icon">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            </div>
            <div class="score-banner-info">
                <div class="score-banner-top">
                    <span class="score-banner-label" data-i18n="today.score">SCORE DU JOUR</span>
                    <span class="score-banner-count" id="scoreBannerCount">0/0</span>
                </div>
                <div class="score-banner-bar">
                    <div class="score-banner-bar-fill" id="scoreBannerFill" style="width: 0%"></div>
                </div>
            </div>
            <div class="score-banner-value" id="dailyScore" aria-live="polite">0%</div>
        </div>

        <!-- Barre XP -->
        <div class="xp-bar-container" id="xpBarContainer">
            <div class="xp-bar-header">
                <span class="xp-level" id="xpLevel">LVL 1</span>
                <span class="xp-amount" id="xpAmount">0 / 100 XP</span>
                <span class="xp-info-btn" id="xpInfoBtn" onclick="toggleXPInfo()">‚ÑπÔ∏è</span>
            </div>
            <div class="xp-bar">
                <div class="xp-bar-fill" id="xpBarFill" style="width: 0%"></div>
            </div>
            <div class="xp-status" id="xpStatus">
                <span class="xp-today" id="xpToday">+0 XP aujourd'hui</span>
                <span class="xp-fatigue-badge" id="xpFatigueBadge" style="display: none;">üò¥ FATIGUE</span>
            </div>
            <!-- Panel d'explication XP -->
            <div class="xp-info-panel" id="xpInfoPanel" style="display: none;">
                <div class="xp-info-title">‚ö° COMMENT √áA MARCHE</div>
                <div class="xp-info-rules">
                    <div class="xp-info-rule">‚úÖ Cocher une habitude <strong>+10 XP</strong></div>
                    <div class="xp-info-rule">üìã Valider la journ√©e <strong>+50 XP</strong></div>
                    <div class="xp-info-rule">üèÜ Journ√©e parfaite (100%) <strong>+100 XP</strong></div>
                    <div class="xp-info-rule">üî• Streak 7 jours <strong>+200 XP</strong></div>
                    <div class="xp-info-rule">üî• Streak 30 jours <strong>+500 XP</strong></div>
                </div>
                <div class="xp-info-divider"></div>
                <div class="xp-info-title">üò¥ FATIGUE</div>
                <div class="xp-info-rules">
                    <div class="xp-info-rule">Si ton score de la veille est <strong>< 70%</strong>, la fatigue s'active</div>
                    <div class="xp-info-rule">En fatigue, tu gagnes <strong>2√ó moins d'XP</strong></div>
                    <div class="xp-info-rule">Pour la lever ‚Üí atteins <strong>100% aujourd'hui</strong></div>
                </div>
            </div>
        </div>

        <!-- Titre de la section des habitudes -->
        <div class="missions-header">
            <div class="missions-title-row">
                <div class="missions-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
                </div>
                <span class="missions-title" data-i18n="today.missions">MISSIONS DU JOUR</span>
            </div>
            <div class="missions-count" id="completedCount">0/10</div>
        </div>

        <!-- Cat√©gories supprim√©es -->

        <!-- Liste des habitudes (g√©n√©r√©e par JavaScript) -->
        <div class="habits-list" id="habitsList"></div>

        <!-- Boutons d'action -->
        <div class="today-actions">
            <button id="validateDayBtn" class="action-btn action-btn-primary" onclick="showValidateDayModal()" style="display: none;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                <span data-i18n="today.validateDay">Valider la journ√©e</span>
            </button>
            <button class="action-btn action-btn-secondary" onclick="shareDay()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
                <span data-i18n="today.shareDay">Partager</span>
            </button>
        </div>
    </div>

    <!-- Page "Stats" : affiche les statistiques et graphiques -->
    <div id="page-stats" class="page" role="main">
        <!-- Rang + Calendrier ‚Äî premium cards -->
        <div class="stats-top-row">
            <div class="rank-card" onclick="openRanksModal()">
                <div class="rank-card-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                </div>
                <div class="rank-card-label">Rang</div>
                <div class="rank-card-name" id="rankName">D√âBUTANT</div>
                <div class="rank-card-bar">
                    <div class="rank-card-bar-fill" id="rankProgress" style="width: 0%"></div>
                </div>
            </div>
            <div class="calendar-card" onclick="openCalendarModal()">
                <div class="calendar-card-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                </div>
                <div class="calendar-card-label">Calendrier</div>
                <div class="calendar-card-month" id="calendarCardMonth">F√©vrier</div>
            </div>
        </div>

        <!-- Mode Ranked ‚Äî Coming Soon -->
        <div class="ranked-coming-soon" onclick="showRankedTeaser()">
            <div class="ranked-coming-soon-icon">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"/><path d="M4 22h16"/><path d="M10 22V8h4v14"/><path d="M6 14h12"/></svg>
            </div>
            <div class="ranked-coming-soon-content">
                <div class="ranked-coming-soon-title">MODE RANKED</div>
                <div class="ranked-coming-soon-desc">Saisons ‚Ä¢ Classements ‚Ä¢ Badges exclusifs</div>
            </div>
            <div class="ranked-coming-soon-badge">√Ä VENIR</div>
        </div>

        <!-- Section des Badges -->
        <div id="badgesContainer"></div>

        <!-- Heatmap 90 jours -->

        <!-- Grille de performance de la semaine -->
        <div class="section-title" data-i18n="stats.thisWeek">üìä CETTE SEMAINE</div>
        <div class="weekly-grid" id="weeklyGrid"></div>

        <!-- Section des graphiques de progression -->
        <div class="section-title" data-i18n="stats.progression">üìà PROGRESSION</div>
        <div class="chart-container">
            <div class="chart-wrapper">
                <div class="chart-title" data-i18n="stats.last7days">Score des 7 derniers jours</div>
                <canvas id="weeklyChart"></canvas>
            </div>
            <div class="chart-wrapper">
                <div class="chart-title" data-i18n="stats.byHabit">Performance par habitude</div>
                <canvas id="habitsChart"></canvas>
            </div>
        </div>

        <!-- Grille des statistiques g√©n√©rales -->
        <div class="stats-grid">
            <div class="stat-card stat-card-green">
                <div class="stat-card-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg></div>
                <div class="stat-value" id="monthScore">0%</div>
                <div class="stat-label" data-i18n="stats.monthScore">Score du mois</div>
            </div>
            <div class="stat-card stat-card-orange">
                <div class="stat-card-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg></div>
                <div class="stat-value" id="bestStreak">0</div>
                <div class="stat-label" data-i18n="stats.bestStreak">Meilleure s√©rie</div>
            </div>
            <div class="stat-card stat-card-purple">
                <div class="stat-card-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"/><path d="M4 22h16"/><path d="M10 22V8h4v14"/><path d="M6 14h12"/></svg></div>
                <div class="stat-value" id="totalWins">0</div>
                <div class="stat-label" data-i18n="stats.totalWins">Victoires totales</div>
            </div>
            <div class="stat-card stat-card-blue">
                <div class="stat-card-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/></svg></div>
                <div class="stat-value" id="avgScore">0%</div>
                <div class="stat-label" data-i18n="stats.avgScore">Moyenne globale</div>
            </div>
        </div>

        <!-- Analyses avanc√©es -->
        <div class="section-title">üî¨ ANALYSES AVANC√âES</div>
        <div class="analytics-container" id="analyticsContainer">
            <!-- Rendu dynamique -->
        </div>
    </div>

    <!-- Page "Motivation/Param√®tres" -->
    <!-- ADMIN PAGE -->
    <div id="page-admin" class="page" role="main">
        <div class="admin-header">
            <button class="admin-back-btn" onclick="showPage('profile')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
            </button>
            <h2 class="admin-title">üõ°Ô∏è ADMIN PANEL</h2>
        </div>
        <div class="admin-container">
            <!-- Menu principal admin -->
            <div id="adminMenu" class="admin-menu">
                <div class="admin-menu-card admin-menu-green" onclick="openAdminSection('users')">
                    <div class="admin-menu-icon">üë•</div>
                    <div class="admin-menu-info">
                        <div class="admin-menu-label">Utilisateurs</div>
                        <div class="admin-menu-count" id="adminTotalUsers">-</div>
                    </div>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                </div>
                <div class="admin-menu-card admin-menu-orange" onclick="openAdminSection('groups')">
                    <div class="admin-menu-icon">üèòÔ∏è</div>
                    <div class="admin-menu-info">
                        <div class="admin-menu-label">Groupes</div>
                        <div class="admin-menu-count" id="adminTotalGroups">-</div>
                    </div>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                </div>
                <div class="admin-menu-card admin-menu-purple" onclick="openAdminSection('challenges')">
                    <div class="admin-menu-icon">‚öîÔ∏è</div>
                    <div class="admin-menu-info">
                        <div class="admin-menu-label">Challenges</div>
                        <div class="admin-menu-count" id="adminTotalChallenges">-</div>
                    </div>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                </div>
            </div>

            <!-- Section d√©tail (cach√©e par d√©faut) -->
            <div id="adminDetail" class="admin-detail" style="display:none;">
                <button class="admin-detail-back" onclick="closeAdminSection()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
                    <span>Retour</span>
                </button>
                <div class="section-title" id="adminDetailTitle"></div>
                <div id="adminDetailContent"></div>
            </div>
        </div>
    </div>

    <div id="page-motivation" class="page" role="main">

        <!-- Section des param√®tres -->
        <div class="section-title" data-i18n="settings.title">‚öôÔ∏è PARAM√àTRES</div>

        <div class="settings-container">
            <!-- Cat√©gorie : Habitudes -->
            <div class="settings-category">
                <div class="settings-category-header">
                    <span class="settings-category-icon">üìù</span>
                    <span class="settings-category-title" data-i18n="settings.habits">Habitudes</span>
                </div>
                <div class="settings-category-content">
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label" data-i18n="settings.manageHabits">Gestion des habitudes</div>
                            <div class="settings-item-desc" data-i18n="settings.manageHabitsDesc">Ajouter, modifier ou supprimer</div>
                        </div>
                        <div class="settings-item-action">
                            <button class="settings-btn primary" onclick="openManageHabitsModal()" data-i18n="settings.modify">Modifier</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cat√©gorie : Notifications -->
            <div class="settings-category">
                <div class="settings-category-header">
                    <span class="settings-category-icon">üîî</span>
                    <span class="settings-category-title" data-i18n="settings.notifications">Notifications</span>
                </div>
                <div class="settings-category-content">
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label" data-i18n="settings.reminderTime">Heure de rappel</div>
                            <div class="settings-item-desc" data-i18n="settings.dailyReminder">Rappel quotidien</div>
                        </div>
                        <div class="settings-item-action">
                            <div class="time-input-wrapper">
                                <span class="time-icon">‚è∞</span>
                                <input type="time" id="notifTime" value="21:00" class="settings-time-input"
                                    onchange="updateNotificationTime()">
                            </div>
                        </div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label" data-i18n="settings.enableNotifs">Activer les notifications</div>
                            <div class="settings-item-desc" data-i18n="settings.receiveReminders">Recevoir des rappels</div>
                        </div>
                        <div class="settings-item-action">
                            <button id="notifBtn" class="settings-btn" onclick="toggleNotifications()">OFF</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cat√©gorie : Compte -->
            <div class="settings-category">
                <div class="settings-category-header">
                    <span class="settings-category-icon">üë§</span>
                    <span class="settings-category-title" data-i18n="settings.account">Compte</span>
                </div>
                <div class="settings-category-content">
                    <div class="settings-item" id="logoutItem" style="display: none;">
                        <div class="settings-item-info">
                            <div class="settings-item-label" data-i18n="settings.logout">D√©connexion</div>
                            <div class="settings-item-desc" data-i18n="settings.logoutDesc">Se d√©connecter de l'application</div>
                        </div>
                        <div class="settings-item-action">
                            <button id="logoutBtn" class="settings-btn" onclick="handleLogout()" data-i18n="settings.logoutBtn">Sortir</button>
                        </div>
                    </div>
                    <div class="settings-item" id="deleteItem" style="display: none;">
                        <div class="settings-item-info">
                            <div class="settings-item-label" data-i18n="settings.deleteAccount">Supprimer le compte</div>
                            <div class="settings-item-desc" data-i18n="settings.deleteDesc">Action irr√©versible</div>
                        </div>
                        <div class="settings-item-action">
                            <button id="deleteAccountBtn" class="settings-btn danger"
                                onclick="handleDeleteAccount()" data-i18n="settings.deleteBtn">Supprimer</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cat√©gorie : Donn√©es -->
            <div class="settings-category">
                <div class="settings-category-header">
                    <span class="settings-category-icon">üíæ</span>
                    <span class="settings-category-title" data-i18n="settings.data">Donn√©es</span>
                </div>
                <div class="settings-category-content">
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label" data-i18n="settings.export">Exporter les donn√©es</div>
                            <div class="settings-item-desc" data-i18n="settings.exportDesc">T√©l√©charger en CSV</div>
                        </div>
                        <div class="settings-item-action">
                            <button class="settings-btn" onclick="exportDataCSV()">üì§ Export</button>
                        </div>
                    </div>
                    <!-- R√©initialiser supprim√© ‚Äî utiliser Supprimer le compte √† la place -->
                </div>
            </div>

            <!-- Cat√©gorie : Notifications -->
            <div class="settings-category">
                <div class="settings-category-header">
                    <span class="settings-category-icon">üîî</span>
                    <span class="settings-category-title">Notifications</span>
                </div>
                <div class="settings-category-content">
                    <div id="notifSettingsContainer"></div>
                </div>
            </div>

            <!-- Cat√©gorie : Langue -->
            <div class="settings-category">
                <div class="settings-category-header">
                    <span class="settings-category-icon">üåç</span>
                    <span class="settings-category-title" data-i18n="settings.language">Langue</span>
                </div>
                <div class="settings-category-content">
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label" data-i18n="settings.language">Langue</div>
                            <div class="settings-item-desc" data-i18n="settings.languageDesc">Changer la langue</div>
                        </div>
                        <div class="settings-item-action">
                            <button class="settings-btn" id="langToggleBtn" onclick="cycleLang()">üá´üá∑ FR</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cat√©gorie : Application -->
            <div class="settings-category">
                <div class="settings-category-header">
                    <span class="settings-category-icon">üì±</span>
                    <span class="settings-category-title">Application</span>
                </div>
                <div class="settings-category-content">
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">Raccourci iOS</div>
                            <div class="settings-item-desc">Ajouter un widget ou raccourci sur iPhone</div>
                        </div>
                        <div class="settings-item-action">
                            <button class="settings-btn" onclick="window.open('apple-shortcut.html', '_blank')">üì≤ Guide</button>
                        </div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">Installer l'app</div>
                            <div class="settings-item-desc">Ajouter √† l'√©cran d'accueil</div>
                        </div>
                        <div class="settings-item-action">
                            <button class="settings-btn" id="settingsInstallBtn" onclick="promptInstallFromSettings()">‚¨áÔ∏è Installer</button>
                        </div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">Version</div>
                            <div class="settings-item-desc">FEVRIER v1.0</div>
                        </div>
                        <div class="settings-item-action">
                            <span style="color: var(--accent-dim); font-size: 0.8rem;">‚ö°</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cat√©gorie : L√©gal -->
            <div class="settings-category">
                <div class="settings-category-header">
                    <span class="settings-category-icon">üìÑ</span>
                    <span class="settings-category-title">L√©gal</span>
                </div>
                <div class="settings-category-content">
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">Conditions d'utilisation</div>
                            <div class="settings-item-desc">CGU de l'application</div>
                        </div>
                        <div class="settings-item-action">
                            <button class="settings-btn" onclick="window.open('cgu.html', '_blank')">Lire</button>
                        </div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">Politique de confidentialit√©</div>
                            <div class="settings-item-desc">RGPD & donn√©es personnelles</div>
                        </div>
                        <div class="settings-item-action">
                            <button class="settings-btn" onclick="window.open('privacy.html', '_blank')">Lire</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Fen√™tre modale pour la gestion compl√®te des habitudes -->
    <div class="modal-overlay" id="manageHabitsModal">
        <div class="modal modal-large">
            <h3>‚öôÔ∏è G√âRER LES HABITUDES</h3>

            <!-- Section pour ajouter une nouvelle habitude -->
            <div class="add-habit-section collapsed" id="addHabitSection">
                <button class="add-habit-toggle" onclick="toggleAddHabitForm()">
                    ‚ûï Ajouter une habitude
                </button>
                <div class="add-habit-form" id="addHabitForm">
                    <div class="form-group">
                        <label>Nom de l'habitude</label>
                        <input type="text" id="newHabitName" placeholder="Ex: M√âDITATION" maxlength="50">
                    </div>

                    <div class="form-group">
                        <label>Description <span class="optional-label">(optionnel)</span></label>
                        <textarea id="newHabitDescription" placeholder="Ex: 10 minutes de m√©ditation chaque matin" maxlength="150" rows="2"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Ic√¥ne</label>
                        <div class="icon-picker" id="iconPicker">
                            <!-- Ic√¥nes populaires pour habitudes -->
                            <div class="icon-option" data-icon="üßò">üßò</div>
                            <div class="icon-option" data-icon="üèÉ">üèÉ</div>
                            <div class="icon-option" data-icon="üí™">üí™</div>
                            <div class="icon-option" data-icon="üéµ">üéµ</div>
                            <div class="icon-option" data-icon="üìñ">üìñ</div>
                            <div class="icon-option" data-icon="‚úçÔ∏è">‚úçÔ∏è</div>
                            <div class="icon-option" data-icon="üé®">üé®</div>
                            <div class="icon-option" data-icon="üß†">üß†</div>
                            <div class="icon-option" data-icon="‚ù§Ô∏è">‚ù§Ô∏è</div>
                            <div class="icon-option" data-icon="üå±">üå±</div>
                            <div class="icon-option" data-icon="‚òÄÔ∏è">‚òÄÔ∏è</div>
                            <div class="icon-option" data-icon="üåô">üåô</div>
                            <div class="icon-option" data-icon="‚≠ê">‚≠ê</div>
                            <div class="icon-option" data-icon="üíé">üíé</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Couleur</label>
                        <div class="color-picker-grid" id="colorPicker">
                            <div class="color-option" data-color="#F5F5F0" style="background: #F5F5F0;"></div>
                            <div class="color-option" data-color="#87CEEB" style="background: #87CEEB;"></div>
                            <div class="color-option" data-color="#90EE90" style="background: #90EE90;"></div>
                            <div class="color-option" data-color="#FFD700" style="background: #FFD700;"></div>
                            <div class="color-option" data-color="#FF6B6B" style="background: #FF6B6B;"></div>
                            <div class="color-option" data-color="#9370DB" style="background: #9370DB;"></div>
                            <div class="color-option" data-color="#FF69B4" style="background: #FF69B4;"></div>
                            <div class="color-option" data-color="#FFA500" style="background: #FFA500;"></div>
                            <div class="color-option" data-color="#4682B4" style="background: #4682B4;"></div>
                            <div class="color-option" data-color="#32CD32" style="background: #32CD32;"></div>
                            <div class="color-option" data-color="#FF4500" style="background: #FF4500;"></div>
                            <div class="color-option" data-color="#8B4513" style="background: #8B4513;"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Fr√©quence</label>
                        <div class="schedule-type-picker" id="scheduleTypePicker">
                            <button type="button" class="schedule-type-btn active" data-type="daily" onclick="setScheduleType('daily')">
                                üìÖ Tous les jours
                            </button>
                            <button type="button" class="schedule-type-btn" data-type="weekly" onclick="setScheduleType('weekly')">
                                üìÜ Certains jours
                            </button>
                        </div>
                        <div class="days-of-week-picker" id="daysOfWeekPicker" style="display: none;">
                            <div class="day-checkbox" data-day="1" onclick="toggleDayOfWeek(1)">L</div>
                            <div class="day-checkbox" data-day="2" onclick="toggleDayOfWeek(2)">M</div>
                            <div class="day-checkbox" data-day="3" onclick="toggleDayOfWeek(3)">M</div>
                            <div class="day-checkbox" data-day="4" onclick="toggleDayOfWeek(4)">J</div>
                            <div class="day-checkbox" data-day="5" onclick="toggleDayOfWeek(5)">V</div>
                            <div class="day-checkbox" data-day="6" onclick="toggleDayOfWeek(6)">S</div>
                            <div class="day-checkbox" data-day="0" onclick="toggleDayOfWeek(0)">D</div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button class="form-btn cancel" onclick="cancelAddHabit()">Annuler</button>
                        <button class="form-btn save" onclick="saveNewHabit()">Ajouter</button>
                    </div>
                </div>
            </div>

            <!-- Liste des habitudes existantes -->
            <div class="habits-management-list" id="habitsManagementList">
                <!-- Rempli dynamiquement par JavaScript -->
            </div>

            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeManageHabitsModal()">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Modal de migration localStorage ‚Üí Firestore -->
    <div class="modal-overlay" id="migrationModal">
        <div class="modal">
            <h3>üîÑ MIGRATION DES DONN√âES</h3>
            <p style="color: var(--accent-dim); text-align: center; margin-bottom: 15px;">
                Nous avons d√©tect√© des donn√©es existantes sur cet appareil.<br>
                Veux-tu les transf√©rer vers ton nouveau compte ?
            </p>
            <div class="migration-preview" id="migrationPreview">
                <!-- Aper√ßu des donn√©es √† migrer (rempli dynamiquement) -->
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="skipMigration()">Ignorer</button>
                <button class="modal-btn save" onclick="performMigration()">Migrer</button>
            </div>
        </div>
    </div>

    <!-- Modal de validation de journ√©e -->
    <div class="modal-overlay" id="validateDayModal">
        <div class="modal">
            <h3>‚úÖ VALIDER LA JOURN√âE</h3>
            <p style="color: var(--accent); text-align: center; margin: 20px 0; font-size: 1.1rem;">
                Es-tu s√ªr de vouloir valider ta journ√©e ?
            </p>
            <p style="color: var(--accent-dim); text-align: center; margin-bottom: 20px; font-size: 0.9rem;">
                Une fois valid√©e, tu ne pourras plus modifier tes habitudes d'aujourd'hui.
            </p>

            <div style="display: flex; gap: 15px; margin-top: 30px;">
                <button class="modal-btn cancel" onclick="closeValidateDayModal()">Annuler</button>
                <button class="modal-btn save" onclick="confirmValidateDay()">Confirmer</button>
            </div>
        </div>
    </div>

    <!-- Modal de d√©connexion -->
    <div class="modal-overlay" id="logoutModal">
        <div class="modal">
            <h3>üö™ D√âCONNEXION</h3>
            <p style="color: var(--accent); text-align: center; margin: 20px 0; font-size: 1.1rem;">
                Veux-tu vraiment te d√©connecter ?
            </p>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeLogoutModal()">Annuler</button>
                <button class="modal-btn save" onclick="confirmLogout()">D√©connecter</button>
            </div>
        </div>
    </div>

    <!-- Modal de confirmation g√©n√©rique -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal">
            <h3 id="confirmModalTitle">Confirmation</h3>
            <p id="confirmModalMessage"
                style="color: var(--accent); text-align: center; margin: 20px 0; font-size: 1rem; line-height: 1.5;">
            </p>
            <p id="confirmModalSubtext"
                style="color: var(--accent-dim); text-align: center; margin-bottom: 20px; font-size: 0.85rem; display: none;">
            </p>
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="confirmModalCancel">Annuler</button>
                <button class="modal-btn save" id="confirmModalConfirm">Confirmer</button>
            </div>
        </div>
    </div>

    <!-- Modal de suppression de compte -->
    <div class="modal-overlay" id="deleteAccountModal">
        <div class="modal">
            <h3>‚ö†Ô∏è SUPPRIMER MON COMPTE</h3>
            <p style="color: #FF6B6B; text-align: center; margin: 15px 0; font-size: 1rem; font-weight: bold;">
                Cette action est IRR√âVERSIBLE !
            </p>
            <div style="background: var(--dark-gray); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <p style="color: var(--accent-dim); font-size: 0.85rem; text-align: left; margin-bottom: 10px;">
                    Toutes tes donn√©es seront <strong>d√©finitivement supprim√©es,</strong> ton historique sera effac√© et
                    tes habitudes enregistr√©es seront <strong>PERDUES.</strong>
                </p>
            </div>
            <p style="color: var(--accent); text-align: center; margin-bottom: 10px; font-size: 0.9rem;">
                Entre ton <strong>mot de passe</strong> pour confirmer :
            </p>
            <input type="password" id="deleteAccountInput" placeholder="Ton mot de passe"
                style="width: 100%; padding: 12px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 1rem; text-align: center; margin-bottom: 20px; box-sizing: border-box;">
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeDeleteAccountModal()">Annuler</button>
                <button class="modal-btn save" style="background: #8B0000; color: #FFE5E5;"
                    onclick="confirmDeleteAccount()">Supprimer</button>
            </div>
        </div>
    </div>

    <!-- ============================================================ -->
    <!-- MODAL CALENDRIER VISUEL - IMPACT PSYCHOLOGIQUE -->
    <!-- ============================================================ -->
    <div class="modal-overlay" id="calendarModal">
        <div class="modal modal-calendar">
            <div class="calendar-header">
                <button class="calendar-nav-btn" onclick="changeCalendarMonth(-1)" aria-label="Mois pr√©c√©dent">‚óÄ</button>
                <h3 id="calendarTitle">üìÖ JANVIER 2025</h3>
                <button class="calendar-nav-btn" onclick="changeCalendarMonth(1)" aria-label="Mois suivant">‚ñ∂</button>
            </div>
            <p class="calendar-subtitle">Visualise tes victoires et tes √©checs d'un seul regard</p>

            <!-- L√©gende -->
            <div class="calendar-legend">
                <div class="legend-item">
                    <span class="legend-box legend-success"></span>
                    <span>Fait</span>
                </div>
                <div class="legend-item">
                    <span class="legend-box legend-fail"></span>
                    <span>Non fait</span>
                </div>
                <div class="legend-item">
                    <span class="legend-box legend-future"></span>
                    <span>√Ä venir</span>
                </div>
            </div>

            <!-- Calendrier g√©n√©r√© dynamiquement -->
            <div class="calendar-grid-container" id="calendarGridContainer">
                <!-- Rempli par JavaScript -->
            </div>

            <!-- R√©sum√© du mois -->
            <div class="calendar-summary" id="calendarSummary">
                <!-- Rempli par JavaScript -->
            </div>

            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeCalendarModal()" style="flex: 1;">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Page "Profil" : profil utilisateur -->
    <div id="page-profile" class="page" role="main">
        <div class="profile-container">
            <!-- Avatar -->
            <div class="profile-avatar-section">
                <div class="profile-avatar" id="profileAvatar">ü¶Å</div>
                <button class="profile-change-avatar-btn" onclick="openAvatarPicker()">Changer l'avatar</button>
            </div>

            <!-- Infos -->
            <div class="profile-info-section">
                <div class="profile-field">
                    <label class="profile-label" data-i18n="profile.pseudo">Pseudo</label>
                    <div class="profile-value" id="profilePseudo">-</div>
                    <button class="profile-edit-btn" onclick="openEditPseudoModal()">‚úèÔ∏è</button>
                </div>
                <div class="profile-field">
                    <label class="profile-label" data-i18n="profile.bio">Bio</label>
                    <div class="profile-value" id="profileBio" style="font-style: italic; color: var(--accent-dim);">Aucune bio</div>
                    <button class="profile-edit-btn" onclick="openEditBioModal()">‚úèÔ∏è</button>
                </div>
            </div>

            <!-- Stats publiques ‚Äî premium cards -->
            <div class="section-title" data-i18n="profile.myStats">üìä MES STATS</div>
            <div class="stats-grid">
                <div class="stat-card stat-card-green">
                    <div class="stat-card-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg></div>
                    <div class="stat-value" id="profileAvgScore">0%</div>
                    <div class="stat-label" data-i18n="profile.avgScore">Score moyen</div>
                </div>
                <div class="stat-card stat-card-orange">
                    <div class="stat-card-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg></div>
                    <div class="stat-value" id="profileBestStreak">0</div>
                    <div class="stat-label" data-i18n="profile.bestStreak">Meilleur streak</div>
                </div>
                <div class="stat-card stat-card-purple">
                    <div class="stat-card-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></div>
                    <div class="stat-value" id="profilePerfectDays">0</div>
                    <div class="stat-label" data-i18n="profile.perfectDays">Jours parfaits</div>
                </div>
                <div class="stat-card stat-card-rank" id="profileRankCard" onclick="openRanksModal()">
                    <div class="stat-card-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></div>
                    <div class="stat-value" id="profileRank" style="font-size: 0.9rem; letter-spacing: 2px;">D√âBUTANT</div>
                    <div class="stat-label" data-i18n="profile.rank">Rang</div>
                </div>
            </div>

            <!-- Stats fun -->
            <div class="section-title">üéÆ STATS FUN</div>
            <div class="stats-grid stats-grid-3">
                <div class="stat-card stat-card-orange">
                    <div class="stat-card-icon" id="streakFlameIcon">üî•</div>
                    <div class="stat-value" id="profileCurrentStreak">0</div>
                    <div class="stat-label" id="streakCardLabel">Streak actuel</div>
                </div>
                <div class="stat-card stat-card-purple">
                    <div class="stat-card-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"/><path d="M4 22h16"/><path d="M10 22V8h4v14"/><path d="M6 14h12"/></svg></div>
                    <div class="stat-value" id="profileTotalWins">0</div>
                    <div class="stat-label">Victoires totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg></div>
                    <div class="stat-value" id="profileBestStreakFun">0</div>
                    <div class="stat-label">Record streak</div>
                </div>
            </div>

            <!-- Groupes -->
            <div class="section-title" data-i18n="profile.myGroups">üë• MES GROUPES</div>
            <div id="profileGroups" class="profile-groups-container">
                <div class="profile-groups-placeholder">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: rgba(255,255,255,0.2);"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    <span>Aucun groupe</span>
                </div>
            </div>

            <!-- Membre depuis + Param√®tres -->
            <div class="profile-footer-section">
                <div class="profile-member-since" id="profileMemberSince">
                    Membre depuis -
                </div>
                <button class="profile-settings-btn" onclick="showPage('motivation')">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
                    <span>Param√®tres</span>
                </button>
                <button class="profile-settings-btn admin-btn" id="adminPanelBtn" onclick="showPage('admin')" style="display:none; background: linear-gradient(135deg, rgba(231,76,60,0.15), rgba(231,76,60,0.05)); border-color: rgba(231,76,60,0.3);">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#E74C3C" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                    <span style="color: #E74C3C;">Admin Panel</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Avatar Picker -->
    <div class="modal-overlay" id="avatarPickerModal">
        <div class="modal">
            <h3>üé® CHOISIS TON AVATAR</h3>
            <div class="avatar-picker-grid" id="avatarPickerGrid">
                <!-- Rempli par JavaScript -->
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeAvatarPicker()">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Modal Edit Pseudo -->
    <div class="modal-overlay" id="editPseudoModal">
        <div class="modal">
            <h3>‚úèÔ∏è MODIFIER LE PSEUDO</h3>
            <input type="text" id="editPseudoInput" placeholder="Ton pseudo" maxlength="20" style="width: 100%; padding: 12px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 1rem; text-align: center; margin-bottom: 15px;">
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeEditPseudoModal()">Annuler</button>
                <button class="modal-btn save" onclick="saveProfilePseudo()">Sauvegarder</button>
            </div>
        </div>
    </div>

    <!-- Modal Edit Bio -->
    <div class="modal-overlay" id="editBioModal">
        <div class="modal">
            <h3>‚úèÔ∏è MODIFIER LA BIO</h3>
            <textarea id="editBioInput" placeholder="Ta bio (ex: Discipline = Libert√©)" maxlength="100" rows="3" style="width: 100%; padding: 12px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 1rem; text-align: center; margin-bottom: 15px; resize: none;"></textarea>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeEditBioModal()">Annuler</button>
                <button class="modal-btn save" onclick="saveProfileBio()">Sauvegarder</button>
            </div>
        </div>
    </div>

    <!-- Modal Setup Pseudo (apr√®s inscription) -->
    <div class="modal-overlay" id="setupPseudoModal">
        <div class="modal">
            <h3>üëã BIENVENUE, GUERRIER !</h3>
            <p style="color: var(--accent-dim); text-align: center; margin-bottom: 15px;">
                Comment on doit t'appeler ?
            </p>
            <input type="text" id="setupPseudoInput" placeholder="Ton pseudo" maxlength="20" style="width: 100%; padding: 12px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 1rem; text-align: center; margin-bottom: 15px;">
            <div class="modal-buttons">
                <button class="modal-btn save" onclick="saveSetupPseudo()" style="flex: 1;">C'EST PARTI üî•</button>
            </div>
        </div>
    </div>

    <!-- Page "Groupes" -->
    <div id="page-groups" class="page" role="main">
        <div class="groups-container" id="groupsContainer">
            <!-- Rendu dynamique par JavaScript -->
        </div>
    </div>

    <!-- Modal Cr√©er un groupe -->
    <div class="modal-overlay" id="createGroupModal">
        <div class="modal">
            <h3>‚ûï CR√âER UN GROUPE</h3>
            <div class="form-group">
                <label>Nom du groupe</label>
                <input type="text" id="createGroupName" placeholder="Ex: Team Morning" maxlength="30"
                    style="width: 100%; padding: 12px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 1rem;">
            </div>
            <div class="form-group">
                <label>Description <span class="optional-label">(optionnel)</span></label>
                <textarea id="createGroupDesc" placeholder="D√©cris ton groupe en quelques mots" maxlength="100" rows="2"
                    style="width: 100%; padding: 12px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 1rem; resize: none;"></textarea>
            </div>
            <div class="form-group">
                <label>Objectif du groupe <span class="optional-label">(optionnel)</span></label>
                <input type="text" id="createGroupGoal" placeholder="Ex: Tout le monde √† 80% cette semaine" maxlength="80"
                    style="width: 100%; padding: 12px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 0.9rem;">
            </div>
            <div class="form-group">
                <label>Habitudes du groupe</label>
                <div class="group-habits-select" id="createGroupHabits">
                    <!-- Rempli dynamiquement -->
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeCreateGroupModal()">Annuler</button>
                <button class="modal-btn save" onclick="createGroup()">Cr√©er</button>
            </div>
        </div>
    </div>

    <!-- Modal Rejoindre un groupe -->
    <div class="modal-overlay" id="joinGroupModal">
        <div class="modal">
            <h3>üîó REJOINDRE UN GROUPE</h3>
            <p style="color: var(--accent-dim); text-align: center; margin-bottom: 15px;">
                Entre le code d'invitation √† 6 caract√®res
            </p>
            <input type="text" id="joinGroupCode" placeholder="EX: ABC123" maxlength="6"
                style="width: 100%; padding: 14px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 1.4rem; text-align: center; text-transform: uppercase; letter-spacing: 6px; font-family: monospace;"
                oninput="this.value = this.value.toUpperCase()">
            <div id="qrScannerContainer" style="display:none; margin-top: 12px;">
                <video id="qrScannerVideo" autoplay playsinline style="width:100%; border-radius: 12px; background: #000;"></video>
                <p style="text-align:center; font-size:0.75rem; color: var(--accent-dim); margin-top: 6px;">Pointe le QR code du groupe</p>
            </div>
            <button class="action-btn action-btn-secondary" onclick="toggleQRScanner()" style="width:100%; margin-top: 12px;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
                <span>Scanner un QR code</span>
            </button>
            <div class="modal-buttons" style="margin-top: 20px;">
                <button class="modal-btn cancel" onclick="closeJoinGroupModal()">Annuler</button>
                <button class="modal-btn save" onclick="joinGroup()">Rejoindre</button>
            </div>
        </div>
    </div>

    <!-- Modal D√©tail groupe -->
    <div class="modal-overlay" id="groupDetailModal">
        <div class="modal modal-large">
            <div id="groupDetailContent">
                <!-- Rempli dynamiquement -->
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeGroupDetail()" style="flex: 1;">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Modal Cr√©er un challenge -->
    <div class="modal-overlay" id="createChallengeModal">
        <div class="modal">
            <h3>‚öîÔ∏è CR√âER UN CHALLENGE</h3>
            <div class="form-group">
                <label>Nom du challenge</label>
                <input type="text" id="challengeName" placeholder="Ex: 7 jours sans excuses" maxlength="40"
                    style="width: 100%; padding: 12px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 1rem;">
            </div>
            <div class="form-group">
                <label>Description <span class="optional-label">(optionnel)</span></label>
                <textarea id="challengeDesc" placeholder="D√©cris le challenge" maxlength="150" rows="2"
                    style="width: 100%; padding: 12px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 1rem; resize: none;"></textarea>
            </div>
            <div class="form-group">
                <label>Dur√©e</label>
                <div class="challenge-duration-picker">
                    <button type="button" class="challenge-duration-btn active" data-duration="7" onclick="setChallengeDuration(7)">7 jours</button>
                    <button type="button" class="challenge-duration-btn" data-duration="14" onclick="setChallengeDuration(14)">14 jours</button>
                    <button type="button" class="challenge-duration-btn" data-duration="30" onclick="setChallengeDuration(30)">30 jours</button>
                </div>
            </div>
            <div class="form-group">
                <label>Date de d√©but</label>
                <input type="date" id="challengeStartDate"
                    style="width: 100%; padding: 12px; background: var(--charcoal); border: 1px solid var(--steel); border-radius: 8px; color: var(--accent); font-size: 1rem;">
            </div>
            <div class="form-group">
                <label>Habitudes cibl√©es</label>
                <div class="group-habits-select" id="challengeHabitsList">
                    <!-- Rempli dynamiquement -->
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeCreateChallengeModal()">Annuler</button>
                <button class="modal-btn save" onclick="createChallenge()">Lancer ‚öîÔ∏è</button>
            </div>
        </div>
    </div>

    <!-- Modal QR Code d'invitation -->
    <div class="modal-overlay" id="qrCodeModal">
        <div class="modal">
            <h3>üì± QR CODE D'INVITATION</h3>
            <div style="text-align: center; padding: 20px 0;">
                <canvas id="qrCanvas" style="border-radius: 12px; margin: 0 auto; display: block;"></canvas>
                <div class="qr-code-text" id="qrCodeTitle" style="font-family: monospace; font-size: 1.5rem; letter-spacing: 6px; margin-top: 15px; color: var(--accent);">CODE</div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeQRModal()" data-i18n="general.close">Fermer</button>
                <button class="modal-btn save" onclick="downloadQR()">üì• T√©l√©charger</button>
            </div>
        </div>
    </div>

    <!-- Banni√®re PWA Install -->
    <div class="install-banner" id="installBanner" style="display: none;">
        <div class="install-banner-content">
            <div class="install-banner-icon">üì≤</div>
            <div class="install-banner-text">
                <div class="install-banner-title">Installer PROJET FEVRIER</div>
                <div class="install-banner-desc">Acc√®s rapide depuis ton √©cran d'accueil</div>
            </div>
        </div>
        <div class="install-banner-actions">
            <button class="install-banner-btn dismiss" onclick="dismissInstallBanner()">Plus tard</button>
            <button class="install-banner-btn install" onclick="installApp()">Installer</button>
        </div>
    </div>

    <!-- Overlay Level Up -->
    <div class="levelup-overlay" id="levelUpOverlay">
        <canvas class="levelup-canvas" id="levelUpCanvas"></canvas>
        <div class="levelup-content">
            <div class="levelup-flash"></div>
            <div class="levelup-title">LEVEL UP!</div>
            <div class="levelup-level-container">
                <div class="levelup-label">NIVEAU</div>
                <div class="levelup-number" id="levelUpNumber">1</div>
            </div>
            <div class="levelup-xp-bar">
                <div class="levelup-xp-bar-fill" id="levelUpXPBarFill"></div>
            </div>
            <div class="levelup-tap">TAP POUR CONTINUER</div>
        </div>
    </div>

    <!-- Overlay de c√©l√©bration -->
    <div class="celebration-overlay" id="celebrationOverlay">
        <div class="celebration-content">
            <div class="celebration-icon" id="celebrationIcon">üèÜ</div>
            <div class="celebration-title" id="celebrationTitle">F√âLICITATIONS !</div>
            <div class="celebration-subtitle" id="celebrationSubtitle"></div>
        </div>
    </div>

    <!-- Barre de navigation inf√©rieure fixe -->
    <div class="bottom-nav" role="navigation" aria-label="Navigation principale">
        <div class="nav-item active" onclick="showPage('today', event)" tabindex="0" role="button" aria-label="Habitudes">
            <div class="icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg></div>
            <div class="label" data-i18n="nav.habits">Habitudes</div>
        </div>
        <div class="nav-item" onclick="showPage('stats', event)" tabindex="0" role="button" aria-label="Statistiques">
            <div class="icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg></div>
            <div class="label" data-i18n="nav.stats">Stats</div>
        </div>
        <div class="nav-add-btn" onclick="openManageHabitsModal()" tabindex="0" role="button" aria-label="Ajouter une habitude">
            <div class="nav-add-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg></div>
        </div>
        <div class="nav-item" onclick="showPage('groups', event)" tabindex="0" role="button" aria-label="Groupes" id="navGroupsItem">
            <div class="icon" style="position:relative;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                <span class="nav-badge" id="navGroupsBadge" style="display:none;"></span>
            </div>
            <div class="label" data-i18n="nav.groups">Groupes</div>
        </div>
        <div class="nav-item" onclick="showPage('profile', event)" tabindex="0" role="button" aria-label="Profil">
            <div class="icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></div>
            <div class="label" data-i18n="nav.profile">Profil</div>
        </div>
    </div>


    <!-- SCRIPT JAVASCRIPT (modules) -->
    <script type="module" src="src/app.js"></script>

</body>

</html>